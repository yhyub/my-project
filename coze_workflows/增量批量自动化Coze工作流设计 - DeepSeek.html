<!DOCTYPE html>
<!-- saved from url=(0071)https://chat.deepseek.com/a/chat/s/62ba9d82-d849-40ab-8427-a45dacf785b1 -->
<html lang="zh-CN" class="notranslate" translate="no" style="--message-area-width:979px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>增量批量自动化Coze工作流设计 - DeepSeek</title><meta name="viewport" content="initial-scale=1.0,maximum-scale=1,minimum-scale=1.0,user-scalable=no,width=device-width,viewport-fit=cover"><meta name="commit-id" content="4b9f3df6"><meta name="description" content="Chat with DeepSeek AI – your intelligent assistant for coding, content creation, file reading, and more. Upload documents, engage in long-context conversations, and get expert help in AI, natural language processing, and beyond. | 深度求索（DeepSeek）助力编程代码开发、创意写作、文件处理等任务，支持文件上传及长文本对话，随时为您提供高效的AI支持。"><meta name="keywords" content="DeepSeek,DeepSeek AI,DeepSeek Chat,AI assistant,coding assistant,long-context LLM,Open Source LLM,natural language processing,AI chatbot,AI long text,AI content creation,large language model,深度求索,大语言模型,自然语言处理,AI聊天机器人,代码开发,创意写作,AI助手,长文本对话,文件处理AI,大模型公司,人工智能,AI开发助手"><meta property="og:url" content="https://chat.deepseek.com"><meta property="og:type" content="website"><meta property="og:title" content="DeepSeek"><meta property="og:description" content="Chat with DeepSeek AI."><meta property="og:image" content="https://cdn.deepseek.com/images/deepseek-chat-open-graph-image.jpeg"><meta name="twitter:card" content="summary_large_image"><meta property="twitter:domain" content="deepseek.com"><meta property="twitter:url" content="https://chat.deepseek.com"><meta name="twitter:title" content="DeepSeek"><meta name="twitter:description" content="Chat with DeepSeek AI."><meta name="twitter:image" content="https://cdn.deepseek.com/images/deepseek-chat-open-graph-image.jpeg"><meta name="google" content="notranslate"><meta name="ip" content="223.88.184.116"><meta name="region" content="CN"><link rel="apple-touch-icon" href="https://cdn.deepseek.com/chat/icon.png"><link rel="icon" type="image/x-icon" href="https://chat.deepseek.com/favicon.svg"><script type="text/javascript" async="" id="_intercom_npm_loader" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/guh50jw4"></script><script>!function(){let e=e=>{let t=document.createElement("script");t.defer=!0,t.src=e,document.head.appendChild(t)},t=document.querySelector('meta[name="region"][content="CN"]');var n,o=window,a="collectEvent";if(o.LogAnalyticsObject=a,!o[a]){var c=function(){c.q.push(arguments)};c.q=c.q||[],o[a]=c}o[a].l=+new Date,e("https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/5.0/collect-rangers-v5.2.1.js"),t||(n=(n=window).DATAFLUX_RUM=n.DATAFLUX_RUM||{q:[],onReady:function(e){n.q.push(e)}},e("https://static.guance.com/browser-sdk/v3/dataflux-rum.js"))}(),(()=>{"use strict";let e=null,t=t=>{let n=t[0]?t[0].src:"",o=(e=>{if(!e||!performance||!performance.getEntriesByName)return;let t=performance.getEntriesByName(e)[0];if(t)return t})(n)||{};return{ds_src:n,dsp__commitId:e,ds_duration:o.duration,ds_encodedBodySize:o.encodedBodySize}},n=function(){return"function"!=typeof window.collectEvent?()=>0:window.collectEvent.apply(window,arguments)},o=!1,a=()=>0,c=()=>"DATAFLUX_RUM"in window?window.DATAFLUX_RUM:{onReady:a,init:a,addAction:a},r=!1,d={en:{t:"Resource Loading Error",d:"Unable to load page resources. Please refresh and try again.",b:"Refresh Page"},zh:{t:"资源加载异常",d:"页面资源加载异常，请刷新重试",b:"刷新页面"}};window._sriCk=function(){var a,i;let s,l,u,p=(e=>{let t=navigator.languages||[navigator.language||""];for(let n=0;n<t.length;n++){let o=t[n].toLowerCase().split("-")[0];if(e.includes(o))return o}return null})(Object.keys(d)),m=p?d[p]:d.en,g='<div class="_sri-ck"><style>._sri-ck{width:fit-content;margin:20vh auto}</style>';g+='<img src="https://cdn.deepseek.com/logo.png" alt="Logo" class="logo" width=114 height=24><h1 class="title">'+m.t+'</h1><p class="desc">'+m.d+'</p><button class="btn" onclick="location.reload()">'+m.b+"</button></div>",(l=(s=document).createElement("div"),s.body.replaceChildren(l),l).innerHTML=g,(u=document.head.querySelector('meta[name="commit-id"]'))&&(e=u.getAttribute("content")),a=arguments,o||(o=!0,n("start"),n("init",{app_id:0x13145ad,channel_domain:"https://gator.volces.com",enable_storage:!0,disable_sdk_monitor:!0})),n("scriptLoadError",t(a)),i=arguments,c().onReady(()=>{r||(r=!0,c().init({applicationId:"deepseek_chat_web",site:"https://openway.deepseeksvc.com",clientToken:"5dd7fd7d07e2486eb1188ae713ac71c2"})),c().addAction("scriptLoadError",t(i))})}})()</script><script defer="" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/collect-rangers-v5.2.1.js.下载"></script><script defer="" onerror="_sriCk(this)" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/default-vendors.449c4a7f78.js.下载"></script><script defer="" onerror="_sriCk(this)" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/main.4392097799.js.下载"></script><link href="./增量批量自动化Coze工作流设计 - DeepSeek_files/main.658a4edb2b.css" rel="stylesheet"><style type="text/css" class="print-ignore-style">
                @media print {
                    .print-ignore {
                        display: none !important;
                    }
                }
            </style><style>
body.change-theme * {
  transition: none !important;
}

body.change-theme *::before {
  transition: none !important;
}

body.change-theme *::after {
  transition: none !important;
}
</style><link data-webpack="@deepseek/chat:chunk-52059" rel="stylesheet" href="./增量批量自动化Coze工作流设计 - DeepSeek_files/katex.66a418a9b7.css"><script data-smcp="true" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/smcp.min.js.下载"></script><style>
  .ds-scroll-area__gutters {
    display: block;
  }
  .ds-scroll-area {
    scrollbar-width: none;
  }
  .ds-scroll-area::-webkit-scrollbar {
    display: none;
  }
  </style><style>@font-face {
  font-family: 'quote-cjk-patch';
  src: local('PingFangSC-Regular');
  unicode-range: U+201C-201D, U+2018-2019;
}</style><link data-webpack="@deepseek/chat:chunk-66233" rel="stylesheet" href="./增量批量自动化Coze工作流设计 - DeepSeek_files/mermaidRender.3e57e36033.css"></head><body class="zh_CN light" style="--app-height: 575px;"><div id="root"><div class="ds-theme" style="--ds-rgb-hover:0 0 0 / 4%;"><div class="cb86951c"><div class="cddfb2ed"></div><div class="c3ecdb44"><div class="dc04ec1d"><div class="b8812f16 a2f3d50e"><div class="_262baab"><div class="e066abb8"><svg width="143" height="23" viewBox="0 0 143 23" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M78.6785 18.6823H77.1078V16.2472H78.6785C79.6513 16.2472 80.6342 16.0047 81.2672 15.3308C81.9009 14.6569 82.14 13.6232 82.14 12.59C82.14 11.5569 81.9109 10.5231 81.2672 9.84981C80.6247 9.17594 79.6513 8.93343 78.6785 8.93343C77.7056 8.93343 76.7228 9.17594 76.0886 9.84981C75.4549 10.5237 75.2158 11.5569 75.2158 12.59V22.5909H72.4605V6.50781H75.2158V7.53204H75.7209C75.7757 7.4689 75.8304 7.41525 75.8857 7.36161C76.5752 6.73244 77.6308 6.50781 78.6684 6.50781C80.2944 6.50781 81.9193 6.91236 82.9849 8.03549C84.0499 9.15861 84.4265 10.8835 84.4265 12.6001C84.4265 14.3166 84.0404 16.0326 82.9849 17.1647C81.9288 18.2967 80.2944 18.6834 78.6785 18.6834V18.6823Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M36.7486 6.94097H38.3188V9.37609H36.7486C35.7753 9.37609 34.7929 9.61859 34.1593 10.2925C33.5257 10.9663 33.2871 12.0001 33.2871 13.0332C33.2871 14.0664 33.5167 15.0996 34.1593 15.7734C34.8019 16.4473 35.7753 16.6898 36.7486 16.6898C37.722 16.6898 38.7049 16.4473 39.3385 15.7734C39.9722 15.0996 40.2108 14.0664 40.2108 13.0332V3.02344H42.9655V19.116H40.2108V18.0918H39.7057C39.6503 18.1544 39.5956 18.2086 39.5403 18.2622C38.8513 18.8908 37.7952 19.116 36.7576 19.116C35.1321 19.116 33.5067 18.712 32.4416 17.5889C31.3766 16.4658 31 14.7403 31 13.0243C31 11.3083 31.3856 9.59177 32.4416 8.45971C33.5067 7.33658 35.1321 6.94097 36.7486 6.94097Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M56.7855 12.8155V13.795H49.4483V11.8454H54.3152C54.2051 11.1358 53.9481 10.4709 53.4887 9.9853C52.8277 9.2846 51.808 9.03316 50.7983 9.03316C49.7886 9.03316 48.7688 9.2846 48.1078 9.9853C47.4468 10.686 47.2076 11.7555 47.2076 12.816C47.2076 13.8766 47.4462 14.9544 48.1078 15.6462C48.7688 16.338 49.788 16.5989 50.7983 16.5989C51.8085 16.5989 52.8277 16.3475 53.4887 15.6462C53.5804 15.5473 53.6631 15.4395 53.7458 15.3316H56.4642C56.2256 16.1765 55.849 16.9403 55.2796 17.5332C54.1777 18.692 52.479 19.1145 50.7983 19.1145C49.1175 19.1145 47.4188 18.701 46.3169 17.5332C45.215 16.3653 44.8111 14.5862 44.8111 12.816C44.8111 11.0458 45.2061 9.25778 46.3169 8.0989C47.4283 6.94001 49.1175 6.51758 50.7983 6.51758C52.479 6.51758 54.1777 6.93107 55.2796 8.0989C56.3904 9.26672 56.7855 11.0458 56.7855 12.816V12.8155Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M70.6151 12.8155V13.795H63.2779V11.8454H68.1448C68.0341 11.1358 67.7776 10.4709 67.3183 9.9853C66.6573 9.2846 65.6376 9.03316 64.6279 9.03316C63.6182 9.03316 62.5984 9.2846 61.9374 9.9853C61.2764 10.686 61.0372 11.7555 61.0372 12.816C61.0372 13.8766 61.2758 14.9544 61.9374 15.6462C62.5984 16.338 63.6182 16.5989 64.6279 16.5989C65.6376 16.5989 66.6573 16.3475 67.3183 15.6462C67.4105 15.5473 67.4927 15.4395 67.5748 15.3316H70.2938C70.0546 16.1765 69.678 16.9403 69.1086 17.5332C68.0067 18.692 66.3081 19.1145 64.6279 19.1145C62.9476 19.1145 61.2484 18.701 60.1465 17.5332C59.0446 16.3653 58.6406 14.5862 58.6406 12.816C58.6406 11.0458 59.0357 9.25778 60.1465 8.0989C61.2579 6.94001 62.9471 6.51758 64.6279 6.51758C66.3086 6.51758 68.0067 6.93107 69.1086 8.0989C70.22 9.26672 70.6151 11.0458 70.6151 12.816V12.8155Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M92.2781 19.1156C93.9589 19.1156 95.657 18.8731 96.7589 18.1813C97.8608 17.4896 98.2653 16.438 98.2653 15.3959C98.2653 14.3538 97.8697 13.2932 96.7589 12.6104C95.657 11.9276 93.9583 11.6756 92.2781 11.6756C91.5612 11.6756 90.9002 11.5767 90.4319 11.3163C89.9637 11.0464 89.7893 10.6424 89.7893 10.2379C89.7893 9.83332 89.9547 9.42039 90.4319 9.15944C90.9002 8.88955 91.626 8.80015 92.3418 8.80015C93.0576 8.80015 93.7834 8.89905 94.2528 9.15944C94.721 9.42933 94.8954 9.83332 94.8954 10.2379H97.6959C97.6959 9.1952 97.3383 8.13522 96.3376 7.4524C95.3368 6.76958 93.803 6.51758 92.2787 6.51758C90.7543 6.51758 89.2211 6.76008 88.2198 7.4524C87.219 8.14416 86.8603 9.1952 86.8603 10.2379C86.8603 11.2805 87.2185 12.3405 88.2198 13.0233C89.2205 13.7061 90.7538 13.9582 92.2787 13.9582C93.0682 13.9582 93.941 14.0571 94.464 14.3174C94.9881 14.5784 95.1714 14.9913 95.1714 15.3959C95.1714 15.8004 94.9881 16.2133 94.464 16.4743C93.941 16.7347 93.142 16.8336 92.3524 16.8336C91.5629 16.8336 90.7543 16.7347 90.2397 16.4743C89.7256 16.2139 89.5323 15.8004 89.5323 15.3959H86.2998C86.2998 16.4385 86.6943 17.4985 87.8063 18.1813C88.9171 18.8641 90.5979 19.1156 92.2787 19.1156H92.2781Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M112.094 12.8155V13.795H104.757V11.8454H109.624C109.514 11.1358 109.257 10.4709 108.798 9.9853C108.136 9.2846 107.117 9.03316 106.106 9.03316C105.095 9.03316 104.077 9.2846 103.416 9.9853C102.755 10.686 102.517 11.7555 102.517 12.816C102.517 13.8766 102.755 14.9544 103.416 15.6462C104.077 16.338 105.097 16.5989 106.106 16.5989C107.116 16.5989 108.136 16.3475 108.798 15.6462C108.889 15.5473 108.972 15.4395 109.054 15.3316H111.772C111.533 16.1765 111.157 16.9403 110.588 17.5332C109.486 18.692 107.787 19.1145 106.106 19.1145C104.425 19.1145 102.727 18.701 101.625 17.5332C100.524 16.3653 100.12 14.5862 100.12 12.816C100.12 11.0458 100.515 9.25778 101.625 8.0989C102.737 6.94001 104.427 6.51758 106.106 6.51758C107.786 6.51758 109.486 6.93107 110.588 8.0989C111.699 9.26672 112.093 11.0458 112.093 12.816L112.094 12.8155Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M125.924 12.8155V13.795H118.586V11.8454H123.453C123.344 11.1358 123.086 10.4709 122.627 9.9853C121.966 9.2846 120.947 9.03316 119.936 9.03316C118.926 9.03316 117.907 9.2846 117.246 9.9853C116.585 10.686 116.346 11.7555 116.346 12.816C116.346 13.8766 116.585 14.9544 117.246 15.6462C117.907 16.338 118.927 16.5989 119.936 16.5989C120.946 16.5989 121.966 16.3475 122.627 15.6462C122.719 15.5473 122.801 15.4395 122.885 15.3316H125.602C125.363 16.1765 124.987 16.9403 124.418 17.5332C123.316 18.692 121.617 19.1145 119.936 19.1145C118.256 19.1145 116.558 18.701 115.456 17.5332C114.354 16.3653 113.949 14.5862 113.949 12.816C113.949 11.0458 114.344 9.25778 115.456 8.0989C116.567 6.94001 118.256 6.51758 119.936 6.51758C121.617 6.51758 123.315 6.93107 124.418 8.0989C125.529 9.26672 125.924 11.0458 125.924 12.816V12.8155Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M130.524 3.02344H127.77V19.116H130.524V3.02344Z" fill="var(--dsw-alias-brand-primary)"></path><path d="M135.227 12.4384L139.744 19.1146H136.337L131.819 12.4384L136.337 7.07422H139.744L135.227 12.4384Z" fill="var(--dsw-alias-brand-primary)"></path><g clip-path="url(#clip0_4329_19769)"><path d="M26.5174 3.39471C26.235 3.2567 26.1137 3.52006 25.9487 3.65346C25.8923 3.69659 25.8446 3.75294 25.7969 3.80469C25.3846 4.24516 24.9027 4.53439 24.2737 4.49989C23.3536 4.44814 22.5682 4.73737 21.8735 5.44119C21.7258 4.57349 21.2353 4.0554 20.4889 3.72304C20.0985 3.55054 19.7034 3.37746 19.4297 3.00197C19.2388 2.73459 19.1865 2.43673 19.091 2.14289C19.0301 1.96579 18.9697 1.78466 18.7656 1.75418C18.5442 1.71968 18.4574 1.90541 18.3705 2.06067C18.0232 2.69549 17.8887 3.39471 17.9019 4.10313C17.9324 5.6965 18.6051 6.96556 19.9421 7.86834C20.0939 7.97184 20.133 8.07535 20.0852 8.22658C19.9938 8.53766 19.8857 8.83955 19.7903 9.15063C19.7293 9.34901 19.6385 9.39271 19.4257 9.30588C18.692 8.9994 18.0583 8.54571 17.4982 7.99772C16.5477 7.07827 15.6881 6.06336 14.6162 5.26869C14.3644 5.08296 14.1125 4.91045 13.8521 4.746C12.7584 3.68394 13.9952 2.81164 14.2816 2.70814C14.5812 2.60003 14.3857 2.22857 13.4179 2.23317C12.4502 2.2372 11.5646 2.56151 10.4359 2.99335C10.2708 3.05832 10.0972 3.10547 9.91951 3.14457C8.8954 2.95022 7.83162 2.90709 6.72069 3.03245C4.62877 3.26533 2.95777 4.25436 1.72954 5.94261C0.254043 7.97184 -0.0932679 10.2777 0.33167 12.6824C0.778458 15.2171 2.07225 17.3153 4.06008 18.9558C6.12152 20.6567 8.49577 21.4905 11.2047 21.3306C12.8498 21.2358 14.6812 21.0155 16.7473 19.2669C17.2682 19.5262 17.8151 19.6297 18.7219 19.7074C19.4205 19.7724 20.0933 19.6729 20.6143 19.5648C21.4302 19.3923 21.3739 18.6367 21.0789 18.4981C18.6874 17.3843 19.2124 17.8374 18.7351 17.4706C19.9501 16.033 21.8063 13.4776 22.379 9.99821C22.4353 9.61409 22.5072 9.073 22.4986 8.76192C22.494 8.57216 22.5377 8.49856 22.7545 8.47671C23.3536 8.40771 23.935 8.24383 24.4692 7.94999C26.0188 7.10357 26.6439 5.71318 26.7911 4.04678C26.8129 3.79204 26.7865 3.52869 26.5174 3.39471ZM13.0143 18.3946C10.6964 16.5724 9.5722 15.9726 9.10816 15.9985C8.67402 16.0244 8.75222 16.5212 8.84768 16.8449C8.94773 17.1646 9.07768 17.3849 9.25996 17.6655C9.38589 17.8512 9.47272 18.1272 9.13404 18.3348C8.38766 18.7965 7.08985 18.1796 7.0289 18.1491C5.51833 17.2595 4.25559 16.0853 3.36546 14.4793C2.50581 12.9337 2.0067 11.2753 1.92447 9.50542C1.90262 9.07818 2.02855 8.92695 2.45406 8.84932C3.01413 8.74582 3.59144 8.72397 4.15093 8.80619C6.51656 9.15178 8.53027 10.2092 10.2185 11.8848C11.1822 12.8388 11.9114 13.979 12.6623 15.0929C13.461 16.2757 14.3201 17.4027 15.4144 18.3268C15.8008 18.6505 16.109 18.8966 16.404 19.0783C15.5144 19.1778 14.0297 19.1991 13.0143 18.3958V18.3946ZM14.1252 11.2489C14.1252 11.0591 14.277 10.9079 14.4679 10.9079C14.511 10.9079 14.5501 10.9165 14.5852 10.9292C14.6329 10.9464 14.6766 10.9723 14.7111 11.0114C14.7721 11.0718 14.8066 11.158 14.8066 11.2489C14.8066 11.4386 14.6548 11.5899 14.4639 11.5899C14.273 11.5899 14.1252 11.4386 14.1252 11.2489ZM17.5759 13.0188C17.3545 13.1096 17.1331 13.1873 16.9203 13.1959C16.5903 13.2131 16.2303 13.0791 16.0348 12.9153C15.7312 12.6605 15.5139 12.5179 15.423 12.0734C15.3839 11.8837 15.4057 11.5899 15.4402 11.4214C15.5185 11.0585 15.4316 10.8257 15.1757 10.614C14.9676 10.4415 14.7025 10.3938 14.4115 10.3938C14.3029 10.3938 14.2034 10.3461 14.1292 10.3076C14.0079 10.2472 13.9078 10.096 14.0033 9.91023C14.0338 9.84985 14.1815 9.70322 14.216 9.67734C14.6111 9.45251 15.0665 9.52612 15.488 9.6946C15.8784 9.85445 16.174 10.1477 16.5989 10.5623C17.033 11.0631 17.1112 11.2011 17.3585 11.5772C17.554 11.871 17.7317 12.1729 17.8536 12.5185C17.9272 12.7341 17.8317 12.9107 17.5759 13.0188Z" fill="var(--dsw-alias-brand-primary)"></path></g><defs><clippath id="clip0_4329_19769"><rect width="26.634" height="19.6" fill="white" transform="translate(0.163086 1.75)"></rect></clippath></defs></svg></div><div class="_7d1f5e2 ds-icon-button ds-icon-button--l ds-icon-button--sizing-icon" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.67272 0.522827C10.8339 0.522827 11.76 0.522701 12.4963 0.60248C13.2453 0.683644 13.8789 0.854235 14.4264 1.25196C14.7504 1.48738 15.0355 1.77246 15.2709 2.09648C15.6686 2.64392 15.8392 3.27756 15.9204 4.02653C16.0002 4.76289 16 5.68894 16 6.85013V9.14985C16 10.311 16.0002 11.2371 15.9204 11.9734C15.8392 12.7224 15.6686 13.3561 15.2709 13.9035C15.0355 14.2275 14.7504 14.5126 14.4264 14.748C13.8789 15.1457 13.2453 15.3163 12.4963 15.3975C11.76 15.4773 10.8339 15.4772 9.67272 15.4772H6.3273C5.16611 15.4772 4.24006 15.4773 3.50371 15.3975C2.75474 15.3163 2.1211 15.1457 1.57366 14.748C1.24963 14.5126 0.964549 14.2275 0.729131 13.9035C0.331407 13.3561 0.160817 12.7224 0.0796529 11.9734C-0.000126137 11.2371 1.25338e-09 10.311 1.25338e-09 9.14985V6.85013C1.25329e-09 5.68894 -0.000126137 4.76289 0.0796529 4.02653C0.160817 3.27756 0.331407 2.64392 0.729131 2.09648C0.964549 1.77246 1.24963 1.48738 1.57366 1.25196C2.1211 0.854235 2.75474 0.683644 3.50371 0.60248C4.24006 0.522701 5.16611 0.522827 6.3273 0.522827H9.67272ZM5.54303 1.88714V14.1118C5.78636 14.1128 6.04709 14.1169 6.3273 14.1169H9.67272C10.8639 14.1169 11.7032 14.1164 12.3493 14.0465C12.9824 13.9779 13.3497 13.8494 13.6268 13.6482C13.8354 13.4966 14.0195 13.3125 14.1711 13.1039C14.3723 12.8268 14.5007 12.4595 14.5693 11.8264C14.6393 11.1803 14.6398 10.341 14.6398 9.14985V6.85013C14.6398 5.65895 14.6393 4.81965 14.5693 4.17359C14.5007 3.54047 14.3723 3.17317 14.1711 2.89608C14.0195 2.68746 13.8354 2.50335 13.6268 2.35178C13.3497 2.15059 12.9824 2.02211 12.3493 1.95352C11.7032 1.88356 10.8639 1.88305 9.67272 1.88305H6.3273C6.04709 1.88305 5.78636 1.88618 5.54303 1.88714ZM4.1828 1.91165C3.99125 1.92158 3.8148 1.93575 3.65076 1.95352C3.01764 2.02211 2.65034 2.15059 2.37325 2.35178C2.16463 2.50335 1.98052 2.68746 1.82895 2.89608C1.62776 3.17317 1.49928 3.54047 1.43069 4.17359C1.36074 4.81965 1.36023 5.65895 1.36023 6.85013V9.14985C1.36023 10.341 1.36074 11.1803 1.43069 11.8264C1.49928 12.4595 1.62776 12.8268 1.82895 13.1039C1.98052 13.3125 2.16463 13.4966 2.37325 13.6482C2.65034 13.8494 3.01764 13.9779 3.65076 14.0465C3.81478 14.0642 3.99127 14.0774 4.1828 14.0873V1.91165Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div></div><div class="_5a8ac7a a084f19e" tabindex="0" style="justify-content: center;"><div class="ds-icon _1c42ad7" style="font-size: 16px; width: 16px; height: 16px;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 0.599609C3.91309 0.599609 0.599609 3.91309 0.599609 8C0.599609 9.13376 0.855461 10.2098 1.3125 11.1719L1.5918 11.7588L2.76562 11.2012L2.48633 10.6143C2.11034 9.82278 1.90039 8.93675 1.90039 8C1.90039 4.63106 4.63106 1.90039 8 1.90039C11.3689 1.90039 14.0996 4.63106 14.0996 8C14.0996 11.3689 11.3689 14.0996 8 14.0996C7.31041 14.0996 6.80528 14.0514 6.35742 13.9277C5.91623 13.8059 5.49768 13.6021 4.99707 13.2529C4.26492 12.7422 3.21611 12.5616 2.35156 13.1074L2.33789 13.1162L2.32422 13.126L1.58789 13.6436L2.01953 14.9297L3.0459 14.207C3.36351 14.0065 3.83838 14.0294 4.25293 14.3184C4.84547 14.7317 5.39743 15.011 6.01172 15.1807C6.61947 15.3485 7.25549 15.4004 8 15.4004C12.0869 15.4004 15.4004 12.0869 15.4004 8C15.4004 3.91309 12.0869 0.599609 8 0.599609ZM7.34473 4.93945V7.34961H4.93945V8.65039H7.34473V11.0605H8.64551V8.65039H11.0605V7.34961H8.64551V4.93945H7.34473Z" fill="currentColor"></path></svg></div><span>开启新对话</span><div class="ds-focus-ring"></div></div><div class="_3586175 ds-scroll-area"><div class="ds-scroll-area__gutters" style="position: sticky; top: 0px; left: 0px; right: 0px; height: 0px; --container-height:395px;"><div class="ds-scroll-area__horizontal-gutter" style="left: 8px; right: 8px; display: block; top: calc(var(--container-height) - 10px); height: 10px;"><div class="ds-scroll-area__horizontal-bar" style="display: none;"></div></div><div class="ds-scroll-area__vertical-gutter" style="right: -12px; top: 0px; bottom: calc(0px - var(--container-height) + 0px); width: 10px;"><div class="ds-scroll-area__vertical-bar" style="top: 0px; height: 36.9377px;"></div></div></div><div class="_6d215eb ds-scroll-area"><div class="_77cdc67 _8a693f3"><div class="_3098d02"><div class="f3d18f6a _63f5548"><span>置顶 44 个对话</span><div class="ds-icon" style="font-size: 14px; width: 14px; height: 14px;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.8486 5.5L11.4238 5.92383L8.69727 8.65137C8.44157 8.90706 8.21562 9.13382 8.01172 9.29785C7.79912 9.46883 7.55595 9.61756 7.25 9.66602C7.08435 9.69222 6.91565 9.69222 6.75 9.66602C6.44405 9.61756 6.20088 9.46883 5.98828 9.29785C5.78438 9.13382 5.55843 8.90706 5.30273 8.65137L2.57617 5.92383L2.15137 5.5L3 4.65137L3.42383 5.07617L6.15137 7.80273C6.42595 8.07732 6.59876 8.24849 6.74023 8.3623C6.87291 8.46904 6.92272 8.47813 6.9375 8.48047C6.97895 8.48703 7.02105 8.48703 7.0625 8.48047C7.07728 8.47813 7.12709 8.46904 7.25977 8.3623C7.40124 8.24849 7.57405 8.07732 7.84863 7.80273L10.5762 5.07617L11 4.65137L11.8486 5.5Z" fill="currentColor"></path></svg></div></div></div><div class="_3098d02"><div class="f3d18f6a">今天</div><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/0f498c85-7aa2-425b-bc27-602f320766de" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">增量批量自动化Coze工作流设计</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736 b64fb9ae" href="https://chat.deepseek.com/a/chat/s/62ba9d82-d849-40ab-8427-a45dacf785b1" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">增量批量自动化Coze工作流设计</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/8a4f5b5b-33d1-408e-803a-06b4621cea58" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">增量Coze工作流设计与实现</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a></div><div class="_3098d02"><div class="f3d18f6a">昨天</div><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/3faa0cda-f028-4fa7-9111-6fb92dbed702" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Docker Hub Overview and Usage Guide</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a></div><div class="_3098d02"><div class="f3d18f6a">7 天内</div><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/784b6e08-d0d9-4317-8123-75ac99964c80" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">工作流软件全面介绍与选择指南</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/cdd89a99-b956-4b44-802e-616f9985dd7d" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze代码节点使用及自动化生成指南</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/9c61ecd5-505f-4bbd-81f2-986cc45ecb3b" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">解决VSCode插件Webview配置问题</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/5d9d6411-b421-4b2d-abb2-4c99f93982e7" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">CSDN博客爬虫实现与注意事项</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/c621fab8-de43-4ddf-92c2-4ebb292ef492" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze Studio的完整个人服务器</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a></div><div class="_3098d02"><div class="f3d18f6a">30 天内</div><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/71de0a04-afee-43d4-abdc-74f1eefbb0b4" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">自主进化智能系统需求框架解析</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/bd633167-aa9a-40e2-a5fc-bce91510dc3d" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze Studio Workflow Detailed Technical Analysis</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/e779d123-ca0e-4bdc-97df-0634e0abe791" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Custom Node Implementation in Coze Workflow</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/4804ae76-7e27-419c-b122-09455e267369" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze工作流深层修复系统设计</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/27cfd701-7cf5-489b-9168-fcaa6ec54b56" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze工作流自动化修复与深层问题修复探讨</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/ac2aff49-4a7c-4687-97f6-5c979bb3523d" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Starting Docker Compose Services Guide</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/7405a275-ceaf-4022-b656-39eaafd43d04" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">批量修复Coze工作流错误方法总结</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/63751a69-8229-4593-b365-17db3e3dfe2a" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">自动化工作流生成系统设计</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/ce2b7f73-0542-4b16-8385-4eab3f81b23e" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze工作流使用指南与实践</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/1ec05b6d-0b32-46b0-a0a8-a324868be5da" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">元自动化系统构建与实施方案</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/c0e4a6a6-3fe2-4d48-85ab-6d593cdca7a8" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">写智能体 智能体调用的TXT文本内容就是智能体本身的智能体的功能</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/94fe9e64-ee33-4cff-8b32-c6ae0f695292" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze工作流推荐与搭建指南</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/dabdb879-f5e4-4827-8e54-d5b6ae1e4f1f" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Electron应用主进程文件丢失解决方法</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/1a2d2af2-7b4a-4908-b597-94430346b3ab" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">合并修复MCP工具文件内容</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/865fd875-575b-44be-9253-5b29ae2d2630" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">完美MCP工具V2.0完整整合项目</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/4ab3403b-b506-4885-b79b-6944522583e6" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Trae MCP Server配置与使用指南更新</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/2bf53679-59db-42fd-9a03-aa3dd74e9600" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze网页版数据集成方法</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/23335763-0750-4358-acfa-a4a08364e9da" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze自动获取本地文件方法解析</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/97acc9e3-84d4-4887-94a9-06e2b142f05f" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">OmniMCP HyperFactory Ultimate 单体工具</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/d1f071d1-21a7-44c6-8d45-4af34d2cc3b9" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">OmniMCP HyperFactory Ultimate单体工具</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/5feba4e2-f1b7-4a2b-99ee-ced69116da3a" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">上面符合JSON的配置在哪里这个DeepSeek MCP工具你给</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/97caea83-0b64-42b6-8401-65daa7f09256" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze插件宇宙提升办公效率</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/4b7104a8-03ab-45bd-a772-aa27f43374fe" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">DeepSeek MCP工具配置与功能整合</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/58e76eff-7e4e-45f3-8f8a-f2a2384d1848" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">查找非系统文件及识别项目用途方法</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/4d145a79-341c-473e-bcfb-c1e99d36428c" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93"># 图像数据增强（以TensorFlow/Keras为例）fr</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/ee30d082-afe2-4c60-8281-f1e52f6fe5f4" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Trae-AI-IDE全能元智能体系统</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/18d3d332-2491-418b-90e1-d35da9521ae7" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">完美根据上面从头到尾全文所有完整内容的提供后，我会严格按 “无变</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/a473ea97-76c8-41e5-8ba9-d36ac79c9543" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">高效数据处理系统设计与实现</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/cc220ca2-461f-4d9c-8a27-9db83df08314" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Python3项目开发源码合集
1-20：Python3大项目开</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/b24e8c93-d20f-40a7-b495-8e8f0efe59c8" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">AutoGenius-Pro: 全功能AI自动化训练与智能投喂系统</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/00b942a1-e5c7-4d71-a670-85e7f2003ef2" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">数据集训练AI模型方法</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/0059fc7c-a508-498a-aadf-7b396874dde3" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">整合修复完整Python代码</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/ec26b518-9f18-4d28-b3f7-250e757585bc" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">LLaMA-Factory项目自动化转换方案</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/eacab05a-8070-40c3-a36e-cb15d5cd9001" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">Coze工作流系统完整代码示例</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/6642fc13-b944-4a73-af4b-f0724af8fc96" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">全功能AI模型训练与部署系统</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/4771a369-ea44-4287-a1c2-799ceff94ce0" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">全功能AI系统架构与实现指南</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/5dddac7d-cc0b-43d1-99b4-1cbe67e6e035" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">全自动多模态人工智能训练系统</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/f98a0733-b998-4d96-8f45-5fb759baf6e3" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">DeepSeek AI系统整合与代码生成</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/87bab1c4-e5cd-4d18-ac35-13649149451f" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">创建知识库与训练模型步骤</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/e601b77b-054d-4311-84fd-403972bd12d7" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">整理并修复完整代码内容</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/cb21fec7-6406-46ec-825d-ca6767fcacb4" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">以下是为您精心设计的极致优化实现，融合所有需求于单个高内聚模块，</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/c746b3a4-93a0-405a-b8d0-42a12b793202" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93"># -*- coding: utf-8 -*-
# Neuro </div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/e65c010d-a1c0-49cc-b2ff-4ff29c984c97" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">模型类型不匹配问题解决指南</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/c976c2ee-e50d-4382-9818-79bdf1a4db0d" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">智能数据处理平台功能解析</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/8fc94ec9-61e5-4007-8ab4-3ac54f6d2fd7" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">全栈AI训练系统 (Full-Stack AI Training System)</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/54f62a98-9472-4405-ae0b-793d8eca8c45" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">修复AI训练GUI代码并优化功能
import torch
fr</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a><a class="_546d736" href="https://chat.deepseek.com/a/chat/s/bdf07c28-f093-4dc3-97e7-619d51444327" tabindex="0"><div class="ds-focus-ring"></div><div class="c08e6e93">import os
import pandas as pd
im</div><div class="_254829d"><div class="_2090548 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><div class="ds-icon" style="font-size: 16px; width: 16px; height: 16px; color: var(--dsw-alias-label-tertiary);"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div></div><div class="ds-focus-ring"></div></div></div></a></div></div><div class="de3d058c"></div></div><div class="_1d72f01"></div></div><div class="_2afd28d" tabindex="0"><div class="ede5bc47"><img class="fdf01f38" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/mW6LUDgo-iVfax7JBKvECinb" alt="" aria-hidden="true" style="display: block;"></div><div class="_9d8da05">蔡景轩</div><div class="ds-icon _39cc453" style="font-size: 16px; width: 16px; height: 16px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5514 8C4.5514 8.63513 4.03653 9.15 3.4014 9.15C2.76628 9.15 2.2514 8.63513 2.2514 8C2.2514 7.36487 2.76628 6.85 3.4014 6.85C4.03653 6.85 4.5514 7.36487 4.5514 8Z" fill="currentColor"></path><path d="M9.14754 8C9.14754 8.63513 8.63267 9.15 7.99754 9.15C7.36242 9.15 6.84754 8.63513 6.84754 8C6.84754 7.36487 7.36242 6.85 7.99754 6.85C8.63267 6.85 9.14754 7.36487 9.14754 8Z" fill="currentColor"></path><path d="M13.7486 8C13.7486 8.63513 13.2337 9.15 12.5986 9.15C11.9634 9.15 11.4486 8.63513 11.4486 8C11.4486 7.36487 11.9634 6.85 12.5986 6.85C13.2337 6.85 13.7486 7.36487 13.7486 8Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div></div></div><div class="_4cbcd96"></div><div class="_7780f2e"><div class="_765a5cd"><div class="_2be88ba"><div class="f8d1e4c0"><div style="flex: 1 1 0%; min-width: 0px; display: flex; place-content: center; z-index: 12;"><div class="afa34042 e37a04e4 e0a1edb7" tabindex="0" style="outline: none;">增量批量自动化Coze工作流设计</div></div></div><div class="_0efe408 _48a2c07"><div class="_2b72279">选择对话</div><button role="button" aria-disabled="false" class="ds-atom-button ds-basic-button ds-basic-button--outlined" style="padding: 6px 14px; font-size: 14px; line-height: 22px; min-width: 72px; margin-left: auto;"><span>取消</span><div class="ds-focus-ring"></div></button></div></div><div class="_3919b83"><div class="_8f60047"><div class="ds-scroll-area__gutters" style="--ds-scroll-area-vertical-gutter-padding:0 4px 0 0; position: sticky; top: 0px; left: 0px; right: 0px; height: 0px; --container-height:515px;"><div class="ds-scroll-area__horizontal-gutter" style="left: 8px; right: 8px; display: none; top: calc(var(--container-height) - 10px); height: 10px;"><div class="ds-scroll-area__horizontal-bar" style="display: none;"></div></div><div class="ds-scroll-area__vertical-gutter" style="right: 0px; top: 0px; bottom: calc(0px - var(--container-height) + 68px); width: 10px;"><div class="ds-scroll-area__vertical-bar" style="top: 423px; height: 24px;"></div></div></div><div class="_0f72b0b ds-scroll-area"><div class="dad65929"><div class="_9663006"><div class="d30139ff"><div class="ad950ab7"><div class="ds-checkbox-align-wrapper"><div class="ds-checkbox ds-checkbox--l ds-checkbox--active ds-checkbox--none" tabindex="0" style="align-self: flex-start; --line-height: unset;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5625 4.49518L7.61331 8.98248C7.35059 9.28094 7.11252 9.55346 6.89359 9.75201C6.66498 9.95932 6.38424 10.1559 6.0137 10.2217C5.81985 10.2561 5.62112 10.2582 5.42679 10.2266C5.05515 10.1662 4.77171 9.97269 4.54007 9.76862C4.31832 9.57324 4.07657 9.30444 3.8096 9.00983L2.44437 7.50397L3.55569 6.49615L4.92093 8.00299C5.21161 8.32377 5.38783 8.51724 5.53128 8.64362C5.60927 8.71232 5.65159 8.73725 5.668 8.74518C5.69553 8.74962 5.72354 8.75 5.75101 8.74518C5.72562 8.74984 5.75469 8.75955 5.88577 8.64069C6.02738 8.51225 6.20131 8.31621 6.48734 7.99127L10.4375 3.50494L11.5625 4.49518Z" fill="currentColor"></path></svg></div></div></div></div><div class="d29f3d7d ds-message _6e8caf5 _7729a77" style="--panel-width:979px;"><div class="fbb737a4" style="">增量批量自动化生成制作完整的coze工作流和完整coze工作流参数和增量批量自动化处理操作自动化运行</div></div><div class="_11d6b3a"><div class="_425ea0b fa1bcf13"><div class="ds-flex _78e0558" style="align-items: flex-end; gap: 0px;"><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="d4910adc ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false" style="margin-left: 10px;"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.94073 1.34942C10.7047 0.902314 11.6503 0.902418 12.4143 1.34942C12.706 1.52016 12.9687 1.79118 13.3104 2.13284C13.652 2.47448 13.9231 2.73721 14.0938 3.02894C14.5408 3.79295 14.5409 4.73856 14.0938 5.50251C13.9231 5.79415 13.652 6.05704 13.3104 6.39861L6.65929 13.0497C6.28065 13.4284 6.00692 13.7108 5.6654 13.9097C5.32388 14.1085 4.94312 14.2074 4.42702 14.3498L3.24391 14.6761C2.77524 14.8054 2.34535 14.9262 2.00128 14.9684C1.65193 15.0112 1.17961 15.0013 0.810733 14.6325C0.44189 14.2637 0.432076 13.7913 0.474829 13.442C0.517004 13.0979 0.63787 12.668 0.767151 12.1993L1.09349 11.0162C1.23585 10.5001 1.33478 10.1194 1.53356 9.77785C1.73246 9.43633 2.01487 9.1626 2.39352 8.78395L9.04463 2.13284C9.38622 1.79126 9.64908 1.52017 9.94073 1.34942ZM15.5427 14.8398H7.5522L8.96704 13.425H15.5427V14.8398ZM3.39379 9.78423C2.96497 10.2131 2.84241 10.3436 2.75706 10.49C2.6718 10.6366 2.61858 10.8079 2.4573 11.3925L2.13096 12.5756C2.0018 13.0439 1.92191 13.3419 1.8886 13.5536C2.10038 13.5204 2.39869 13.4416 2.86761 13.3123L4.05072 12.9859C4.63541 12.8246 4.80666 12.7715 4.9532 12.6862C5.09965 12.6008 5.23019 12.4783 5.65902 12.0495L10.721 6.98644L8.45574 4.72122L3.39379 9.78423ZM11.7 2.57079C11.3774 2.38199 10.9777 2.38199 10.6551 2.57079C10.5602 2.62647 10.4487 2.72931 10.0449 3.13311L9.45601 3.72094L11.7212 5.98617L12.3101 5.39834C12.7139 4.99458 12.8168 4.88307 12.8725 4.78818C13.0612 4.46561 13.0612 4.06586 12.8725 3.74327C12.8168 3.64827 12.7145 3.53752 12.3101 3.13311C11.9057 2.72863 11.795 2.62641 11.7 2.57079Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div></div></div></div></div><div class="_4f9bf79 _43c05b5" style="--assistant-last-margin-bottom:32px;"><div class="d30139ff"><div class="ad950ab7"><div class="ds-checkbox-align-wrapper"><div class="ds-checkbox ds-checkbox--l ds-checkbox--active ds-checkbox--none" tabindex="0" style="align-self: flex-start; --line-height: unset;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5625 4.49518L7.61331 8.98248C7.35059 9.28094 7.11252 9.55346 6.89359 9.75201C6.66498 9.95932 6.38424 10.1559 6.0137 10.2217C5.81985 10.2561 5.62112 10.2582 5.42679 10.2266C5.05515 10.1662 4.77171 9.97269 4.54007 9.76862C4.31832 9.57324 4.07657 9.30444 3.8096 9.00983L2.44437 7.50397L3.55569 6.49615L4.92093 8.00299C5.21161 8.32377 5.38783 8.51724 5.53128 8.64362C5.60927 8.71232 5.65159 8.73725 5.668 8.74518C5.69553 8.74962 5.72354 8.75 5.75101 8.74518C5.72562 8.74984 5.75469 8.75955 5.88577 8.64069C6.02738 8.51225 6.20131 8.31621 6.48734 7.99127L10.4375 3.50494L11.5625 4.49518Z" fill="currentColor"></path></svg></div></div></div></div><div class="ds-message _6e8caf5 _7729a77" style="--panel-width:979px;"><div class="_74c0879" style="--collapsible-area-title-height:38px; --group-title-sticky-top:0px;"><div class="_245c867 a51c5344"><div class="_5ab5d64"><div class="ds-icon _970ac5e" style="font-size: 16px; width: 16px; height: 16px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.00195 6.64454C8.75029 6.64454 9.35735 7.25169 9.35742 8.00001C9.35742 8.74838 8.75033 9.35548 8.00195 9.35548C7.2537 9.35533 6.64746 8.74829 6.64746 8.00001C6.64753 7.25178 7.25374 6.64468 8.00195 6.64454Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M9.97168 1.29981C11.5854 0.718916 13.271 0.642197 14.3145 1.68555C15.3578 2.72902 15.2811 4.41466 14.7002 6.02833C14.4708 6.66561 14.1505 7.32937 13.75 8.00001C14.1505 8.67062 14.4708 9.33444 14.7002 9.97169C15.2811 11.5854 15.3579 13.271 14.3145 14.3145C13.271 15.3579 11.5854 15.2811 9.97168 14.7002C9.33443 14.4708 8.67062 14.1505 8 13.75C7.32936 14.1505 6.66561 14.4708 6.02832 14.7002C4.41464 15.2811 2.72902 15.3578 1.68555 14.3145C0.642186 13.271 0.718901 11.5854 1.29981 9.97169C1.52918 9.33454 1.84868 8.67049 2.24902 8.00001C1.84869 7.32953 1.52918 6.66544 1.29981 6.02833C0.718882 4.41459 0.6421 2.729 1.68555 1.68555C2.729 0.642112 4.41459 0.718887 6.02832 1.29981C6.66544 1.52918 7.32953 1.8487 8 2.24903C8.67048 1.84869 9.33454 1.52919 9.97168 1.29981ZM12.9404 9.2129C12.4391 9.893 11.8616 10.5681 11.2148 11.2149C10.5681 11.8616 9.89299 12.4391 9.21289 12.9404C9.62535 13.1579 10.0271 13.338 10.4121 13.4766C11.9146 14.0174 12.9173 13.8738 13.3955 13.3955C13.8737 12.9173 14.0174 11.9146 13.4766 10.4121C13.338 10.0271 13.1579 9.62535 12.9404 9.2129ZM3.05859 9.2129C2.84124 9.62523 2.662 10.0272 2.52344 10.4121C1.98255 11.9146 2.1263 12.9172 2.60449 13.3955C3.08281 13.8737 4.08548 14.0174 5.58789 13.4766C5.97267 13.338 6.37392 13.1577 6.78613 12.9404C6.10627 12.4393 5.43171 11.8614 4.78516 11.2149C4.13826 10.5679 3.55995 9.89313 3.05859 9.2129ZM7.99902 3.792C7.23182 4.31419 6.45309 4.95512 5.7041 5.70411C4.95512 6.45309 4.31418 7.23184 3.79199 7.99903C4.31434 8.76666 4.95474 9.54653 5.7041 10.2959C6.45312 11.0449 7.23274 11.6848 8 12.207C8.76728 11.6848 9.54686 11.0449 10.2959 10.2959C11.0449 9.54686 11.6848 8.76729 12.207 8.00001C11.6848 7.23275 11.0449 6.45312 10.2959 5.70411C9.54653 4.95475 8.76665 4.31434 7.99902 3.792ZM5.58789 2.52344C4.08536 1.98255 3.08275 2.12625 2.60449 2.6045C2.12624 3.08275 1.98255 4.08536 2.52344 5.5879C2.66192 5.97253 2.84143 6.37409 3.05859 6.78614C3.55986 6.10611 4.13843 5.43189 4.78516 4.78516C5.4319 4.13843 6.10609 3.55987 6.78613 3.0586C6.37408 2.84144 5.97252 2.66192 5.58789 2.52344ZM13.3955 2.6045C12.9172 2.12631 11.9146 1.98257 10.4121 2.52344C10.0272 2.66201 9.62522 2.84125 9.21289 3.0586C9.89313 3.55996 10.5679 4.13827 11.2148 4.78516C11.8614 5.43172 12.4392 6.10627 12.9404 6.78614C13.1577 6.37393 13.338 5.97267 13.4766 5.5879C14.0174 4.08549 13.8736 3.08281 13.3955 2.6045Z" fill="currentColor"></path></svg></div><span class="_5255ff8 _4d41763">已思考（用时 13 秒）</span><div class="ds-icon" style="font-size: 14px; width: 14px; height: 14px;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.8486 5.5L11.4238 5.92383L8.69727 8.65137C8.44157 8.90706 8.21562 9.13382 8.01172 9.29785C7.79912 9.46883 7.55595 9.61756 7.25 9.66602C7.08435 9.69222 6.91565 9.69222 6.75 9.66602C6.44405 9.61756 6.20088 9.46883 5.98828 9.29785C5.78438 9.13382 5.55843 8.90706 5.30273 8.65137L2.57617 5.92383L2.15137 5.5L3 4.65137L3.42383 5.07617L6.15137 7.80273C6.42595 8.07732 6.59876 8.24849 6.74023 8.3623C6.87291 8.46904 6.92272 8.47813 6.9375 8.48047C6.97895 8.48703 7.02105 8.48703 7.0625 8.48047C7.07728 8.47813 7.12709 8.46904 7.25977 8.3623C7.40124 8.24849 7.57405 8.07732 7.84863 7.80273L10.5762 5.07617L11 4.65137L11.8486 5.5Z" fill="currentColor"></path></svg></div></div><div class="c99b79f8" style="opacity: 0;"></div></div><div class="c2b72bb8"></div><div class="e1675d8b ds-think-content _767406f"><div class="ddd26891 _9b52f6c" style="width: 16px; height: 16px;"><div class="a510c7ce _0652043"></div></div><div class="_9ecc93a"></div><div class="ds-markdown pointer-events-none" style="--ds-md-zoom:1.143;"><p class="ds-markdown-paragraph"><span>我们无法直接自动化运行Coze平台的工作流，因为Coze平台没有提供公开的API来触发工作流执行。但是，我们可以模拟用户操作，使用自动化工具（如Selenium、Playwright等）来操作浏览器，从而触发工作流。然而，这种方式不稳定，且容易被平台禁止。</span></p><p class="ds-markdown-paragraph"><span>另一种思路是，如果Coze平台提供了webhook或者API触发方式，那么我们可以通过调用API来触发工作流。但根据目前的信息，Coze平台可能没有提供这样的API。</span></p><p class="ds-markdown-paragraph"><span>因此，这里我将提供一种基于模拟用户操作的自动化方案，但请注意，这种方法可能违反Coze平台的使用条款，请谨慎使用。另外，由于Coze平台可能会更新界面，因此以下步骤可能需要调整。</span></p><p class="ds-markdown-paragraph"><span>我们将使用Playwright（一个自动化测试工具）来模拟用户操作。假设我们已经在Coze平台上创建了一个工作流，并且我们需要定期触发它。</span></p><p class="ds-markdown-paragraph"><span>步骤：</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><span>登录Coze平台。</span></p></li><li><p class="ds-markdown-paragraph"><span>进入工作流页面。</span></p></li><li><p class="ds-markdown-paragraph"><span>找到指定的工作流，并点击运行。</span></p></li><li><p class="ds-markdown-paragraph"><span>等待工作流运行完成（如果需要的话）。</span></p></li><li><p class="ds-markdown-paragraph"><span>获取运行结果（如果需要的话）。</span></p></li></ol><p class="ds-markdown-paragraph"><span>由于Coze平台的具体界面元素可能会变化，以下代码需要根据实际情况调整。</span></p><p class="ds-markdown-paragraph"><span>另外，由于工作流的运行可能需要一些时间，我们可能需要设置等待时间。</span></p><p class="ds-markdown-paragraph"><span>以下是一个示例代码，假设我们使用Playwright for Python：</span></p><p class="ds-markdown-paragraph"><span>注意：运行此代码前，请确保已安装Playwright：</span><br><span>pip install playwright</span><br><span>playwright install</span></p><p class="ds-markdown-paragraph"><span>由于Coze平台可能需要登录，我们需要处理登录状态。我们可以选择每次运行都登录，或者保存登录状态。这里为了简单，我们假设每次运行都登录。</span></p><p class="ds-markdown-paragraph"><span>但是，请注意，自动化登录可能会触发安全机制，比如验证码。因此，这种方法可能不适用于所有情况。</span></p><p class="ds-markdown-paragraph"><span>由于无法知道Coze平台的具体登录方式（是否是邮箱登录、手机登录、第三方登录等），这里假设是邮箱登录。</span></p><p class="ds-markdown-paragraph"><span>以下代码仅供参考，实际运行时需要根据Coze平台的实际情况调整。</span></p></div></div><div class="_8f7678d"></div></div><div class="ds-markdown pointer-events-none" style="--ds-md-zoom:1.143;"><p class="ds-markdown-paragraph"><span>我来为您设计一个完整的增量批量自动化生成和运行Coze工作流的解决方案。</span></p><h2><span>一、Coze工作流自动化架构设计</span></h2><h3><span>1. 系统架构图</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">text</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre>[数据源] → [增量检测器] → [工作流生成器] → [Coze API] → [批量执行器] → [结果处理]
     ↑           ↑             ↑             ↑            ↑
[配置文件]←[状态管理器]←[模板引擎]←[参数工厂]←[调度器]</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>2. 核心模块设计</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># config.yaml - 主配置文件</span>
workflow_automation<span class="token punctuation">:</span>
  coze_api<span class="token punctuation">:</span>
    base_url<span class="token punctuation">:</span> <span class="token string">"https://api.coze.cn"</span>
    api_key<span class="token punctuation">:</span> <span class="token string">"${COZE_API_KEY}"</span>
    workspace_id<span class="token punctuation">:</span> <span class="token string">"your_workspace_id"</span>
    
  batch_processing<span class="token punctuation">:</span>
    max_concurrent<span class="token punctuation">:</span> <span class="token number">5</span>
    retry_attempts<span class="token punctuation">:</span> <span class="token number">3</span>
    batch_size<span class="token punctuation">:</span> <span class="token number">100</span>
    incremental_field<span class="token punctuation">:</span> <span class="token string">"updated_at"</span>
    
  templates<span class="token punctuation">:</span>
    workflow_template_path<span class="token punctuation">:</span> <span class="token string">"./templates/workflow.json.j2"</span>
    node_template_path<span class="token punctuation">:</span> <span class="token string">"./templates/nodes/"</span>
    
  data_sources<span class="token punctuation">:</span>
    <span class="token operator">-</span> <span class="token builtin">type</span><span class="token punctuation">:</span> <span class="token string">"database"</span>
      connection<span class="token punctuation">:</span> <span class="token string">"${DB_CONNECTION}"</span>
      query<span class="token punctuation">:</span> <span class="token string">"SELECT * FROM source_data WHERE updated_at &gt; :last_run"</span>
    <span class="token operator">-</span> <span class="token builtin">type</span><span class="token punctuation">:</span> <span class="token string">"api"</span>
      endpoint<span class="token punctuation">:</span> <span class="token string">"https://api.example.com/data"</span>
    <span class="token operator">-</span> <span class="token builtin">type</span><span class="token punctuation">:</span> <span class="token string">"file"</span>
      path<span class="token punctuation">:</span> <span class="token string">"./data/incremental_*.json"</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>二、完整的工作流生成器</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># workflow_generator.py</span>
<span class="token keyword">import</span> json
<span class="token keyword">import</span> yaml
<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Environment<span class="token punctuation">,</span> FileSystemLoader
<span class="token keyword">import</span> asyncio
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Any
<span class="token keyword">import</span> hashlib

<span class="token keyword">class</span> <span class="token class-name">CozeWorkflowGenerator</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config_path<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"config.yaml"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>config_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>config <span class="token operator">=</span> yaml<span class="token punctuation">.</span>safe_load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>jinja_env <span class="token operator">=</span> Environment<span class="token punctuation">(</span>
            loader<span class="token operator">=</span>FileSystemLoader<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            trim_blocks<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            lstrip_blocks<span class="token operator">=</span><span class="token boolean">True</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>incremental_state <span class="token operator">=</span> self<span class="token punctuation">.</span>load_state<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">load_state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""加载增量处理状态"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'state.json'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                <span class="token keyword">return</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">"last_run"</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">"processed_ids"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">save_state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""保存处理状态"""</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'state.json'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>self<span class="token punctuation">.</span>incremental_state<span class="token punctuation">,</span> f<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_source<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检测增量数据"""</span>
        <span class="token comment"># 这里根据配置的增量字段获取新数据</span>
        last_run <span class="token operator">=</span> self<span class="token punctuation">.</span>incremental_state<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'last_run'</span><span class="token punctuation">)</span>
        processed_ids <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>incremental_state<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'processed_ids'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 示例：从数据库获取增量数据</span>
        incremental_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 实际实现需要连接数据源</span>
        
        <span class="token keyword">return</span> incremental_data
    
    <span class="token keyword">def</span> <span class="token function">generate_workflow_parameters</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成工作流参数"""</span>
        template <span class="token operator">=</span> self<span class="token punctuation">.</span>jinja_env<span class="token punctuation">.</span>get_template<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'templates'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'workflow_template_path'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        
        workflow_params <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"workflow_name"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"batch_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d_%H%M%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            <span class="token string">"workflow_description"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Auto-generated batch workflow"</span></span><span class="token punctuation">,</span>
            <span class="token string">"nodes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"edges"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"batch_id"</span><span class="token punctuation">:</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"data_count"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"generated_at"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment"># 根据数据生成节点</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> data_item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">)</span><span class="token punctuation">:</span>
            node <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"node_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"llm"</span><span class="token punctuation">,</span>
                <span class="token string">"config"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"model"</span><span class="token punctuation">:</span> <span class="token string">"gpt-4"</span><span class="token punctuation">,</span>
                    <span class="token string">"prompt"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>generate_prompt<span class="token punctuation">(</span>data_item<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">"temperature"</span><span class="token punctuation">:</span> <span class="token number">0.7</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"data"</span><span class="token punctuation">:</span> data_item
            <span class="token punctuation">}</span>
            workflow_params<span class="token punctuation">[</span><span class="token string">"nodes"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>node<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                workflow_params<span class="token punctuation">[</span><span class="token string">"edges"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"node_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                    <span class="token string">"target"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"node_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>workflow_params<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">generate_prompt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_item<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""根据数据生成提示词模板"""</span>
        prompt_template <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
        请处理以下数据：
        - ID: {{id}}
        - 内容: {{content}}
        - 类型: {{type}}
        
        处理要求：
        1. 分析内容的关键信息
        2. 提取主要实体
        3. 生成摘要
        4. 分类标签
        
        请以JSON格式返回结果。
        """</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>jinja_env<span class="token punctuation">.</span>from_string<span class="token punctuation">(</span>prompt_template<span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token operator">**</span>data_item<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">create_workflow</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> workflow_params<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""通过Coze API创建工作流"""</span>
        <span class="token keyword">import</span> aiohttp
        
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
            headers <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coze_api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api_key'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
            <span class="token punctuation">}</span>
            
            url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coze_api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">/v1/workflows"</span></span>
            
            <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> json<span class="token operator">=</span>workflow_params<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                <span class="token keyword">if</span> response<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">201</span><span class="token punctuation">:</span>
                    result <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> result<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'workflow_id'</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to create workflow: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">execute_workflow</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> input_data<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""执行工作流"""</span>
        <span class="token keyword">import</span> aiohttp
        
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
            headers <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coze_api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api_key'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
            <span class="token punctuation">}</span>
            
            url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coze_api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">/v1/workflows/</span><span class="token interpolation"><span class="token punctuation">{</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">/execute"</span></span>
            
            <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"inputs"</span><span class="token punctuation">:</span> input_data<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>三、批量自动化执行器</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># batch_executor.py</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> aiohttp
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token punctuation">,</span> Dict<span class="token punctuation">,</span> Any
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> Semaphore
<span class="token keyword">import</span> time

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">BatchTask</span><span class="token punctuation">:</span>
    workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    data<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span>
    priority<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span>
    retry_count<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">class</span> <span class="token class-name">CozeBatchExecutor</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> api_key<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> max_concurrent<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>api_key <span class="token operator">=</span> api_key
        self<span class="token punctuation">.</span>max_concurrent <span class="token operator">=</span> max_concurrent
        self<span class="token punctuation">.</span>semaphore <span class="token operator">=</span> Semaphore<span class="token punctuation">(</span>max_concurrent<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>base_url <span class="token operator">=</span> <span class="token string">"https://api.coze.cn/v1"</span>
        self<span class="token punctuation">.</span>logger <span class="token operator">=</span> self<span class="token punctuation">.</span>setup_logger<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">setup_logger</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">'CozeBatchExecutor'</span><span class="token punctuation">)</span>
        logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
        handler <span class="token operator">=</span> logging<span class="token punctuation">.</span>StreamHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>
        formatter <span class="token operator">=</span> logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">(</span>
            <span class="token string">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span>
        <span class="token punctuation">)</span>
        handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>formatter<span class="token punctuation">)</span>
        logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>
        <span class="token keyword">return</span> logger
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">execute_single_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> BatchTask<span class="token punctuation">,</span> session<span class="token punctuation">:</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""执行单个任务"""</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> self<span class="token punctuation">.</span>semaphore<span class="token punctuation">:</span>
            headers <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>api_key<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
            <span class="token punctuation">}</span>
            
            url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>base_url<span class="token punctuation">}</span></span><span class="token string">/workflows/</span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">/execute"</span></span>
            
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
                    url<span class="token punctuation">,</span> 
                    headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> 
                    json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"inputs"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>data<span class="token punctuation">}</span><span class="token punctuation">,</span>
                    timeout<span class="token operator">=</span>aiohttp<span class="token punctuation">.</span>ClientTimeout<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                    
                    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                        result <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Task completed: </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> <span class="token punctuation">{</span>
                            <span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                            <span class="token string">"data"</span><span class="token punctuation">:</span> result<span class="token punctuation">,</span>
                            <span class="token string">"task"</span><span class="token punctuation">:</span> task
                        <span class="token punctuation">}</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        error_text <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Task failed: </span><span class="token interpolation"><span class="token punctuation">{</span>error_text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        
                        <span class="token keyword">if</span> task<span class="token punctuation">.</span>retry_count <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>
                            task<span class="token punctuation">.</span>retry_count <span class="token operator">+=</span> <span class="token number">1</span>
                            <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> task<span class="token punctuation">.</span>retry_count<span class="token punctuation">)</span>  <span class="token comment"># 指数退避</span>
                            <span class="token keyword">return</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>execute_single_task<span class="token punctuation">(</span>task<span class="token punctuation">,</span> session<span class="token punctuation">)</span>
                        
                        <span class="token keyword">return</span> <span class="token punctuation">{</span>
                            <span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
                            <span class="token string">"error"</span><span class="token punctuation">:</span> error_text<span class="token punctuation">,</span>
                            <span class="token string">"task"</span><span class="token punctuation">:</span> task
                        <span class="token punctuation">}</span>
                        
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Task execution error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> task<span class="token punctuation">.</span>retry_count <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>
                    task<span class="token punctuation">.</span>retry_count <span class="token operator">+=</span> <span class="token number">1</span>
                    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> task<span class="token punctuation">.</span>retry_count<span class="token punctuation">)</span>
                    <span class="token keyword">return</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>execute_single_task<span class="token punctuation">(</span>task<span class="token punctuation">,</span> session<span class="token punctuation">)</span>
                
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    <span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
                    <span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">"task"</span><span class="token punctuation">:</span> task
                <span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">execute_batch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tasks<span class="token punctuation">:</span> List<span class="token punctuation">[</span>BatchTask<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""批量执行任务"""</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
            task_coroutines <span class="token operator">=</span> <span class="token punctuation">[</span>
                self<span class="token punctuation">.</span>execute_single_task<span class="token punctuation">(</span>task<span class="token punctuation">,</span> session<span class="token punctuation">)</span>
                <span class="token keyword">for</span> task <span class="token keyword">in</span> tasks
            <span class="token punctuation">]</span>
            
            results <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>task_coroutines<span class="token punctuation">,</span> return_exceptions<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 处理结果</span>
            processed_results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Task raised exception: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    processed_results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
                        <span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    processed_results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
            
            <span class="token keyword">return</span> processed_results
    
    <span class="token keyword">def</span> <span class="token function">create_batch_from_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> data_list<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>BatchTask<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""从数据列表创建批处理任务"""</span>
        tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> data <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>data_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
            task <span class="token operator">=</span> BatchTask<span class="token punctuation">(</span>
                workflow_id<span class="token operator">=</span>workflow_id<span class="token punctuation">,</span>
                data<span class="token operator">=</span>data<span class="token punctuation">,</span>
                priority<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_list<span class="token punctuation">)</span> <span class="token operator">-</span> i  <span class="token comment"># 让后面的数据先处理</span>
            <span class="token punctuation">)</span>
            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
        <span class="token keyword">return</span> tasks</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>四、增量状态管理器</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># incremental_manager.py</span>
<span class="token keyword">import</span> sqlite3
<span class="token keyword">import</span> json
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Dict
<span class="token keyword">import</span> hashlib

<span class="token keyword">class</span> <span class="token class-name">IncrementalManager</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> db_path<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"incremental_state.db"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>db_path<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>init_database<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">init_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化数据库表"""</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 创建增量状态表</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        CREATE TABLE IF NOT EXISTS incremental_state (
            source_name TEXT PRIMARY KEY,
            last_processed_id TEXT,
            last_processed_time TIMESTAMP,
            checkpoint_data TEXT,
            metadata TEXT
        )
        '''</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 创建批处理记录表</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        CREATE TABLE IF NOT EXISTS batch_records (
            batch_id TEXT PRIMARY KEY,
            workflow_id TEXT,
            total_items INTEGER,
            processed_items INTEGER,
            failed_items INTEGER,
            start_time TIMESTAMP,
            end_time TIMESTAMP,
            status TEXT,
            results TEXT
        )
        '''</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 创建数据哈希表（用于去重）</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        CREATE TABLE IF NOT EXISTS data_hashes (
            data_hash TEXT PRIMARY KEY,
            source_name TEXT,
            processed_time TIMESTAMP,
            FOREIGN KEY (source_name) REFERENCES incremental_state (source_name)
        )
        '''</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">get_last_checkpoint</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Optional<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取最后一个检查点"""</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>
            <span class="token string">'SELECT last_processed_id, last_processed_time, checkpoint_data '</span>
            <span class="token string">'FROM incremental_state WHERE source_name = ?'</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>source_name<span class="token punctuation">,</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> row<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token string">"last_processed_id"</span><span class="token punctuation">:</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"last_processed_time"</span><span class="token punctuation">:</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"checkpoint_data"</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">update_checkpoint</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> checkpoint_data<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""更新检查点"""</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        checkpoint_json <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>checkpoint_data<span class="token punctuation">)</span>
        
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        INSERT OR REPLACE INTO incremental_state 
        (source_name, last_processed_id, last_processed_time, checkpoint_data)
        VALUES (?, ?, ?, ?)
        '''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>
            source_name<span class="token punctuation">,</span>
            checkpoint_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'last_id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            checkpoint_json
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">record_batch_start</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> batch_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> total_items<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""记录批处理开始"""</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        INSERT INTO batch_records 
        (batch_id, workflow_id, total_items, start_time, status)
        VALUES (?, ?, ?, ?, ?)
        '''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>
            batch_id<span class="token punctuation">,</span>
            workflow_id<span class="token punctuation">,</span>
            total_items<span class="token punctuation">,</span>
            datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'running'</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> batch_id
    
    <span class="token keyword">def</span> <span class="token function">record_batch_complete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> batch_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> results<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""记录批处理完成"""</span>
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        success_count <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">for</span> r <span class="token keyword">in</span> results <span class="token keyword">if</span> r<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        failed_count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token operator">-</span> success_count
        
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        UPDATE batch_records 
        SET end_time = ?, status = ?, processed_items = ?, failed_items = ?, results = ?
        WHERE batch_id = ?
        '''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>
            datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'completed'</span><span class="token punctuation">,</span>
            <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">,</span>
            failed_count<span class="token punctuation">,</span>
            json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">,</span>
            batch_id
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">check_data_duplicate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查数据是否已处理（基于哈希）"""</span>
        data_hash <span class="token operator">=</span> self<span class="token punctuation">.</span>generate_data_hash<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>
            <span class="token string">'SELECT 1 FROM data_hashes WHERE data_hash = ? AND source_name = ?'</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>data_hash<span class="token punctuation">,</span> source_name<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">mark_data_processed</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""标记数据已处理"""</span>
        data_hash <span class="token operator">=</span> self<span class="token punctuation">.</span>generate_data_hash<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        INSERT OR IGNORE INTO data_hashes (data_hash, source_name, processed_time)
        VALUES (?, ?, ?)
        '''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data_hash<span class="token punctuation">,</span> source_name<span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">generate_data_hash</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成数据哈希值"""</span>
        <span class="token comment"># 移除可能变化的字段（如时间戳）</span>
        stable_data <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">:</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> data<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> k <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">,</span> <span class="token string">'updated_at'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        data_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>stable_data<span class="token punctuation">,</span> sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>data_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>五、主控制脚本</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># main_controller.py</span>
<span class="token comment">#!/usr/bin/env python3</span>
<span class="token triple-quoted-string string">"""
Coze工作流增量批量自动化主控制器
"""</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> yaml
<span class="token keyword">import</span> argparse
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta
<span class="token keyword">from</span> workflow_generator <span class="token keyword">import</span> CozeWorkflowGenerator
<span class="token keyword">from</span> batch_executor <span class="token keyword">import</span> CozeBatchExecutor
<span class="token keyword">from</span> incremental_manager <span class="token keyword">import</span> IncrementalManager
<span class="token keyword">import</span> logging

<span class="token keyword">class</span> <span class="token class-name">CozeAutomationController</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config_file<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"config.yaml"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>config_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>config <span class="token operator">=</span> yaml<span class="token punctuation">.</span>safe_load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>workflow_generator <span class="token operator">=</span> CozeWorkflowGenerator<span class="token punctuation">(</span>config_file<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>batch_executor <span class="token operator">=</span> CozeBatchExecutor<span class="token punctuation">(</span>
            api_key<span class="token operator">=</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'coze_api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api_key'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            max_concurrent<span class="token operator">=</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'batch_processing'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'max_concurrent'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>incremental_manager <span class="token operator">=</span> IncrementalManager<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setup_logging<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">setup_logging</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
            level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
            <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span><span class="token punctuation">,</span>
            handlers<span class="token operator">=</span><span class="token punctuation">[</span>
                logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'automation_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">.log'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                logging<span class="token punctuation">.</span>StreamHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run_incremental_pipeline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""运行增量处理管道"""</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Starting incremental pipeline for </span><span class="token interpolation"><span class="token punctuation">{</span>source_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 1. 获取增量数据</span>
        incremental_data <span class="token operator">=</span> self<span class="token punctuation">.</span>workflow_generator<span class="token punctuation">.</span>detect_incremental_data<span class="token punctuation">(</span>source_name<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> incremental_data<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"No new data to process"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>incremental_data<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> new items to process"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 2. 去重检查</span>
        unique_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> data <span class="token keyword">in</span> incremental_data<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>incremental_manager<span class="token punctuation">.</span>check_data_duplicate<span class="token punctuation">(</span>source_name<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
                unique_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> unique_data<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"All data already processed"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        
        <span class="token comment"># 3. 生成工作流</span>
        workflow_params <span class="token operator">=</span> self<span class="token punctuation">.</span>workflow_generator<span class="token punctuation">.</span>generate_workflow_parameters<span class="token punctuation">(</span>unique_data<span class="token punctuation">)</span>
        
        <span class="token comment"># 4. 创建工作流</span>
        workflow_id <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>workflow_generator<span class="token punctuation">.</span>create_workflow<span class="token punctuation">(</span>workflow_params<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Created workflow: </span><span class="token interpolation"><span class="token punctuation">{</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 5. 创建批处理任务</span>
        batch_tasks <span class="token operator">=</span> self<span class="token punctuation">.</span>batch_executor<span class="token punctuation">.</span>create_batch_from_data<span class="token punctuation">(</span>workflow_id<span class="token punctuation">,</span> unique_data<span class="token punctuation">)</span>
        
        <span class="token comment"># 6. 记录批处理开始</span>
        batch_id <span class="token operator">=</span> self<span class="token punctuation">.</span>incremental_manager<span class="token punctuation">.</span>record_batch_start<span class="token punctuation">(</span>
            batch_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"batch_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d_%H%M%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            workflow_id<span class="token operator">=</span>workflow_id<span class="token punctuation">,</span>
            total_items<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>batch_tasks<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 7. 执行批处理</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Executing batch </span><span class="token interpolation"><span class="token punctuation">{</span>batch_id<span class="token punctuation">}</span></span><span class="token string"> with </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>batch_tasks<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> tasks"</span></span><span class="token punctuation">)</span>
        results <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>batch_executor<span class="token punctuation">.</span>execute_batch<span class="token punctuation">(</span>batch_tasks<span class="token punctuation">)</span>
        
        <span class="token comment"># 8. 记录结果</span>
        self<span class="token punctuation">.</span>incremental_manager<span class="token punctuation">.</span>record_batch_complete<span class="token punctuation">(</span>batch_id<span class="token punctuation">,</span> results<span class="token punctuation">)</span>
        
        <span class="token comment"># 9. 更新状态</span>
        <span class="token keyword">for</span> data <span class="token keyword">in</span> unique_data<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>incremental_manager<span class="token punctuation">.</span>mark_data_processed<span class="token punctuation">(</span>source_name<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        
        <span class="token comment"># 10. 保存检查点</span>
        checkpoint <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"last_id"</span><span class="token punctuation">:</span> unique_data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> unique_data <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">,</span>
            <span class="token string">"batch_id"</span><span class="token punctuation">:</span> batch_id<span class="token punctuation">,</span>
            <span class="token string">"processed_count"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>unique_data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>incremental_manager<span class="token punctuation">.</span>update_checkpoint<span class="token punctuation">(</span>source_name<span class="token punctuation">,</span> checkpoint<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Incremental pipeline completed for </span><span class="token interpolation"><span class="token punctuation">{</span>source_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run_scheduled_batch</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""运行定时批处理"""</span>
        sources <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_automation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'data_sources'</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> source <span class="token keyword">in</span> sources<span class="token punctuation">:</span>
            source_name <span class="token operator">=</span> source<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> source<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>run_incremental_pipeline<span class="token punctuation">(</span>source_name<span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error processing </span><span class="token interpolation"><span class="token punctuation">{</span>source_name<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
    
    <span class="token keyword">def</span> <span class="token function">generate_monitoring_dashboard</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成监控仪表板"""</span>
        <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
        <span class="token keyword">from</span> tabulate <span class="token keyword">import</span> tabulate
        
        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>incremental_manager<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 获取批处理统计</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
        SELECT 
            batch_id,
            workflow_id,
            total_items,
            processed_items,
            failed_items,
            status,
            start_time,
            end_time
        FROM batch_records
        ORDER BY start_time DESC
        LIMIT 10
        '''</span><span class="token punctuation">)</span>
        
        batches <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>batches<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span>
            <span class="token string">'Batch ID'</span><span class="token punctuation">,</span> <span class="token string">'Workflow ID'</span><span class="token punctuation">,</span> <span class="token string">'Total'</span><span class="token punctuation">,</span> <span class="token string">'Processed'</span><span class="token punctuation">,</span> 
            <span class="token string">'Failed'</span><span class="token punctuation">,</span> <span class="token string">'Status'</span><span class="token punctuation">,</span> <span class="token string">'Start Time'</span><span class="token punctuation">,</span> <span class="token string">'End Time'</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== Coze自动化处理监控仪表板 ==="</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"生成时间: </span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n最近10个批处理任务:"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>tabulate<span class="token punctuation">(</span>df<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token string">'keys'</span><span class="token punctuation">,</span> tablefmt<span class="token operator">=</span><span class="token string">'grid'</span><span class="token punctuation">,</span> showindex<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 统计信息</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT COUNT(*) FROM batch_records'</span><span class="token punctuation">)</span>
        total_batches <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT SUM(total_items) FROM batch_records'</span><span class="token punctuation">)</span>
        total_items <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token number">0</span>
        
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT SUM(failed_items) FROM batch_records'</span><span class="token punctuation">)</span>
        failed_items <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token number">0</span>
        
        success_rate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>total_items <span class="token operator">-</span> failed_items<span class="token punctuation">)</span> <span class="token operator">/</span> total_items <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">if</span> total_items <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n总体统计:"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"- 总批次数: </span><span class="token interpolation"><span class="token punctuation">{</span>total_batches<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"- 总处理项: </span><span class="token interpolation"><span class="token punctuation">{</span>total_items<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"- 失败项: </span><span class="token interpolation"><span class="token punctuation">{</span>failed_items<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"- 成功率: </span><span class="token interpolation"><span class="token punctuation">{</span>success_rate<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">%"</span></span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'Coze工作流增量批量自动化处理器'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--config'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'config.yaml'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'配置文件路径'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--mode'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'run'</span><span class="token punctuation">,</span> <span class="token string">'monitor'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                       default<span class="token operator">=</span><span class="token string">'run'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'运行模式'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--source'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'指定数据源'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--batch-size'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'批处理大小'</span><span class="token punctuation">)</span>
    
    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    controller <span class="token operator">=</span> CozeAutomationController<span class="token punctuation">(</span>args<span class="token punctuation">.</span>config<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'run'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> args<span class="token punctuation">.</span>source<span class="token punctuation">:</span>
            <span class="token keyword">await</span> controller<span class="token punctuation">.</span>run_incremental_pipeline<span class="token punctuation">(</span>args<span class="token punctuation">.</span>source<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">await</span> controller<span class="token punctuation">.</span>run_scheduled_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'monitor'</span><span class="token punctuation">:</span>
        controller<span class="token punctuation">.</span>generate_monitoring_dashboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'test'</span><span class="token punctuation">:</span>
        <span class="token comment"># 测试模式</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"运行测试..."</span><span class="token punctuation">)</span>
        <span class="token comment"># 这里可以添加测试代码</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>六、部署和运行脚本</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">bash</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># deploy.sh - 部署脚本</span>

<span class="token comment"># 1. 安装依赖</span>
pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt

<span class="token comment"># requirements.txt 内容：</span>
<span class="token comment"># aiohttp&gt;=3.8.0</span>
<span class="token comment"># jinja2&gt;=3.1.0</span>
<span class="token comment"># pyyaml&gt;=6.0</span>
<span class="token comment"># pandas&gt;=2.0.0</span>
<span class="token comment"># tabulate&gt;=0.9.0</span>

<span class="token comment"># 2. 创建目录结构</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token punctuation">{</span>templates,logs,data,output<span class="token punctuation">}</span>

<span class="token comment"># 3. 设置环境变量</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">COZE_API_KEY</span><span class="token operator">=</span><span class="token string">"your_api_key_here"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB_CONNECTION</span><span class="token operator">=</span><span class="token string">"your_db_connection_string"</span>

<span class="token comment"># 4. 运行自动化处理</span>
python main_controller.py <span class="token parameter variable">--mode</span> run

<span class="token comment"># 5. 查看监控面板</span>
python main_controller.py <span class="token parameter variable">--mode</span> monitor</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>七、定时任务配置</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">yaml</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># crontab配置</span>
<span class="token comment"># 每小时运行一次增量处理</span>
0 * * * * cd /path/to/coze<span class="token punctuation">-</span>automation <span class="token important">&amp;&amp;</span> python main_controller.py <span class="token punctuation">-</span><span class="token punctuation">-</span>mode run <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> logs/cron.log 2<span class="token punctuation">&gt;</span><span class="token important">&amp;1</span>

<span class="token comment"># 每天凌晨清理旧数据</span>
0 0 * * * find /path/to/coze<span class="token punctuation">-</span>automation/logs <span class="token punctuation">-</span>name "<span class="token important">*.log"</span> <span class="token punctuation">-</span>mtime +7 <span class="token punctuation">-</span>delete</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>八、监控告警配置</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># alert_manager.py</span>
<span class="token keyword">import</span> smtplib
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token keyword">class</span> <span class="token class-name">AlertManager</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>config <span class="token operator">=</span> config
    
    <span class="token keyword">def</span> <span class="token function">send_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> subject<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> level<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送告警"""</span>
        <span class="token keyword">if</span> level <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'alerts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'levels'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        
        <span class="token comment"># 邮件告警</span>
        <span class="token keyword">if</span> <span class="token string">'email'</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'alerts'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>send_email_alert<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> message<span class="token punctuation">)</span>
        
        <span class="token comment"># Webhook告警</span>
        <span class="token keyword">if</span> <span class="token string">'webhook'</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'alerts'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>send_webhook_alert<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> message<span class="token punctuation">,</span> level<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">send_email_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> subject<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送邮件告警"""</span>
        msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">'plain'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        msg<span class="token punctuation">[</span><span class="token string">'Subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"[Coze自动化告警] </span><span class="token interpolation"><span class="token punctuation">{</span>subject<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        msg<span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'alerts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span>
        msg<span class="token punctuation">[</span><span class="token string">'To'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">', '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'alerts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">with</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'alerts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'smtp_server'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">as</span> server<span class="token punctuation">:</span>
            server<span class="token punctuation">.</span>send_message<span class="token punctuation">(</span>msg<span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><p class="ds-markdown-paragraph"><span>这个完整解决方案提供了：</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>增量检测</span></strong><span> - 基于时间戳或ID的增量数据识别</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>批量处理</span></strong><span> - 并发执行多个工作流任务</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>状态管理</span></strong><span> - 记录处理状态，防止重复处理</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>错误重试</span></strong><span> - 自动重试失败的任务</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>监控告警</span></strong><span> - 实时监控和异常告警</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>模板化生成</span></strong><span> - 基于模板动态生成工作流</span></p></li></ol><p class="ds-markdown-paragraph"><span>您可以根据实际需求调整各个模块的参数和配置。</span></p></div><div class="dbe8cf4a">本回答由 AI 生成，内容仅供参考，请仔细甄别。</div></div><div class="ds-theme" style="--ds-rgb-hover:245 245 245; --ds-rgb-primary:77 107 254; --ds-bordered-secondary-button-color:var(--dsr-text-1); --ds-input-prefix-color:var(--dsr-text-1);"></div><div class="ds-flex _0a3d93b fa1bcf13" style="align-items: center; gap: 10px;"><div class="ds-flex _965abe9" style="align-items: center; gap: 10px;"><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.92139 0.349152C10.3744 0.349234 12.5564 1.5052 13.9558 3.29894L15.1281 2.12759C15.3304 1.92546 15.6767 2.06943 15.6767 2.35538V5.53923C15.6766 5.71626 15.5329 5.85976 15.3559 5.86002H12.171C11.8855 5.8597 11.7426 5.51465 11.9443 5.31249L12.9641 4.29056C11.8237 2.74305 9.98911 1.74106 7.92139 1.74097C4.46439 1.74097 1.66236 4.543 1.66236 8C1.66236 11.457 4.46439 14.259 7.92139 14.259C11.3783 14.2589 14.1804 11.4569 14.1804 8H15.5722C15.5722 12.2251 12.1465 15.6507 7.92139 15.6508C3.69617 15.6508 0.270538 12.2252 0.270538 8C0.270538 3.77478 3.69617 0.349152 7.92139 0.349152Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.27861 0.811572C8.81985 0.142194 9.79016 0.0421835 10.4537 0.557601L10.5823 0.669306L10.6065 0.693544L10.6097 0.695652L10.6392 0.725159C11.3549 1.44679 11.6336 2.49468 11.3716 3.47669L11.3705 3.48091L11.361 3.51674L11.36 3.51885L10.8889 5.22604C10.8796 5.25997 10.8706 5.29157 10.8626 5.32088C10.8934 5.32095 10.927 5.32194 10.9627 5.32194H11.9006C12.4263 5.32194 12.783 5.319 13.0651 5.36725C14.8182 5.66719 15.9851 7.34568 15.6564 9.09357C15.6035 9.37487 15.4769 9.7092 15.2939 10.2022L14.337 12.7798C14.1401 13.3104 13.9773 13.7518 13.8101 14.1024C13.6375 14.4645 13.4385 14.7793 13.1441 15.0424C12.9712 15.197 12.7801 15.3303 12.5751 15.4386C12.2259 15.6231 11.8608 15.7 11.4612 15.7358C11.0742 15.7705 10.6034 15.7695 10.0374 15.7695H4.87371C4.08047 15.7695 3.42922 15.7702 2.90728 15.7137C2.37206 15.6557 1.88985 15.5311 1.4667 15.2237C1.22409 15.0474 1.01072 14.8339 0.834405 14.5914C0.52696 14.1682 0.401312 13.686 0.343323 13.1508C0.286761 12.6287 0.28747 11.9769 0.28747 11.1833V9.51405C0.28747 8.84778 0.281286 8.36714 0.399176 7.9565C0.671091 7.00935 1.41109 6.26832 2.35823 5.99638C2.76888 5.87849 3.24952 5.88573 3.91579 5.88573C4.11977 5.88573 4.14542 5.88319 4.16238 5.88046C4.23526 5.86863 4.30403 5.83663 4.35839 5.78667C4.37104 5.77504 4.38755 5.75604 4.51436 5.59488L8.25648 0.838972L8.25754 0.837918L8.27861 0.811572ZM1.69116 11.1833C1.69116 12.0082 1.69211 12.5711 1.73859 13.0001C1.78365 13.4157 1.86467 13.6221 1.96937 13.7662C2.05914 13.8898 2.16727 13.9989 2.29079 14.0887C2.43495 14.1934 2.6421 14.2744 3.05797 14.3195C3.45891 14.3629 3.97631 14.3656 4.71564 14.3659C4.30795 13.8053 4.06447 13.1171 4.06437 12.371V8.59406H5.46807V12.371C5.46832 13.4733 6.3616 14.3669 7.46401 14.3669H10.0374C10.6286 14.3669 11.0269 14.3663 11.3368 14.3385C11.6339 14.3118 11.7956 14.2638 11.9196 14.1983C12.024 14.1431 12.1213 14.0747 12.2094 13.996C12.3139 13.9025 12.4151 13.7678 12.5434 13.4986C12.6774 13.2176 12.8162 12.845 13.0219 12.2909L13.9787 9.71322C14.1848 9.15816 14.253 8.96731 14.278 8.83433C14.4617 7.85692 13.8092 6.91895 12.829 6.75092C12.6956 6.7281 12.4928 6.72458 11.9006 6.72458H10.9627C10.7737 6.72458 10.5693 6.72657 10.4 6.70666C10.2211 6.68562 9.96696 6.63024 9.74764 6.43161C9.64448 6.33811 9.5595 6.2261 9.49683 6.10177C9.36384 5.83784 9.37793 5.57899 9.40515 5.40097C9.43094 5.23261 9.48666 5.03616 9.53688 4.85404L10.0079 3.14579L10.0174 3.11102C10.1488 2.61338 10.0077 2.08338 9.64648 1.71681L9.60854 1.67887L9.55058 1.64304C9.48789 1.62043 9.41419 1.63814 9.36932 1.69362L9.35773 1.70627L9.35878 1.70732L5.61666 6.46217C5.51816 6.58735 5.42231 6.7133 5.30683 6.81942C5.05069 7.05471 4.73119 7.20939 4.3879 7.26519C4.23309 7.29032 4.07507 7.28837 3.91579 7.28837C3.1535 7.28837 2.9191 7.2957 2.74604 7.34528C2.26358 7.48379 1.88558 7.86081 1.74702 8.34325C1.69732 8.51636 1.69116 8.7511 1.69116 9.51405V11.1833Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.72451 15.1086C7.18929 15.7705 6.22975 15.8694 5.57357 15.3597L5.44643 15.2492L5.42247 15.2253L5.41934 15.2232L5.39016 15.194C4.68239 14.4804 4.40679 13.4442 4.66589 12.473L4.66693 12.4689L4.67631 12.4334L4.67735 12.4314L5.14318 10.7431C5.15243 10.7096 5.1613 10.6783 5.16923 10.6493C5.13878 10.6493 5.10558 10.6483 5.07023 10.6483H4.14274C3.62288 10.6483 3.27015 10.6512 2.9912 10.6035C1.25757 10.3069 0.103662 8.64703 0.42863 6.91855C0.480965 6.64038 0.606164 6.30975 0.787119 5.82224L1.73336 3.27321C1.92812 2.74853 2.08912 2.31209 2.25442 1.96535C2.42515 1.60725 2.62191 1.29594 2.91304 1.03578C3.08408 0.882955 3.273 0.751124 3.47579 0.643948C3.82102 0.461508 4.18214 0.385514 4.57731 0.35007C4.95993 0.315788 5.42553 0.316722 5.98521 0.316722H11.0916C11.876 0.316722 12.52 0.316073 13.0362 0.371954C13.5655 0.429296 14.0423 0.552538 14.4608 0.85654C14.7007 1.03085 14.9117 1.24193 15.086 1.48181C15.3901 1.90027 15.5143 2.3771 15.5717 2.90639C15.6276 3.42269 15.6269 4.06721 15.6269 4.85203V6.50274C15.6269 7.1616 15.633 7.63691 15.5164 8.04299C15.2475 8.97962 14.5158 9.71242 13.5791 9.98134C13.173 10.0979 12.6977 10.0908 12.0389 10.0908C11.8372 10.0908 11.8118 10.0933 11.795 10.096C11.723 10.1077 11.6549 10.1393 11.6012 10.1887C11.5887 10.2002 11.5724 10.219 11.447 10.3784L7.74639 15.0815L7.74535 15.0825L7.72451 15.1086ZM14.2388 4.85203C14.2388 4.03628 14.2379 3.47965 14.1919 3.05541C14.1473 2.64443 14.0672 2.4403 13.9637 2.29779C13.8749 2.17563 13.768 2.06769 13.6458 1.9789C13.5033 1.87533 13.2984 1.79523 12.8872 1.75068C12.4907 1.70773 11.979 1.70512 11.2479 1.70482C11.6511 2.25918 11.8918 2.93968 11.8919 3.67756V7.41251H10.5038V3.67756C10.5036 2.58745 9.62023 1.70378 8.53007 1.70378H5.98521C5.40065 1.70378 5.00679 1.70443 4.70028 1.73192C4.40651 1.7583 4.24662 1.80571 4.12399 1.87052C4.02069 1.92512 3.92452 1.99277 3.8374 2.07061C3.73401 2.16306 3.634 2.29621 3.50705 2.56249C3.37462 2.84028 3.23734 3.20874 3.03393 3.75676L2.08768 6.30578C1.88395 6.85468 1.81646 7.04341 1.79172 7.17491C1.61005 8.14146 2.25533 9.06902 3.22464 9.23518C3.35654 9.25775 3.55717 9.26123 4.14274 9.26123H5.07023C5.25717 9.26123 5.4593 9.25926 5.62672 9.27895C5.80364 9.29976 6.05492 9.35452 6.27179 9.55094C6.37381 9.6434 6.45784 9.75417 6.51982 9.87712C6.65133 10.1381 6.6374 10.3941 6.61048 10.5701C6.58498 10.7366 6.52988 10.9309 6.48022 11.111L6.01439 12.8003L6.00501 12.8347C5.87513 13.3268 6.01464 13.8509 6.37184 14.2134L6.40935 14.2509L6.46667 14.2863C6.52866 14.3087 6.60155 14.2912 6.64591 14.2363L6.65738 14.2238L6.65633 14.2228L10.3569 9.52072C10.4543 9.39693 10.5491 9.27239 10.6633 9.16744C10.9166 8.93477 11.2325 8.7818 11.572 8.72662C11.7251 8.70177 11.8814 8.7037 12.0389 8.7037C12.7927 8.7037 13.0245 8.69645 13.1956 8.64742C13.6727 8.51045 14.0465 8.13762 14.1836 7.66054C14.2327 7.48935 14.2388 7.25721 14.2388 6.50274V4.85203Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.7483 11.1003C15.6274 11.8866 15.5288 12.5364 15.3881 13.0496C15.243 13.5789 15.0339 14.0407 14.6455 14.4162C14.5638 14.4951 14.4775 14.5699 14.387 14.6386C13.9568 14.9655 13.4683 15.1011 12.9229 15.1641C12.3944 15.2251 11.7374 15.2245 10.9419 15.2245H5.05805C4.26257 15.2245 3.60557 15.2251 3.077 15.1641C2.53167 15.1011 2.04314 14.9655 1.61293 14.6386C1.52245 14.5699 1.43615 14.4951 1.35444 14.4162C0.96605 14.0407 0.756931 13.5789 0.611809 13.0496C0.471132 12.5364 0.372585 11.8866 0.251617 11.1003L1.64577 10.8863C1.77178 11.7054 1.85788 12.2601 1.97206 12.6767C2.08171 13.0766 2.19757 13.27 2.33437 13.4023C2.376 13.4426 2.4207 13.4807 2.46679 13.5157C2.61837 13.6308 2.82717 13.716 3.23909 13.7636C3.66809 13.8131 4.22946 13.8144 5.05805 13.8144H10.9419C11.7705 13.8144 12.3319 13.8131 12.7609 13.7636C13.1728 13.716 13.3816 13.6308 13.5331 13.5157C13.5792 13.4807 13.6239 13.4426 13.6656 13.4023C13.8024 13.27 13.9182 13.0766 14.0279 12.6767C14.1421 12.2601 14.2282 11.7054 14.3542 10.8863L15.7483 11.1003ZM7.715 0.558333C7.90368 0.527919 8.09626 0.527919 8.28495 0.558333C8.63703 0.61512 8.9129 0.790062 9.14941 0.985266C9.37576 1.1721 9.62515 1.42888 9.90475 1.71624L13.387 5.29485L12.8816 5.78747L12.3763 6.27902L8.89409 2.70041C8.82605 2.63048 8.76283 2.5671 8.70552 2.50866V10.5335H7.29442V2.50866C7.23711 2.5671 7.17389 2.63048 7.10585 2.70041L3.62365 6.27902L3.11832 5.78747L2.61299 5.29485L6.09519 1.71624C6.37479 1.42888 6.62419 1.1721 6.85054 0.985266C7.08704 0.790062 7.36291 0.61512 7.715 0.558333Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div></div><div style="flex: 1 1 0%;"></div></div></div><div class="_9663006"><div class="d30139ff"><div class="ad950ab7"><div class="ds-checkbox-align-wrapper"><div class="ds-checkbox ds-checkbox--l ds-checkbox--active ds-checkbox--none" tabindex="0" style="align-self: flex-start; --line-height: unset;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5625 4.49518L7.61331 8.98248C7.35059 9.28094 7.11252 9.55346 6.89359 9.75201C6.66498 9.95932 6.38424 10.1559 6.0137 10.2217C5.81985 10.2561 5.62112 10.2582 5.42679 10.2266C5.05515 10.1662 4.77171 9.97269 4.54007 9.76862C4.31832 9.57324 4.07657 9.30444 3.8096 9.00983L2.44437 7.50397L3.55569 6.49615L4.92093 8.00299C5.21161 8.32377 5.38783 8.51724 5.53128 8.64362C5.60927 8.71232 5.65159 8.73725 5.668 8.74518C5.69553 8.74962 5.72354 8.75 5.75101 8.74518C5.72562 8.74984 5.75469 8.75955 5.88577 8.64069C6.02738 8.51225 6.20131 8.31621 6.48734 7.99127L10.4375 3.50494L11.5625 4.49518Z" fill="currentColor"></path></svg></div></div></div></div><div class="d29f3d7d ds-message _6e8caf5 _7729a77" style="--panel-width:979px;"><div class="fbb737a4">增量批量自动化生成制作完整的coze工作流和完整coze工作流参数和增量批量自动化处理操作自动化运行和多种增量批量类数据自动化处理自动化操作和自动化生成完整工作流节点需求配置和完整无冲突自动化运行</div></div><div class="_11d6b3a"><div class="_425ea0b fa1bcf13"><div class="ds-flex _78e0558 _0bbda35" style="align-items: flex-end; gap: 0px;"><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="d4910adc ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false" style="margin-left: 10px;"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.94073 1.34942C10.7047 0.902314 11.6503 0.902418 12.4143 1.34942C12.706 1.52016 12.9687 1.79118 13.3104 2.13284C13.652 2.47448 13.9231 2.73721 14.0938 3.02894C14.5408 3.79295 14.5409 4.73856 14.0938 5.50251C13.9231 5.79415 13.652 6.05704 13.3104 6.39861L6.65929 13.0497C6.28065 13.4284 6.00692 13.7108 5.6654 13.9097C5.32388 14.1085 4.94312 14.2074 4.42702 14.3498L3.24391 14.6761C2.77524 14.8054 2.34535 14.9262 2.00128 14.9684C1.65193 15.0112 1.17961 15.0013 0.810733 14.6325C0.44189 14.2637 0.432076 13.7913 0.474829 13.442C0.517004 13.0979 0.63787 12.668 0.767151 12.1993L1.09349 11.0162C1.23585 10.5001 1.33478 10.1194 1.53356 9.77785C1.73246 9.43633 2.01487 9.1626 2.39352 8.78395L9.04463 2.13284C9.38622 1.79126 9.64908 1.52017 9.94073 1.34942ZM15.5427 14.8398H7.5522L8.96704 13.425H15.5427V14.8398ZM3.39379 9.78423C2.96497 10.2131 2.84241 10.3436 2.75706 10.49C2.6718 10.6366 2.61858 10.8079 2.4573 11.3925L2.13096 12.5756C2.0018 13.0439 1.92191 13.3419 1.8886 13.5536C2.10038 13.5204 2.39869 13.4416 2.86761 13.3123L4.05072 12.9859C4.63541 12.8246 4.80666 12.7715 4.9532 12.6862C5.09965 12.6008 5.23019 12.4783 5.65902 12.0495L10.721 6.98644L8.45574 4.72122L3.39379 9.78423ZM11.7 2.57079C11.3774 2.38199 10.9777 2.38199 10.6551 2.57079C10.5602 2.62647 10.4487 2.72931 10.0449 3.13311L9.45601 3.72094L11.7212 5.98617L12.3101 5.39834C12.7139 4.99458 12.8168 4.88307 12.8725 4.78818C13.0612 4.46561 13.0612 4.06586 12.8725 3.74327C12.8168 3.64827 12.7145 3.53752 12.3101 3.13311C11.9057 2.72863 11.795 2.62641 11.7 2.57079Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div></div></div></div></div><div class="_4f9bf79 d7dc56a8 _43c05b5" style="--assistant-last-margin-bottom:32px;"><div class="d30139ff"><div class="ad950ab7"><div class="ds-checkbox-align-wrapper"><div class="ds-checkbox ds-checkbox--l ds-checkbox--active ds-checkbox--none" tabindex="0" style="align-self: flex-start; --line-height: unset;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5625 4.49518L7.61331 8.98248C7.35059 9.28094 7.11252 9.55346 6.89359 9.75201C6.66498 9.95932 6.38424 10.1559 6.0137 10.2217C5.81985 10.2561 5.62112 10.2582 5.42679 10.2266C5.05515 10.1662 4.77171 9.97269 4.54007 9.76862C4.31832 9.57324 4.07657 9.30444 3.8096 9.00983L2.44437 7.50397L3.55569 6.49615L4.92093 8.00299C5.21161 8.32377 5.38783 8.51724 5.53128 8.64362C5.60927 8.71232 5.65159 8.73725 5.668 8.74518C5.69553 8.74962 5.72354 8.75 5.75101 8.74518C5.72562 8.74984 5.75469 8.75955 5.88577 8.64069C6.02738 8.51225 6.20131 8.31621 6.48734 7.99127L10.4375 3.50494L11.5625 4.49518Z" fill="currentColor"></path></svg></div></div></div></div><div class="ds-message _6e8caf5 _7729a77" style="--panel-width:979px;"><div class="_74c0879" style="--collapsible-area-title-height:38px; --group-title-sticky-top:0px;"><div class="_245c867 a51c5344"><div class="_5ab5d64"><div class="ds-icon _970ac5e" style="font-size: 16px; width: 16px; height: 16px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.00195 6.64454C8.75029 6.64454 9.35735 7.25169 9.35742 8.00001C9.35742 8.74838 8.75033 9.35548 8.00195 9.35548C7.2537 9.35533 6.64746 8.74829 6.64746 8.00001C6.64753 7.25178 7.25374 6.64468 8.00195 6.64454Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M9.97168 1.29981C11.5854 0.718916 13.271 0.642197 14.3145 1.68555C15.3578 2.72902 15.2811 4.41466 14.7002 6.02833C14.4708 6.66561 14.1505 7.32937 13.75 8.00001C14.1505 8.67062 14.4708 9.33444 14.7002 9.97169C15.2811 11.5854 15.3579 13.271 14.3145 14.3145C13.271 15.3579 11.5854 15.2811 9.97168 14.7002C9.33443 14.4708 8.67062 14.1505 8 13.75C7.32936 14.1505 6.66561 14.4708 6.02832 14.7002C4.41464 15.2811 2.72902 15.3578 1.68555 14.3145C0.642186 13.271 0.718901 11.5854 1.29981 9.97169C1.52918 9.33454 1.84868 8.67049 2.24902 8.00001C1.84869 7.32953 1.52918 6.66544 1.29981 6.02833C0.718882 4.41459 0.6421 2.729 1.68555 1.68555C2.729 0.642112 4.41459 0.718887 6.02832 1.29981C6.66544 1.52918 7.32953 1.8487 8 2.24903C8.67048 1.84869 9.33454 1.52919 9.97168 1.29981ZM12.9404 9.2129C12.4391 9.893 11.8616 10.5681 11.2148 11.2149C10.5681 11.8616 9.89299 12.4391 9.21289 12.9404C9.62535 13.1579 10.0271 13.338 10.4121 13.4766C11.9146 14.0174 12.9173 13.8738 13.3955 13.3955C13.8737 12.9173 14.0174 11.9146 13.4766 10.4121C13.338 10.0271 13.1579 9.62535 12.9404 9.2129ZM3.05859 9.2129C2.84124 9.62523 2.662 10.0272 2.52344 10.4121C1.98255 11.9146 2.1263 12.9172 2.60449 13.3955C3.08281 13.8737 4.08548 14.0174 5.58789 13.4766C5.97267 13.338 6.37392 13.1577 6.78613 12.9404C6.10627 12.4393 5.43171 11.8614 4.78516 11.2149C4.13826 10.5679 3.55995 9.89313 3.05859 9.2129ZM7.99902 3.792C7.23182 4.31419 6.45309 4.95512 5.7041 5.70411C4.95512 6.45309 4.31418 7.23184 3.79199 7.99903C4.31434 8.76666 4.95474 9.54653 5.7041 10.2959C6.45312 11.0449 7.23274 11.6848 8 12.207C8.76728 11.6848 9.54686 11.0449 10.2959 10.2959C11.0449 9.54686 11.6848 8.76729 12.207 8.00001C11.6848 7.23275 11.0449 6.45312 10.2959 5.70411C9.54653 4.95475 8.76665 4.31434 7.99902 3.792ZM5.58789 2.52344C4.08536 1.98255 3.08275 2.12625 2.60449 2.6045C2.12624 3.08275 1.98255 4.08536 2.52344 5.5879C2.66192 5.97253 2.84143 6.37409 3.05859 6.78614C3.55986 6.10611 4.13843 5.43189 4.78516 4.78516C5.4319 4.13843 6.10609 3.55987 6.78613 3.0586C6.37408 2.84144 5.97252 2.66192 5.58789 2.52344ZM13.3955 2.6045C12.9172 2.12631 11.9146 1.98257 10.4121 2.52344C10.0272 2.66201 9.62522 2.84125 9.21289 3.0586C9.89313 3.55996 10.5679 4.13827 11.2148 4.78516C11.8614 5.43172 12.4392 6.10627 12.9404 6.78614C13.1577 6.37393 13.338 5.97267 13.4766 5.5879C14.0174 4.08549 13.8736 3.08281 13.3955 2.6045Z" fill="currentColor"></path></svg></div><span class="_5255ff8 _4d41763">已思考（用时 8 秒）</span><div class="ds-icon" style="font-size: 14px; width: 14px; height: 14px;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.8486 5.5L11.4238 5.92383L8.69727 8.65137C8.44157 8.90706 8.21562 9.13382 8.01172 9.29785C7.79912 9.46883 7.55595 9.61756 7.25 9.66602C7.08435 9.69222 6.91565 9.69222 6.75 9.66602C6.44405 9.61756 6.20088 9.46883 5.98828 9.29785C5.78438 9.13382 5.55843 8.90706 5.30273 8.65137L2.57617 5.92383L2.15137 5.5L3 4.65137L3.42383 5.07617L6.15137 7.80273C6.42595 8.07732 6.59876 8.24849 6.74023 8.3623C6.87291 8.46904 6.92272 8.47813 6.9375 8.48047C6.97895 8.48703 7.02105 8.48703 7.0625 8.48047C7.07728 8.47813 7.12709 8.46904 7.25977 8.3623C7.40124 8.24849 7.57405 8.07732 7.84863 7.80273L10.5762 5.07617L11 4.65137L11.8486 5.5Z" fill="currentColor"></path></svg></div></div><div class="c99b79f8" style="opacity: 0;"></div></div><div class="c2b72bb8"></div><div class="e1675d8b ds-think-content _767406f"><div class="ddd26891 _9b52f6c" style="width: 16px; height: 16px;"><div class="a510c7ce _0652043"></div></div><div class="_9ecc93a"></div><div class="ds-markdown pointer-events-none" style="--ds-md-zoom:1.143;"><p class="ds-markdown-paragraph"><span>我们设计一个完整的增量批量自动化系统，用于生成和运行Coze工作流。这个系统将包括以下功能：</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><span>增量数据检测：从多种数据源（数据库、API、文件）中检测增量数据。</span></p></li><li><p class="ds-markdown-paragraph"><span>工作流模板化生成：使用Jinja2模板生成Coze工作流配置。</span></p></li><li><p class="ds-markdown-paragraph"><span>批量自动化执行：并发执行多个工作流实例，并处理错误重试。</span></p></li><li><p class="ds-markdown-paragraph"><span>状态管理：记录增量处理的状态，避免重复处理。</span></p></li><li><p class="ds-markdown-paragraph"><span>监控与告警：提供监控仪表板和告警功能。</span></p></li></ol><p class="ds-markdown-paragraph"><span>我们将按照以下步骤进行：</span><br><span>一、系统架构设计</span><br><span>二、配置文件设计</span><br><span>三、增量数据检测模块</span><br><span>四、工作流生成模块</span><br><span>五、批量执行模块</span><br><span>六、状态管理模块</span><br><span>七、主控制模块</span><br><span>八、监控与告警模块</span></p><p class="ds-markdown-paragraph"><span>由于代码量较大，我将分模块给出关键代码。</span></p><p class="ds-markdown-paragraph"><span>首先，我们设计配置文件（config.yaml）的结构，然后实现各个模块。</span></p><p class="ds-markdown-paragraph"><span>注意：由于Coze API的具体细节可能随时变化，以下代码中与API交互的部分可能需要调整。</span></p><p class="ds-markdown-paragraph"><span>我们假设Coze API的基本操作：</span></p><ul><li><p class="ds-markdown-paragraph"><span>创建工作流：POST /v1/workflows</span></p></li><li><p class="ds-markdown-paragraph"><span>执行工作流：POST /v1/workflows/{workflow_id}/execute</span></p></li></ul><p class="ds-markdown-paragraph"><span>下面开始实现。</span></p></div></div><div class="_8f7678d"></div></div><div class="ds-markdown pointer-events-none" style="--ds-md-zoom:1.143;"><h1><span>Coze工作流全自动化增量批量处理系统</span></h1><h2><span>一、系统架构总览</span></h2><h3><span>1.1 系统架构图</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><div class="ds-segmented _81e8954" role="tablist" style="--ds-segmented-color:var(--dsw-alias-markdown-code-segment-unselected); --ds-segmented-selected-color:var(--dsw-alias-markdown-code-segment-selected); --ds-segmented-button-box-shadow:0 0 4px 0 rgba(0,0,0,0.02), 0 6px 10px 0 rgba(0,0,0,0.04);"><div role="tab" aria-selected="true" class="ds-segmented-button ds-segmented-button--selected">图表<div class="ds-segmented-separator" aria-hidden="true"></div><div class="ds-segmented-button__shadow" aria-hidden="true"></div></div><div role="tab" aria-selected="false" tabindex="0" class="ds-segmented-button">代码<div class="ds-segmented-button__shadow" aria-hidden="true"></div></div></div></div><div class="d2a24f03 _246a029"><div class="efa13877"><div class="e4ec2a75 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" role="button" aria-disabled="false" tabindex="0"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.167 7.66602H3.86621V6.36523H10.167V7.66602Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M7.0166 0.365234C10.6891 0.365465 13.667 3.34307 13.667 7.01562C13.6669 10.6881 10.689 13.6658 7.0166 13.666C3.34398 13.666 0.366326 10.6882 0.366211 7.01562C0.366211 3.34293 3.34391 0.365235 7.0166 0.365234ZM7.0166 1.66602C4.06188 1.66602 1.66699 4.0609 1.66699 7.01562C1.66711 9.97025 4.06195 12.3652 7.0166 12.3652C9.97106 12.365 12.3661 9.97011 12.3662 7.01562C12.3662 4.06104 9.97113 1.66625 7.0166 1.66602Z" fill="currentColor"></path><path d="M12.7424 11.8829L15.2172 14.3578L14.2974 15.2775L11.8226 12.8027L12.7424 11.8829Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="e4ec2a75 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" role="button" aria-disabled="false" tabindex="0"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.65039 6.34961H10.1504V7.65039H7.65039V10.1504H6.34961V7.65039H3.84961V6.34961H6.34961V3.84961H7.65039V6.34961Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M7 0.349609C10.6727 0.349609 13.6504 3.32731 13.6504 7C13.6504 10.6727 10.6727 13.6504 7 13.6504C3.32731 13.6504 0.349609 10.6727 0.349609 7C0.34961 3.32731 3.32731 0.34961 7 0.349609ZM7 1.65039C4.04528 1.65039 1.65039 4.04528 1.65039 7C1.65039 9.95472 4.04528 12.3496 7 12.3496C9.95472 12.3496 12.3496 9.95472 12.3496 7C12.3496 4.04528 9.95472 1.65039 7 1.65039Z" fill="currentColor"></path><path d="M12.7688 11.8438L15.2437 14.3187L14.3239 15.2385L11.849 12.7636L12.7688 11.8438Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="ae809fef"></div><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.58875 12.3407L6.59167 8.33777L7.66296 9.40808L3.66003 13.411H7.99988V14.8065H3.05457C2.02633 14.8065 1.19324 13.9734 1.19324 12.9452V7.99988H2.58875V12.3407Z" fill="currentColor"></path><path d="M12.9452 1.19324C13.9734 1.19324 14.8065 2.02633 14.8065 3.05457V7.99988H13.411V3.66003L9.40808 7.66296L8.33777 6.59167L12.3407 2.58875H7.99988V1.19324H12.9452Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">全屏</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><style>.kvfysmfp{overflow:hidden;touch-action:none}.ufhsfnkm{transform-origin: 0 0}</style><div class="kvfysmfp _6213ab4"><svg id="mermaid-svg-1" width="100%" xmlns="http://www.w3.org/2000/svg" class="flowchart mermaid-svg" viewBox="-34 -34 748 1674" role="graphics-document document" height="100%" style="max-width: 100%; transform-origin: 0px 0px; user-select: none; transform: translate(298.877px, 0px) scale(0.205115);"><style>#mermaid-svg-1{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-svg-1 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-svg-1 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-svg-1 .error-icon{fill:#552222;}#mermaid-svg-1 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-1 .edge-thickness-normal{stroke-width:1px;}#mermaid-svg-1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-1 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-svg-1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-1 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-1 .marker.cross{stroke:#333333;}#mermaid-svg-1 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-1 p{margin:0;}#mermaid-svg-1 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-1 .cluster-label text{fill:#333;}#mermaid-svg-1 .cluster-label span{color:#333;}#mermaid-svg-1 .cluster-label span p{background-color:transparent;}#mermaid-svg-1 .label text,#mermaid-svg-1 span{fill:#333;color:#333;}#mermaid-svg-1 .node rect,#mermaid-svg-1 .node circle,#mermaid-svg-1 .node ellipse,#mermaid-svg-1 .node polygon,#mermaid-svg-1 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-1 .rough-node .label text,#mermaid-svg-1 .node .label text,#mermaid-svg-1 .image-shape .label,#mermaid-svg-1 .icon-shape .label{text-anchor:middle;}#mermaid-svg-1 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-svg-1 .rough-node .label,#mermaid-svg-1 .node .label,#mermaid-svg-1 .image-shape .label,#mermaid-svg-1 .icon-shape .label{text-align:center;}#mermaid-svg-1 .node.clickable{cursor:pointer;}#mermaid-svg-1 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-svg-1 .arrowheadPath{fill:#333333;}#mermaid-svg-1 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-1 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-1 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-svg-1 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-svg-1 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-svg-1 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-svg-1 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-1 .cluster text{fill:#333;}#mermaid-svg-1 .cluster span{color:#333;}#mermaid-svg-1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-1 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg-1 rect.text{fill:none;stroke-width:0;}#mermaid-svg-1 .icon-shape,#mermaid-svg-1 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-svg-1 .icon-shape p,#mermaid-svg-1 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-svg-1 .icon-shape rect,#mermaid-svg-1 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-svg-1 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-svg-1 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-svg-1 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaid-svg-1_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-svg-1_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-svg-1_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-svg-1_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-svg-1_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-svg-1_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M348,62L348,66.167C348,70.333,348,78.667,348,86.333C348,94,348,101,348,104.5L348,108" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,166L348,170.167C348,174.333,348,182.667,348.07,190.417C348.141,198.167,348.281,205.334,348.351,208.917L348.422,212.501" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M299.737,301.737L266.781,313.947C233.824,326.158,167.912,350.579,134.956,366.289C102,382,102,389,102,392.5L102,396" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348.5,350.5L348.417,354.583C348.333,358.667,348.167,366.833,348.083,374.417C348,382,348,389,348,392.5L348,396" id="L_C_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M396.821,302.179L428.351,314.316C459.881,326.453,522.94,350.726,554.47,366.363C586,382,586,389,586,392.5L586,396" id="L_C_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M102,454L102,458.167C102,462.333,102,470.667,128.014,480.332C154.029,489.998,206.058,500.996,232.072,506.495L258.086,511.994" id="L_D_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,454L348,458.167C348,462.333,348,470.667,348,478.333C348,486,348,493,348,496.5L348,500" id="L_E_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M586,454L586,458.167C586,462.333,586,470.667,561.318,480.226C536.636,489.785,487.272,500.571,462.59,505.964L437.908,511.356" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,558L348,562.167C348,566.333,348,574.667,348,582.333C348,590,348,597,348,600.5L348,604" id="L_G_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,662L348,666.167C348,670.333,348,678.667,348,686.333C348,694,348,701,348,704.5L348,708" id="L_H_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,766L348,770.167C348,774.333,348,782.667,348,790.333C348,798,348,805,348,808.5L348,812" id="L_I_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,870L348,874.167C348,878.333,348,886.667,348,894.333C348,902,348,909,348,912.5L348,916" id="L_J_K_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,974L348,978.167C348,982.333,348,990.667,348,998.333C348,1006,348,1013,348,1016.5L348,1020" id="L_K_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,1078L348,1082.167C348,1086.333,348,1094.667,348,1102.333C348,1110,348,1117,348,1120.5L348,1124" id="L_L_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,1182L348,1186.167C348,1190.333,348,1198.667,348,1206.333C348,1214,348,1221,348,1224.5L348,1228" id="L_M_N_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M348,1286L348,1290.167C348,1294.333,348,1302.667,348,1310.333C348,1318,348,1325,348,1328.5L348,1332" id="L_N_O_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M296.596,1390L288.663,1394.167C280.731,1398.333,264.865,1406.667,256.933,1414.333C249,1422,249,1429,249,1432.5L249,1436" id="L_O_P_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M399.404,1390L407.337,1394.167C415.269,1398.333,431.135,1406.667,439.067,1414.333C447,1422,447,1429,447,1432.5L447,1436" id="L_O_Q_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M249,1494L249,1498.167C249,1502.333,249,1510.667,256.342,1518.69C263.685,1526.713,278.37,1534.427,285.712,1538.283L293.055,1542.14" id="L_P_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path><path d="M447,1494L447,1498.167C447,1502.333,447,1510.667,439.658,1518.69C432.315,1526.713,417.63,1534.427,410.288,1538.283L402.945,1542.14" id="L_Q_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-1_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(348, 35)"><rect class="basic label-container" style="fill:#e1f5fe !important" x="-54" y="-27" width="108" height="54"></rect><g class="label" style="" transform="translate(-24, -12)"><rect></rect><foreignobject width="48" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>数据源</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-B-1" transform="translate(348, 139)"><rect class="basic label-container" style="" x="-78" y="-27" width="156" height="54"></rect><g class="label" style="" transform="translate(-48, -12)"><rect></rect><foreignobject width="96" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>增量检测模块</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-C-3" transform="translate(348, 283)"><polygon points="67,0 134,-67 67,-134 0,-67" class="label-container" transform="translate(-66.5, 67)"></polygon><g class="label" style="" transform="translate(-40, -12)"><rect></rect><foreignobject width="80" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>数据分类器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-D-5" transform="translate(102, 427)"><rect class="basic label-container" style="" x="-94" y="-27" width="188" height="54"></rect><g class="label" style="" transform="translate(-64, -12)"><rect></rect><foreignobject width="128" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>结构化数据处理器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-E-7" transform="translate(348, 427)"><rect class="basic label-container" style="" x="-102" y="-27" width="204" height="54"></rect><g class="label" style="" transform="translate(-72, -12)"><rect></rect><foreignobject width="144" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>非结构化数据处理器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-F-9" transform="translate(586, 427)"><rect class="basic label-container" style="" x="-86" y="-27" width="172" height="54"></rect><g class="label" style="" transform="translate(-56, -12)"><rect></rect><foreignobject width="112" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>流式数据处理器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-G-11" transform="translate(348, 531)"><rect class="basic label-container" style="" x="-86" y="-27" width="172" height="54"></rect><g class="label" style="" transform="translate(-56, -12)"><rect></rect><foreignobject width="112" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>工作流模板引擎</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-H-17" transform="translate(348, 635)"><rect class="basic label-container" style="" x="-86" y="-27" width="172" height="54"></rect><g class="label" style="" transform="translate(-56, -12)"><rect></rect><foreignobject width="112" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>节点配置生成器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-I-19" transform="translate(348, 739)"><rect class="basic label-container" style="" x="-78" y="-27" width="156" height="54"></rect><g class="label" style="" transform="translate(-48, -12)"><rect></rect><foreignobject width="96" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>工作流验证器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-J-21" transform="translate(348, 843)"><rect class="basic label-container" style="" x="-70" y="-27" width="140" height="54"></rect><g class="label" style="" transform="translate(-40, -12)"><rect></rect><foreignobject width="80" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>参数优化器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-K-23" transform="translate(348, 947)"><rect class="basic label-container" style="fill:#f3e5f5 !important" x="-76.61458587646484" y="-27" width="153.2291717529297" height="54"></rect><g class="label" style="" transform="translate(-46.614585876464844, -12)"><rect></rect><foreignobject width="93.22917175292969" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Coze API网关</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-L-25" transform="translate(348, 1051)"><rect class="basic label-container" style="fill:#e8f5e8 !important" x="-86" y="-27" width="172" height="54"></rect><g class="label" style="" transform="translate(-56, -12)"><rect></rect><foreignobject width="112" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>批量执行调度器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-M-27" transform="translate(348, 1155)"><rect class="basic label-container" style="" x="-70" y="-27" width="140" height="54"></rect><g class="label" style="" transform="translate(-40, -12)"><rect></rect><foreignobject width="80" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>并发执行器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-N-29" transform="translate(348, 1259)"><rect class="basic label-container" style="" x="-70" y="-27" width="140" height="54"></rect><g class="label" style="" transform="translate(-40, -12)"><rect></rect><foreignobject width="80" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>结果聚合器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-O-31" transform="translate(348, 1363)"><rect class="basic label-container" style="" x="-70" y="-27" width="140" height="54"></rect><g class="label" style="" transform="translate(-40, -12)"><rect></rect><foreignobject width="80" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>状态同步器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-P-33" transform="translate(249, 1467)"><rect class="basic label-container" style="" x="-78" y="-27" width="156" height="54"></rect><g class="label" style="" transform="translate(-48, -12)"><rect></rect><foreignobject width="96" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>监控告警系统</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-Q-35" transform="translate(447, 1467)"><rect class="basic label-container" style="" x="-70" y="-27" width="140" height="54"></rect><g class="label" style="" transform="translate(-40, -12)"><rect></rect><foreignobject width="80" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>日志分析器</p></span></div></foreignobject></g></g><g class="node default" id="flowchart-R-37" transform="translate(348, 1571)"><rect class="basic label-container" style="fill:#fff3e0 !important" x="-78" y="-27" width="156" height="54"></rect><g class="label" style="" transform="translate(-48, -12)"><rect></rect><foreignobject width="96" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>可视化仪表板</p></span></div></foreignobject></g></g></g></g></g></svg></div><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>1.2 核心组件清单</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">text</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre>├── 数据采集层
│   ├── 增量检测器
│   ├── 数据分类器
│   ├── 质量验证器
│   └── 去重过滤器
├── 工作流生成层
│   ├── 模板引擎
│   ├── 节点工厂
│   ├── 参数优化器
│   ├── 冲突检测器
│   └── 验证器
├── 执行管理层
│   ├── 调度器
│   ├── 并发控制器
│   ├── 重试管理器
│   ├── 熔断器
│   └── 限流器
├── 状态管理层
│   ├── 检查点管理器
│   ├── 版本控制器
│   ├── 冲突解决器
│   └── 同步器
└── 监控分析层
    ├── 性能监控
    ├── 错误追踪
    ├── 日志聚合
    └── 告警系统</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>二、完整配置文件系统</span></h2><h3><span>2.1 主配置文件</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">yaml</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># config/master.yaml</span>
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"2.0"</span>
<span class="token key atrule">system</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"coze-workflow-automation-system"</span>
  <span class="token key atrule">environment</span><span class="token punctuation">:</span> <span class="token string">"${ENVIRONMENT:production}"</span>
  <span class="token key atrule">log_level</span><span class="token punctuation">:</span> <span class="token string">"${LOG_LEVEL:INFO}"</span>
  
<span class="token key atrule">coze_platform</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">base_url</span><span class="token punctuation">:</span> <span class="token string">"https://api.coze.com"</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"v1"</span>
    <span class="token key atrule">authentication</span><span class="token punctuation">:</span>
      <span class="token key atrule">api_key</span><span class="token punctuation">:</span> <span class="token string">"${COZE_API_KEY}"</span>
      <span class="token key atrule">workspace_id</span><span class="token punctuation">:</span> <span class="token string">"${COZE_WORKSPACE_ID}"</span>
      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">30</span>
      <span class="token key atrule">retry</span><span class="token punctuation">:</span>
        <span class="token key atrule">max_attempts</span><span class="token punctuation">:</span> <span class="token number">3</span>
        <span class="token key atrule">backoff_factor</span><span class="token punctuation">:</span> <span class="token number">2</span>
        <span class="token key atrule">status_forcelist</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">502</span><span class="token punctuation">,</span> <span class="token number">503</span><span class="token punctuation">,</span> <span class="token number">504</span><span class="token punctuation">]</span>
    
  <span class="token key atrule">workflow</span><span class="token punctuation">:</span>
    <span class="token key atrule">default_config</span><span class="token punctuation">:</span>
      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">300</span>
      <span class="token key atrule">memory_limit</span><span class="token punctuation">:</span> <span class="token string">"2G"</span>
      <span class="token key atrule">concurrency_limit</span><span class="token punctuation">:</span> <span class="token number">10</span>
    <span class="token key atrule">validation</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">strict_mode</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">schema_path</span><span class="token punctuation">:</span> <span class="token string">"./schemas/workflow_schema.json"</span>

<span class="token key atrule">incremental_processing</span><span class="token punctuation">:</span>
  <span class="token key atrule">detection_strategies</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"timestamp_based"</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">fields</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"updated_at"</span><span class="token punctuation">,</span> <span class="token string">"created_at"</span><span class="token punctuation">,</span> <span class="token string">"modified_at"</span><span class="token punctuation">]</span>
      <span class="token key atrule">window_size</span><span class="token punctuation">:</span> <span class="token string">"24h"</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"id_range_based"</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">id_field</span><span class="token punctuation">:</span> <span class="token string">"id"</span>
      <span class="token key atrule">batch_size</span><span class="token punctuation">:</span> <span class="token number">1000</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"checksum_based"</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">checksum_fields</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"content_hash"</span><span class="token punctuation">,</span> <span class="token string">"file_hash"</span><span class="token punctuation">]</span>
      <span class="token key atrule">algorithm</span><span class="token punctuation">:</span> <span class="token string">"sha256"</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"event_based"</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">event_source</span><span class="token punctuation">:</span> <span class="token string">"kafka"</span>
      <span class="token key atrule">topics</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"data_updates"</span><span class="token punctuation">]</span>
      
  <span class="token key atrule">deduplication</span><span class="token punctuation">:</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span> <span class="token string">"distributed_lock"</span>
    <span class="token key atrule">ttl</span><span class="token punctuation">:</span> <span class="token string">"1h"</span>
    <span class="token key atrule">storage</span><span class="token punctuation">:</span> <span class="token string">"redis"</span>
    
  <span class="token key atrule">checkpointing</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">storage</span><span class="token punctuation">:</span> <span class="token string">"postgresql"</span>
    <span class="token key atrule">interval</span><span class="token punctuation">:</span> <span class="token string">"1000 records"</span>
    <span class="token key atrule">recovery</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">max_retry</span><span class="token punctuation">:</span> <span class="token number">3</span>

<span class="token key atrule">batch_processing</span><span class="token punctuation">:</span>
  <span class="token key atrule">execution_strategies</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"sequential"</span>
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"顺序执行，保证数据顺序"</span>
      <span class="token key atrule">max_concurrent</span><span class="token punctuation">:</span> <span class="token number">1</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"parallel"</span>
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"完全并行执行"</span>
      <span class="token key atrule">max_concurrent</span><span class="token punctuation">:</span> <span class="token number">50</span>
      <span class="token key atrule">partition_key</span><span class="token punctuation">:</span> <span class="token string">"id"</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"smart_batching"</span>
      <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"智能分批，基于资源使用"</span>
      <span class="token key atrule">dynamic_batch_size</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">max_memory_usage</span><span class="token punctuation">:</span> <span class="token string">"80%"</span>
      <span class="token key atrule">max_cpu_usage</span><span class="token punctuation">:</span> <span class="token string">"70%"</span>
      
  <span class="token key atrule">scheduling</span><span class="token punctuation">:</span>
    <span class="token key atrule">cron_expressions</span><span class="token punctuation">:</span>
      <span class="token key atrule">hourly</span><span class="token punctuation">:</span> <span class="token string">"0 * * * *"</span>
      <span class="token key atrule">daily</span><span class="token punctuation">:</span> <span class="token string">"0 0 * * *"</span>
      <span class="token key atrule">realtime</span><span class="token punctuation">:</span> <span class="token string">"*/5 * * * * *"</span>
      
  <span class="token key atrule">failure_handling</span><span class="token punctuation">:</span>
    <span class="token key atrule">retry_policy</span><span class="token punctuation">:</span>
      <span class="token key atrule">exponential_backoff</span><span class="token punctuation">:</span>
        <span class="token key atrule">initial_delay</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token key atrule">multiplier</span><span class="token punctuation">:</span> <span class="token number">2</span>
        <span class="token key atrule">max_delay</span><span class="token punctuation">:</span> <span class="token number">60</span>
      <span class="token key atrule">max_retries</span><span class="token punctuation">:</span> <span class="token number">3</span>
      <span class="token key atrule">retryable_errors</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"timeout"</span><span class="token punctuation">,</span> <span class="token string">"rate_limit"</span><span class="token punctuation">,</span> <span class="token string">"network_error"</span><span class="token punctuation">]</span>
      
    <span class="token key atrule">circuit_breaker</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">failure_threshold</span><span class="token punctuation">:</span> <span class="token number">5</span>
      <span class="token key atrule">reset_timeout</span><span class="token punctuation">:</span> <span class="token number">60</span>
      <span class="token key atrule">half_open_max_attempts</span><span class="token punctuation">:</span> <span class="token number">2</span>
      
    <span class="token key atrule">dead_letter_queue</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">storage</span><span class="token punctuation">:</span> <span class="token string">"s3"</span>
      <span class="token key atrule">retention_days</span><span class="token punctuation">:</span> <span class="token number">30</span>

<span class="token key atrule">workflow_generation</span><span class="token punctuation">:</span>
  <span class="token key atrule">template_repository</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">"./templates"</span>
    <span class="token key atrule">auto_update</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">version_control</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    
  <span class="token key atrule">node_types</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"data_input"</span>
      <span class="token key atrule">categories</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"database"</span><span class="token punctuation">,</span> <span class="token string">"api"</span><span class="token punctuation">,</span> <span class="token string">"file"</span><span class="token punctuation">,</span> <span class="token string">"stream"</span><span class="token punctuation">]</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"data_processing"</span>
      <span class="token key atrule">categories</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"transform"</span><span class="token punctuation">,</span> <span class="token string">"enrich"</span><span class="token punctuation">,</span> <span class="token string">"filter"</span><span class="token punctuation">,</span> <span class="token string">"aggregate"</span><span class="token punctuation">]</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"ai_processing"</span>
      <span class="token key atrule">categories</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"llm"</span><span class="token punctuation">,</span> <span class="token string">"embedding"</span><span class="token punctuation">,</span> <span class="token string">"classification"</span><span class="token punctuation">,</span> <span class="token string">"summarization"</span><span class="token punctuation">]</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"output"</span>
      <span class="token key atrule">categories</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"database"</span><span class="token punctuation">,</span> <span class="token string">"api"</span><span class="token punctuation">,</span> <span class="token string">"file"</span><span class="token punctuation">,</span> <span class="token string">"notification"</span><span class="token punctuation">]</span>
      
  <span class="token key atrule">optimization</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">strategies</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"node_merging"</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"parallelization"</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"caching"</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">ttl</span><span class="token punctuation">:</span> <span class="token string">"1h"</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"resource_allocation"</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">memory_optimization</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">cpu_optimization</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

<span class="token key atrule">monitoring_and_alerting</span><span class="token punctuation">:</span>
  <span class="token key atrule">metrics</span><span class="token punctuation">:</span>
    <span class="token key atrule">collection_interval</span><span class="token punctuation">:</span> <span class="token string">"30s"</span>
    <span class="token key atrule">retention_period</span><span class="token punctuation">:</span> <span class="token string">"30d"</span>
    
  <span class="token key atrule">dashboards</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">refresh_interval</span><span class="token punctuation">:</span> <span class="token string">"10s"</span>
    
  <span class="token key atrule">alerting</span><span class="token punctuation">:</span>
    <span class="token key atrule">channels</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"slack"</span>
        <span class="token key atrule">webhook_url</span><span class="token punctuation">:</span> <span class="token string">"${SLACK_WEBHOOK}"</span>
        <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"critical"</span><span class="token punctuation">,</span> <span class="token string">"error"</span><span class="token punctuation">]</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"email"</span>
        <span class="token key atrule">recipients</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"team@example.com"</span><span class="token punctuation">]</span>
        <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"warning"</span><span class="token punctuation">,</span> <span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token string">"critical"</span><span class="token punctuation">]</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"webhook"</span>
        <span class="token key atrule">endpoints</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"https://alert.example.com/webhook"</span><span class="token punctuation">]</span>
        
    <span class="token key atrule">rules</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"high_error_rate"</span>
        <span class="token key atrule">condition</span><span class="token punctuation">:</span> <span class="token string">"error_rate &gt; 5%"</span>
        <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">"critical"</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"slow_processing"</span>
        <span class="token key atrule">condition</span><span class="token punctuation">:</span> <span class="token string">"p95_latency &gt; 30s"</span>
        <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">"warning"</span>
        
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"resource_exhaustion"</span>
        <span class="token key atrule">condition</span><span class="token punctuation">:</span> <span class="token string">"memory_usage &gt; 90%"</span>
        <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">"error"</span>

<span class="token key atrule">data_sources</span><span class="token punctuation">:</span>
  <span class="token key atrule">configurations</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"postgresql_source"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"database"</span>
      <span class="token key atrule">connection</span><span class="token punctuation">:</span>
        <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">"${DB_HOST}"</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5432</span>
        <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token string">"${DB_NAME}"</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"${DB_USER}"</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"${DB_PASSWORD}"</span>
      <span class="token key atrule">incremental_strategy</span><span class="token punctuation">:</span> <span class="token string">"timestamp_based"</span>
      <span class="token key atrule">query_templates</span><span class="token punctuation">:</span>
        <span class="token key atrule">incremental</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token scalar string">
          SELECT * FROM ${table_name} 
          WHERE ${incremental_field} &gt; :last_checkpoint
          ORDER BY ${incremental_field} ASC
          LIMIT :batch_size</span>
        
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"api_source"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"api"</span>
      <span class="token key atrule">endpoint</span><span class="token punctuation">:</span> <span class="token string">"${API_ENDPOINT}"</span>
      <span class="token key atrule">authentication</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"bearer"</span>
        <span class="token key atrule">token</span><span class="token punctuation">:</span> <span class="token string">"${API_TOKEN}"</span>
      <span class="token key atrule">pagination</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"cursor"</span>
        <span class="token key atrule">cursor_field</span><span class="token punctuation">:</span> <span class="token string">"next_cursor"</span>
      <span class="token key atrule">rate_limit</span><span class="token punctuation">:</span>
        <span class="token key atrule">requests_per_second</span><span class="token punctuation">:</span> <span class="token number">10</span>
        
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"s3_source"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"file"</span>
      <span class="token key atrule">storage</span><span class="token punctuation">:</span> <span class="token string">"s3"</span>
      <span class="token key atrule">bucket</span><span class="token punctuation">:</span> <span class="token string">"${S3_BUCKET}"</span>
      <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token string">"incremental/"</span>
      <span class="token key atrule">file_pattern</span><span class="token punctuation">:</span> <span class="token string">"*.jsonl"</span>
      <span class="token key atrule">format</span><span class="token punctuation">:</span> <span class="token string">"jsonl"</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"kafka_source"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"stream"</span>
      <span class="token key atrule">brokers</span><span class="token punctuation">:</span> <span class="token string">"${KAFKA_BROKERS}"</span>
      <span class="token key atrule">topics</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"data_updates"</span><span class="token punctuation">]</span>
      <span class="token key atrule">consumer_group</span><span class="token punctuation">:</span> <span class="token string">"coze_automation"</span>
      <span class="token key atrule">auto_offset_reset</span><span class="token punctuation">:</span> <span class="token string">"latest"</span>

<span class="token key atrule">output_destinations</span><span class="token punctuation">:</span>
  <span class="token key atrule">configurations</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"postgresql_destination"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"database"</span>
      <span class="token comment"># ... 类似数据源的配置</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"webhook_destination"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"api"</span>
      <span class="token comment"># ... 配置</span>
      
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"s3_destination"</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"file"</span>
      <span class="token comment"># ... 配置</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>三、增量数据分类处理器</span></h2><h3><span>3.1 增量检测引擎</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># incremental_detector.py</span>
<span class="token keyword">from</span> abc <span class="token keyword">import</span> ABC<span class="token punctuation">,</span> abstractmethod
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Any<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Union
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> json
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass
<span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum
<span class="token keyword">import</span> asyncio
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor

<span class="token keyword">class</span> <span class="token class-name">IncrementalStrategy</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    TIMESTAMP <span class="token operator">=</span> <span class="token string">"timestamp"</span>
    ID_RANGE <span class="token operator">=</span> <span class="token string">"id_range"</span>
    CHECKSUM <span class="token operator">=</span> <span class="token string">"checksum"</span>
    EVENT <span class="token operator">=</span> <span class="token string">"event"</span>
    HYBRID <span class="token operator">=</span> <span class="token string">"hybrid"</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">IncrementalState</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""增量处理状态"""</span>
    source_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    strategy<span class="token punctuation">:</span> IncrementalStrategy
    last_checkpoint<span class="token punctuation">:</span> Any
    processed_hashes<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span>
    last_processed_at<span class="token punctuation">:</span> datetime
    metadata<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">DataClassifier</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""数据分类器"""</span>
    STRUCTURED <span class="token operator">=</span> <span class="token string">"structured"</span>      <span class="token comment"># 结构化数据：数据库表、CSV等</span>
    SEMI_STRUCTURED <span class="token operator">=</span> <span class="token string">"semi_structured"</span>  <span class="token comment"># 半结构化：JSON、XML</span>
    UNSTRUCTURED <span class="token operator">=</span> <span class="token string">"unstructured"</span>  <span class="token comment"># 非结构化：文本、图像</span>
    STREAMING <span class="token operator">=</span> <span class="token string">"streaming"</span>        <span class="token comment"># 流式数据</span>
    BATCH <span class="token operator">=</span> <span class="token string">"batch"</span>               <span class="token comment"># 批量数据</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">DataBatch</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""数据批次"""</span>
    batch_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    source_type<span class="token punctuation">:</span> DataClassifier
    data<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span>
    metadata<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span>
    incremental_state<span class="token punctuation">:</span> IncrementalState
    priority<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">class</span> <span class="token class-name">BaseIncrementalDetector</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""增量检测器基类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>config <span class="token operator">=</span> config
        self<span class="token punctuation">.</span>state_manager <span class="token operator">=</span> IncrementalStateManager<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检测增量数据"""</span>
        <span class="token keyword">pass</span>
    
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">classify_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> DataClassifier<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""数据分类"""</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">TimestampBasedDetector</span><span class="token punctuation">(</span>BaseIncrementalDetector<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""基于时间戳的增量检测器"""</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""基于时间戳检测增量数据"""</span>
        source_id <span class="token operator">=</span> source_config<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
        state <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>state_manager<span class="token punctuation">.</span>get_state<span class="token punctuation">(</span>source_id<span class="token punctuation">)</span>
        
        last_timestamp <span class="token operator">=</span> state<span class="token punctuation">.</span>last_checkpoint <span class="token keyword">or</span> datetime<span class="token punctuation">.</span><span class="token builtin">min</span>
        window_size <span class="token operator">=</span> timedelta<span class="token punctuation">(</span>hours<span class="token operator">=</span>self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'window_size_hours'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 查询增量数据</span>
        query <span class="token operator">=</span> self<span class="token punctuation">.</span>build_incremental_query<span class="token punctuation">(</span>source_config<span class="token punctuation">,</span> last_timestamp<span class="token punctuation">,</span> window_size<span class="token punctuation">)</span>
        new_data <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>execute_query<span class="token punctuation">(</span>source_config<span class="token punctuation">,</span> query<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> new_data<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 数据分类</span>
        data_class <span class="token operator">=</span> self<span class="token punctuation">.</span>classify_data<span class="token punctuation">(</span>new_data<span class="token punctuation">)</span>
        
        <span class="token comment"># 创建批次</span>
        batch_size <span class="token operator">=</span> source_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'batch_size'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
        batches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>new_data<span class="token punctuation">)</span><span class="token punctuation">,</span> batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
            batch_data <span class="token operator">=</span> new_data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> batch_size<span class="token punctuation">]</span>
            
            <span class="token comment"># 生成批次ID</span>
            batch_id <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>source_id<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d_%H%M%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span>
            
            batch <span class="token operator">=</span> DataBatch<span class="token punctuation">(</span>
                batch_id<span class="token operator">=</span>batch_id<span class="token punctuation">,</span>
                source_type<span class="token operator">=</span>data_class<span class="token punctuation">,</span>
                data<span class="token operator">=</span>batch_data<span class="token punctuation">,</span>
                metadata<span class="token operator">=</span><span class="token punctuation">{</span>
                    <span class="token string">'source'</span><span class="token punctuation">:</span> source_id<span class="token punctuation">,</span>
                    <span class="token string">'strategy'</span><span class="token punctuation">:</span> <span class="token string">'timestamp'</span><span class="token punctuation">,</span>
                    <span class="token string">'record_count'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>batch_data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">'time_range'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">'start'</span><span class="token punctuation">:</span> batch_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'updated_at'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">'end'</span><span class="token punctuation">:</span> batch_data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'updated_at'</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                incremental_state<span class="token operator">=</span>state<span class="token punctuation">,</span>
                priority<span class="token operator">=</span>self<span class="token punctuation">.</span>calculate_priority<span class="token punctuation">(</span>batch_data<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            batches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>batch<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> batches
    
    <span class="token keyword">def</span> <span class="token function">build_incremental_query</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Dict<span class="token punctuation">,</span> last_timestamp<span class="token punctuation">:</span> datetime<span class="token punctuation">,</span> 
                                window_size<span class="token punctuation">:</span> timedelta<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构建增量查询"""</span>
        table <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">)</span>
        timestamp_field <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'timestamp_field'</span><span class="token punctuation">,</span> <span class="token string">'updated_at'</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 使用窗口函数防止数据遗漏</span>
        query <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"""
        WITH ranked_data AS (
            SELECT *,
                   ROW_NUMBER() OVER (ORDER BY </span><span class="token interpolation"><span class="token punctuation">{</span>timestamp_field<span class="token punctuation">}</span></span><span class="token string">) as rn
            FROM </span><span class="token interpolation"><span class="token punctuation">{</span>table<span class="token punctuation">}</span></span><span class="token string">
            WHERE </span><span class="token interpolation"><span class="token punctuation">{</span>timestamp_field<span class="token punctuation">}</span></span><span class="token string"> &gt; %(last_timestamp)s
              AND </span><span class="token interpolation"><span class="token punctuation">{</span>timestamp_field<span class="token punctuation">}</span></span><span class="token string"> &lt;= %(window_end)s
        )
        SELECT * FROM ranked_data
        ORDER BY </span><span class="token interpolation"><span class="token punctuation">{</span>timestamp_field<span class="token punctuation">}</span></span><span class="token string">
        """</span></span>
        
        <span class="token keyword">return</span> query
    
    <span class="token keyword">def</span> <span class="token function">classify_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> DataClassifier<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""分类结构化数据"""</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> data<span class="token punctuation">:</span>
            <span class="token keyword">return</span> DataClassifier<span class="token punctuation">.</span>STRUCTURED
        
        <span class="token comment"># 检查数据结构</span>
        sample <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 判断是否为结构化数据</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>sample<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">all</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> sample<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 检查是否有明确的schema</span>
            <span class="token keyword">if</span> <span class="token builtin">all</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> sample <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'created_at'</span><span class="token punctuation">,</span> <span class="token string">'updated_at'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> DataClassifier<span class="token punctuation">.</span>STRUCTURED
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> DataClassifier<span class="token punctuation">.</span>SEMI_STRUCTURED
        <span class="token keyword">return</span> DataClassifier<span class="token punctuation">.</span>UNSTRUCTURED

<span class="token keyword">class</span> <span class="token class-name">ChecksumBasedDetector</span><span class="token punctuation">(</span>BaseIncrementalDetector<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""基于校验和的增量检测器"""</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""基于校验和检测增量数据"""</span>
        source_id <span class="token operator">=</span> source_config<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
        state <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>state_manager<span class="token punctuation">.</span>get_state<span class="token punctuation">(</span>source_id<span class="token punctuation">)</span>
        
        <span class="token comment"># 获取已有数据的校验和</span>
        processed_hashes <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>processed_hashes <span class="token keyword">or</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 获取所有数据</span>
        all_data <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>fetch_all_data<span class="token punctuation">(</span>source_config<span class="token punctuation">)</span>
        
        <span class="token comment"># 计算校验和并过滤</span>
        new_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> all_data<span class="token punctuation">:</span>
            item_hash <span class="token operator">=</span> self<span class="token punctuation">.</span>calculate_checksum<span class="token punctuation">(</span>item<span class="token punctuation">,</span> source_config<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> item_hash <span class="token keyword">not</span> <span class="token keyword">in</span> processed_hashes<span class="token punctuation">:</span>
                new_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
                processed_hashes<span class="token punctuation">.</span>add<span class="token punctuation">(</span>item_hash<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> new_data<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 分类和分批</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>create_batches<span class="token punctuation">(</span>source_id<span class="token punctuation">,</span> new_data<span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token string">'checksum'</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">EventBasedDetector</span><span class="token punctuation">(</span>BaseIncrementalDetector<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""基于事件的增量检测器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""基于事件检测增量数据"""</span>
        <span class="token comment"># 从事件队列获取数据</span>
        events <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>consume_events<span class="token punctuation">(</span>source_config<span class="token punctuation">)</span>
        
        batches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        current_batch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> event <span class="token keyword">in</span> events<span class="token punctuation">:</span>
            current_batch<span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 达到批量大小或超时</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>current_batch<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> source_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'batch_size'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">or</span>
                self<span class="token punctuation">.</span>should_flush_batch<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                
                batch <span class="token operator">=</span> DataBatch<span class="token punctuation">(</span>
                    batch_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"event_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d_%H%M%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                    source_type<span class="token operator">=</span>DataClassifier<span class="token punctuation">.</span>STREAMING<span class="token punctuation">,</span>
                    data<span class="token operator">=</span>current_batch<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    metadata<span class="token operator">=</span><span class="token punctuation">{</span>
                        <span class="token string">'source'</span><span class="token punctuation">:</span> source_config<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token string">'strategy'</span><span class="token punctuation">:</span> <span class="token string">'event'</span><span class="token punctuation">,</span>
                        <span class="token string">'event_count'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>current_batch<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    incremental_state<span class="token operator">=</span>IncrementalState<span class="token punctuation">(</span>
                        source_id<span class="token operator">=</span>source_config<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        strategy<span class="token operator">=</span>IncrementalStrategy<span class="token punctuation">.</span>EVENT<span class="token punctuation">,</span>
                        last_checkpoint<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        processed_hashes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        last_processed_at<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        metadata<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
                    <span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                batches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>batch<span class="token punctuation">)</span>
                current_batch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">return</span> batches

<span class="token keyword">class</span> <span class="token class-name">HybridIncrementalDetector</span><span class="token punctuation">(</span>BaseIncrementalDetector<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""混合增量检测器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>detectors <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'timestamp'</span><span class="token punctuation">:</span> TimestampBasedDetector<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'checksum'</span><span class="token punctuation">:</span> ChecksumBasedDetector<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'event'</span><span class="token punctuation">:</span> EventBasedDetector<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_config<span class="token punctuation">:</span> Dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""使用多种策略检测增量数据"""</span>
        strategies <span class="token operator">=</span> source_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'strategies'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        all_batches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> strategy <span class="token keyword">in</span> strategies<span class="token punctuation">:</span>
            detector <span class="token operator">=</span> self<span class="token punctuation">.</span>detectors<span class="token punctuation">.</span>get<span class="token punctuation">(</span>strategy<span class="token punctuation">)</span>
            <span class="token keyword">if</span> detector<span class="token punctuation">:</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    batches <span class="token operator">=</span> <span class="token keyword">await</span> detector<span class="token punctuation">.</span>detect_incremental_data<span class="token punctuation">(</span>source_config<span class="token punctuation">)</span>
                    all_batches<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>batches<span class="token punctuation">)</span>
                <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Strategy </span><span class="token interpolation"><span class="token punctuation">{</span>strategy<span class="token punctuation">}</span></span><span class="token string"> failed: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>
        
        <span class="token comment"># 合并和去重批次</span>
        merged_batches <span class="token operator">=</span> self<span class="token punctuation">.</span>merge_and_deduplicate_batches<span class="token punctuation">(</span>all_batches<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> merged_batches
    
    <span class="token keyword">def</span> <span class="token function">merge_and_deduplicate_batches</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> batches<span class="token punctuation">:</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>DataBatch<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""合并和去重批次"""</span>
        <span class="token comment"># 按数据源和类型分组</span>
        batches_by_key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        
        <span class="token keyword">for</span> batch <span class="token keyword">in</span> batches<span class="token punctuation">:</span>
            key <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>batch<span class="token punctuation">.</span>source_type<span class="token punctuation">.</span>value<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>batch<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'source'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
            
            <span class="token keyword">if</span> key <span class="token keyword">not</span> <span class="token keyword">in</span> batches_by_key<span class="token punctuation">:</span>
                batches_by_key<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            batches_by_key<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>batch<span class="token punctuation">)</span>
        
        <span class="token comment"># 合并每个组的批次</span>
        merged_batches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> key<span class="token punctuation">,</span> group_batches <span class="token keyword">in</span> batches_by_key<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>group_batches<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                merged_batches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>group_batches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token comment"># 合并数据</span>
                all_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> batch <span class="token keyword">in</span> group_batches<span class="token punctuation">:</span>
                    all_data<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>batch<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
                
                <span class="token comment"># 去重</span>
                unique_data <span class="token operator">=</span> self<span class="token punctuation">.</span>deduplicate_data<span class="token punctuation">(</span>all_data<span class="token punctuation">)</span>
                
                <span class="token comment"># 创建新的合并批次</span>
                merged_batch <span class="token operator">=</span> DataBatch<span class="token punctuation">(</span>
                    batch_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"merged_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d_%H%M%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                    source_type<span class="token operator">=</span>group_batches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>source_type<span class="token punctuation">,</span>
                    data<span class="token operator">=</span>unique_data<span class="token punctuation">,</span>
                    metadata<span class="token operator">=</span><span class="token punctuation">{</span>
                        <span class="token string">'source'</span><span class="token punctuation">:</span> key<span class="token punctuation">,</span>
                        <span class="token string">'strategy'</span><span class="token punctuation">:</span> <span class="token string">'hybrid'</span><span class="token punctuation">,</span>
                        <span class="token string">'original_batches'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>group_batches<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">'merged_records'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>unique_data<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    incremental_state<span class="token operator">=</span>group_batches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>incremental_state<span class="token punctuation">,</span>
                    priority<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>priority <span class="token keyword">for</span> b <span class="token keyword">in</span> group_batches<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                merged_batches<span class="token punctuation">.</span>append<span class="token punctuation">(</span>merged_batch<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> merged_batches

<span class="token keyword">class</span> <span class="token class-name">IncrementalStateManager</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""增量状态管理器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>storage <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment"># 实际应使用数据库</span>
        
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_state</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> source_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> IncrementalState<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取状态"""</span>
        <span class="token keyword">if</span> source_id <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>storage<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>storage<span class="token punctuation">[</span>source_id<span class="token punctuation">]</span> <span class="token operator">=</span> IncrementalState<span class="token punctuation">(</span>
                source_id<span class="token operator">=</span>source_id<span class="token punctuation">,</span>
                strategy<span class="token operator">=</span>IncrementalStrategy<span class="token punctuation">.</span>TIMESTAMP<span class="token punctuation">,</span>
                last_checkpoint<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                processed_hashes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                last_processed_at<span class="token operator">=</span>datetime<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">,</span>
                metadata<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>storage<span class="token punctuation">[</span>source_id<span class="token punctuation">]</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_state</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">:</span> IncrementalState<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""更新状态"""</span>
        self<span class="token punctuation">.</span>storage<span class="token punctuation">[</span>state<span class="token punctuation">.</span>source_id<span class="token punctuation">]</span> <span class="token operator">=</span> state</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>四、工作流节点配置生成器</span></h2><h3><span>4.1 节点模板系统</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># workflow_generator.py</span>
<span class="token keyword">import</span> json
<span class="token keyword">import</span> yaml
<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Environment<span class="token punctuation">,</span> FileSystemLoader<span class="token punctuation">,</span> Template
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Any<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Set
<span class="token keyword">import</span> copy
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token punctuation">,</span> field
<span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> networkx <span class="token keyword">as</span> nx

<span class="token keyword">class</span> <span class="token class-name">NodeType</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""节点类型枚举"""</span>
    DATA_INPUT <span class="token operator">=</span> <span class="token string">"data_input"</span>
    DATA_TRANSFORM <span class="token operator">=</span> <span class="token string">"data_transform"</span>
    AI_PROCESSING <span class="token operator">=</span> <span class="token string">"ai_processing"</span>
    LOGIC_CONTROL <span class="token operator">=</span> <span class="token string">"logic_control"</span>
    DATA_OUTPUT <span class="token operator">=</span> <span class="token string">"data_output"</span>
    CUSTOM_FUNCTION <span class="token operator">=</span> <span class="token string">"custom_function"</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">NodeTemplate</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""节点模板"""</span>
    <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span>
    <span class="token builtin">type</span><span class="token punctuation">:</span> NodeType
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    description<span class="token punctuation">:</span> <span class="token builtin">str</span>
    category<span class="token punctuation">:</span> <span class="token builtin">str</span>
    version<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"1.0"</span>
    parameters<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
    inputs<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">)</span>
    outputs<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">)</span>
    config_schema<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
    constraints<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
    dependencies<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">WorkflowNode</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""工作流节点实例"""</span>
    node_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    template_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    <span class="token builtin">type</span><span class="token punctuation">:</span> NodeType
    config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span>
    position<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"x"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    metadata<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">WorkflowEdge</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""工作流边"""</span>
    source_node<span class="token punctuation">:</span> <span class="token builtin">str</span>
    source_output<span class="token punctuation">:</span> <span class="token builtin">str</span>
    target_node<span class="token punctuation">:</span> <span class="token builtin">str</span>
    target_input<span class="token punctuation">:</span> <span class="token builtin">str</span>
    condition<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token keyword">class</span> <span class="token class-name">WorkflowGenerator</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""工作流生成器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> template_dir<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"./templates"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>template_dir <span class="token operator">=</span> template_dir
        self<span class="token punctuation">.</span>jinja_env <span class="token operator">=</span> Environment<span class="token punctuation">(</span>
            loader<span class="token operator">=</span>FileSystemLoader<span class="token punctuation">(</span>template_dir<span class="token punctuation">)</span><span class="token punctuation">,</span>
            extensions<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'jinja2.ext.do'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            trim_blocks<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            lstrip_blocks<span class="token operator">=</span><span class="token boolean">True</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 加载节点模板</span>
        self<span class="token punctuation">.</span>node_templates <span class="token operator">=</span> self<span class="token punctuation">.</span>load_node_templates<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 冲突检测图</span>
        self<span class="token punctuation">.</span>conflict_graph <span class="token operator">=</span> nx<span class="token punctuation">.</span>DiGraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">load_node_templates</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> NodeTemplate<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""加载节点模板"""</span>
        templates <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        
        <span class="token comment"># 加载模板文件</span>
        template_files <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string">"nodes/data_input.yaml"</span><span class="token punctuation">,</span>
            <span class="token string">"nodes/data_transform.yaml"</span><span class="token punctuation">,</span>
            <span class="token string">"nodes/ai_processing.yaml"</span><span class="token punctuation">,</span>
            <span class="token string">"nodes/output.yaml"</span>
        <span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> file_path <span class="token keyword">in</span> template_files<span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>template_dir<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>file_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                template_data <span class="token operator">=</span> yaml<span class="token punctuation">.</span>safe_load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
                
                <span class="token keyword">for</span> template_info <span class="token keyword">in</span> template_data<span class="token punctuation">[</span><span class="token string">'templates'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    template <span class="token operator">=</span> NodeTemplate<span class="token punctuation">(</span><span class="token operator">**</span>template_info<span class="token punctuation">)</span>
                    templates<span class="token punctuation">[</span>template<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">]</span> <span class="token operator">=</span> template
                    
                    <span class="token comment"># 添加到冲突检测图</span>
                    self<span class="token punctuation">.</span>conflict_graph<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>template<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span> <span class="token operator">**</span>template_info<span class="token punctuation">)</span>
        
        <span class="token comment"># 添加依赖关系到图</span>
        <span class="token keyword">for</span> template_id<span class="token punctuation">,</span> template <span class="token keyword">in</span> templates<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> dep <span class="token keyword">in</span> template<span class="token punctuation">.</span>dependencies<span class="token punctuation">:</span>
                <span class="token keyword">if</span> dep <span class="token keyword">in</span> templates<span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>conflict_graph<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>dep<span class="token punctuation">,</span> template_id<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> templates
    
    <span class="token keyword">def</span> <span class="token function">generate_workflow_from_batch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> DataBatch<span class="token punctuation">,</span> 
                                    workflow_type<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"default"</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""根据数据批次生成工作流"""</span>
        
        <span class="token comment"># 1. 确定处理流水线</span>
        pipeline <span class="token operator">=</span> self<span class="token punctuation">.</span>determine_processing_pipeline<span class="token punctuation">(</span>data_batch<span class="token punctuation">,</span> workflow_type<span class="token punctuation">)</span>
        
        <span class="token comment"># 2. 生成节点配置</span>
        nodes <span class="token operator">=</span> self<span class="token punctuation">.</span>generate_nodes_for_pipeline<span class="token punctuation">(</span>pipeline<span class="token punctuation">,</span> data_batch<span class="token punctuation">)</span>
        
        <span class="token comment"># 3. 连接节点</span>
        edges <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_nodes<span class="token punctuation">(</span>nodes<span class="token punctuation">)</span>
        
        <span class="token comment"># 4. 优化节点布局</span>
        nodes <span class="token operator">=</span> self<span class="token punctuation">.</span>optimize_node_layout<span class="token punctuation">(</span>nodes<span class="token punctuation">,</span> edges<span class="token punctuation">)</span>
        
        <span class="token comment"># 5. 生成完整工作流配置</span>
        workflow_config <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"workflow"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"auto_</span><span class="token interpolation"><span class="token punctuation">{</span>data_batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>workflow_type<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Automatically generated workflow for </span><span class="token interpolation"><span class="token punctuation">{</span>data_batch<span class="token punctuation">.</span>source_type<span class="token punctuation">.</span>value<span class="token punctuation">}</span></span><span class="token string"> data"</span></span><span class="token punctuation">,</span>
                <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
                <span class="token string">"created_at"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"metadata"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"batch_id"</span><span class="token punctuation">:</span> data_batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">,</span>
                    <span class="token string">"data_type"</span><span class="token punctuation">:</span> data_batch<span class="token punctuation">.</span>source_type<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
                    <span class="token string">"record_count"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">"workflow_type"</span><span class="token punctuation">:</span> workflow_type
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string">"nodes"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>serialize_node<span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token keyword">for</span> node <span class="token keyword">in</span> nodes<span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"edges"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>serialize_edge<span class="token punctuation">(</span>edge<span class="token punctuation">)</span> <span class="token keyword">for</span> edge <span class="token keyword">in</span> edges<span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">"global_config"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"timeout"</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
                    <span class="token string">"retry_policy"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"max_attempts"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                        <span class="token string">"backoff_factor"</span><span class="token punctuation">:</span> <span class="token number">2</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment"># 6. 验证工作流</span>
        self<span class="token punctuation">.</span>validate_workflow<span class="token punctuation">(</span>workflow_config<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> workflow_config
    
    <span class="token keyword">def</span> <span class="token function">determine_processing_pipeline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> DataBatch<span class="token punctuation">,</span> 
                                     workflow_type<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>NodeType<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""确定处理流水线"""</span>
        pipelines <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"structured_data_processing"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>DATA_OUTPUT
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"unstructured_text_processing"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">,</span>  <span class="token comment"># 文本分类/摘要</span>
                NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">,</span>  <span class="token comment"># 实体提取</span>
                NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span> <span class="token comment"># 结果格式化</span>
                NodeType<span class="token punctuation">.</span>DATA_OUTPUT
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"streaming_processing"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>LOGIC_CONTROL<span class="token punctuation">,</span>   <span class="token comment"># 窗口处理</span>
                NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>DATA_OUTPUT
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"batch_etl"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span>
                NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span>  <span class="token comment"># 清洗</span>
                NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span>  <span class="token comment"># 转换</span>
                NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span>  <span class="token comment"># 聚合</span>
                NodeType<span class="token punctuation">.</span>DATA_OUTPUT
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment"># 根据数据分类选择流水线</span>
        <span class="token keyword">if</span> data_batch<span class="token punctuation">.</span>source_type <span class="token operator">==</span> DataClassifier<span class="token punctuation">.</span>STRUCTURED<span class="token punctuation">:</span>
            <span class="token keyword">return</span> pipelines<span class="token punctuation">[</span><span class="token string">"structured_data_processing"</span><span class="token punctuation">]</span>
        <span class="token keyword">elif</span> data_batch<span class="token punctuation">.</span>source_type <span class="token operator">==</span> DataClassifier<span class="token punctuation">.</span>UNSTRUCTURED<span class="token punctuation">:</span>
            <span class="token keyword">return</span> pipelines<span class="token punctuation">[</span><span class="token string">"unstructured_text_processing"</span><span class="token punctuation">]</span>
        <span class="token keyword">elif</span> data_batch<span class="token punctuation">.</span>source_type <span class="token operator">==</span> DataClassifier<span class="token punctuation">.</span>STREAMING<span class="token punctuation">:</span>
            <span class="token keyword">return</span> pipelines<span class="token punctuation">[</span><span class="token string">"streaming_processing"</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> pipelines<span class="token punctuation">.</span>get<span class="token punctuation">(</span>workflow_type<span class="token punctuation">,</span> pipelines<span class="token punctuation">[</span><span class="token string">"structured_data_processing"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">generate_nodes_for_pipeline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> pipeline<span class="token punctuation">:</span> List<span class="token punctuation">[</span>NodeType<span class="token punctuation">]</span><span class="token punctuation">,</span> 
                                   data_batch<span class="token punctuation">:</span> DataBatch<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>WorkflowNode<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""为流水线生成节点"""</span>
        nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        node_counter <span class="token operator">=</span> <span class="token number">1</span>
        
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> node_type <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pipeline<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 选择模板</span>
            template <span class="token operator">=</span> self<span class="token punctuation">.</span>select_template_for_node<span class="token punctuation">(</span>node_type<span class="token punctuation">,</span> data_batch<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
            
            <span class="token comment"># 生成节点配置</span>
            node_config <span class="token operator">=</span> self<span class="token punctuation">.</span>generate_node_config<span class="token punctuation">(</span>template<span class="token punctuation">,</span> data_batch<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
            
            <span class="token comment"># 创建节点</span>
            node <span class="token operator">=</span> WorkflowNode<span class="token punctuation">(</span>
                node_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"node_</span><span class="token interpolation"><span class="token punctuation">{</span>node_counter<span class="token punctuation">:</span><span class="token format-spec">03d</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                template_id<span class="token operator">=</span>template<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span>
                name<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>template<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>node_counter<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token builtin">type</span><span class="token operator">=</span>node_type<span class="token punctuation">,</span>
                config<span class="token operator">=</span>node_config<span class="token punctuation">,</span>
                position<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"x"</span><span class="token punctuation">:</span> i <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                metadata<span class="token operator">=</span><span class="token punctuation">{</span>
                    <span class="token string">"stage"</span><span class="token punctuation">:</span> i<span class="token punctuation">,</span>
                    <span class="token string">"template_version"</span><span class="token punctuation">:</span> template<span class="token punctuation">.</span>version<span class="token punctuation">,</span>
                    <span class="token string">"generated_at"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
            
            nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>node<span class="token punctuation">)</span>
            node_counter <span class="token operator">+=</span> <span class="token number">1</span>
        
        <span class="token comment"># 添加特殊节点</span>
        nodes<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>self<span class="token punctuation">.</span>generate_special_nodes<span class="token punctuation">(</span>data_batch<span class="token punctuation">,</span> node_counter<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> nodes
    
    <span class="token keyword">def</span> <span class="token function">select_template_for_node</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node_type<span class="token punctuation">:</span> NodeType<span class="token punctuation">,</span> 
                                data_batch<span class="token punctuation">:</span> DataBatch<span class="token punctuation">,</span> 
                                stage<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> NodeTemplate<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""为节点选择模板"""</span>
        
        <span class="token comment"># 根据数据分类和阶段选择模板</span>
        template_map <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span> DataClassifier<span class="token punctuation">.</span>STRUCTURED<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"structured_input"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span> DataClassifier<span class="token punctuation">.</span>UNSTRUCTURED<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"unstructured_input"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">,</span> DataClassifier<span class="token punctuation">.</span>STREAMING<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"streaming_input"</span><span class="token punctuation">,</span>
            
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"text_classification"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"entity_extraction"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"summarization"</span><span class="token punctuation">,</span>
            
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"data_cleaning"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"data_enrichment"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_TRANSFORM<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"data_aggregation"</span><span class="token punctuation">,</span>
            
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_OUTPUT<span class="token punctuation">,</span> DataClassifier<span class="token punctuation">.</span>STRUCTURED<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"database_output"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_OUTPUT<span class="token punctuation">,</span> DataClassifier<span class="token punctuation">.</span>UNSTRUCTURED<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"file_output"</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>NodeType<span class="token punctuation">.</span>DATA_OUTPUT<span class="token punctuation">,</span> DataClassifier<span class="token punctuation">.</span>STREAMING<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">"stream_output"</span>
        <span class="token punctuation">}</span>
        
        template_key <span class="token operator">=</span> <span class="token punctuation">(</span>node_type<span class="token punctuation">,</span> data_batch<span class="token punctuation">.</span>source_type<span class="token punctuation">)</span>
        <span class="token keyword">if</span> template_key <span class="token keyword">in</span> template_map<span class="token punctuation">:</span>
            template_name <span class="token operator">=</span> template_map<span class="token punctuation">[</span>template_key<span class="token punctuation">]</span>
        <span class="token keyword">elif</span> <span class="token punctuation">(</span>node_type<span class="token punctuation">,</span> stage<span class="token punctuation">)</span> <span class="token keyword">in</span> template_map<span class="token punctuation">:</span>
            template_name <span class="token operator">=</span> template_map<span class="token punctuation">[</span><span class="token punctuation">(</span>node_type<span class="token punctuation">,</span> stage<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 默认模板</span>
            template_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>node_type<span class="token punctuation">.</span>value<span class="token punctuation">}</span></span><span class="token string">_default"</span></span>
        
        <span class="token comment"># 查找模板</span>
        <span class="token keyword">for</span> template <span class="token keyword">in</span> self<span class="token punctuation">.</span>node_templates<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> template<span class="token punctuation">.</span>category <span class="token operator">==</span> template_name<span class="token punctuation">:</span>
                <span class="token keyword">return</span> template
        
        <span class="token comment"># 返回第一个匹配类型的模板</span>
        <span class="token keyword">for</span> template <span class="token keyword">in</span> self<span class="token punctuation">.</span>node_templates<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> template<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> node_type<span class="token punctuation">:</span>
                <span class="token keyword">return</span> template
        
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"No template found for </span><span class="token interpolation"><span class="token punctuation">{</span>node_type<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">generate_node_config</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> template<span class="token punctuation">:</span> NodeTemplate<span class="token punctuation">,</span> 
                            data_batch<span class="token punctuation">:</span> DataBatch<span class="token punctuation">,</span> 
                            stage<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成节点配置"""</span>
        
        <span class="token comment"># 使用Jinja2模板生成配置</span>
        <span class="token keyword">if</span> template<span class="token punctuation">.</span>config_schema<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'template'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            template_str <span class="token operator">=</span> template<span class="token punctuation">.</span>config_schema<span class="token punctuation">[</span><span class="token string">'template'</span><span class="token punctuation">]</span>
            config_template <span class="token operator">=</span> Template<span class="token punctuation">(</span>template_str<span class="token punctuation">)</span>
            
            context <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">"data_batch"</span><span class="token punctuation">:</span> data_batch<span class="token punctuation">,</span>
                <span class="token string">"stage"</span><span class="token punctuation">:</span> stage<span class="token punctuation">,</span>
                <span class="token string">"node_type"</span><span class="token punctuation">:</span> template<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span>
                <span class="token string">"timestamp"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            
            config_str <span class="token operator">=</span> config_template<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token operator">**</span>context<span class="token punctuation">)</span>
            config <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>config_str<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 使用默认配置</span>
            config <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>template<span class="token punctuation">.</span>parameters<span class="token punctuation">)</span>
            
            <span class="token comment"># 根据数据批次调整配置</span>
            <span class="token keyword">if</span> template<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> NodeType<span class="token punctuation">.</span>DATA_INPUT<span class="token punctuation">:</span>
                config<span class="token punctuation">[</span><span class="token string">"data_source"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_batch<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'source'</span><span class="token punctuation">,</span> <span class="token string">'unknown'</span><span class="token punctuation">)</span>
                config<span class="token punctuation">[</span><span class="token string">"batch_size"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
                
            <span class="token keyword">elif</span> template<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> NodeType<span class="token punctuation">.</span>AI_PROCESSING<span class="token punctuation">:</span>
                <span class="token comment"># 根据数据量调整AI模型参数</span>
                data_size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> data_size <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">:</span>
                    config<span class="token punctuation">[</span><span class="token string">"model"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"large"</span>
                    config<span class="token punctuation">[</span><span class="token string">"chunk_size"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    config<span class="token punctuation">[</span><span class="token string">"model"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"standard"</span>
                    config<span class="token punctuation">[</span><span class="token string">"chunk_size"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1000</span>
        
        <span class="token keyword">return</span> config
    
    <span class="token keyword">def</span> <span class="token function">connect_nodes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nodes<span class="token punctuation">:</span> List<span class="token punctuation">[</span>WorkflowNode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>WorkflowEdge<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""连接节点"""</span>
        edges <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>nodes<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            source_node <span class="token operator">=</span> nodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            target_node <span class="token operator">=</span> nodes<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
            
            <span class="token comment"># 获取模板以了解输入输出</span>
            source_template <span class="token operator">=</span> self<span class="token punctuation">.</span>node_templates<span class="token punctuation">[</span>source_node<span class="token punctuation">.</span>template_id<span class="token punctuation">]</span>
            target_template <span class="token operator">=</span> self<span class="token punctuation">.</span>node_templates<span class="token punctuation">[</span>target_node<span class="token punctuation">.</span>template_id<span class="token punctuation">]</span>
            
            <span class="token comment"># 创建连接</span>
            edge <span class="token operator">=</span> WorkflowEdge<span class="token punctuation">(</span>
                source_node<span class="token operator">=</span>source_node<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
                source_output<span class="token operator">=</span>source_template<span class="token punctuation">.</span>outputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> source_template<span class="token punctuation">.</span>outputs <span class="token keyword">else</span> <span class="token string">"output"</span><span class="token punctuation">,</span>
                target_node<span class="token operator">=</span>target_node<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
                target_input<span class="token operator">=</span>target_template<span class="token punctuation">.</span>inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> target_template<span class="token punctuation">.</span>inputs <span class="token keyword">else</span> <span class="token string">"input"</span>
            <span class="token punctuation">)</span>
            
            edges<span class="token punctuation">.</span>append<span class="token punctuation">(</span>edge<span class="token punctuation">)</span>
        
        <span class="token comment"># 添加条件分支（如果需要）</span>
        edges<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>self<span class="token punctuation">.</span>create_conditional_edges<span class="token punctuation">(</span>nodes<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> edges
    
    <span class="token keyword">def</span> <span class="token function">create_conditional_edges</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nodes<span class="token punctuation">:</span> List<span class="token punctuation">[</span>WorkflowNode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>WorkflowEdge<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""创建条件分支边"""</span>
        conditional_edges <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 查找逻辑控制节点</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> node <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>nodes<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> node<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> NodeType<span class="token punctuation">.</span>LOGIC_CONTROL<span class="token punctuation">:</span>
                <span class="token comment"># 为逻辑节点创建条件分支</span>
                <span class="token keyword">if</span> i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nodes<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    true_branch <span class="token operator">=</span> nodes<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
                    false_branch <span class="token operator">=</span> nodes<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span>
                    
                    <span class="token comment"># 添加条件边</span>
                    conditional_edges<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">[</span>
                        WorkflowEdge<span class="token punctuation">(</span>
                            source_node<span class="token operator">=</span>node<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
                            source_output<span class="token operator">=</span><span class="token string">"true_output"</span><span class="token punctuation">,</span>
                            target_node<span class="token operator">=</span>true_branch<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
                            target_input<span class="token operator">=</span><span class="token string">"input"</span><span class="token punctuation">,</span>
                            condition<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"success"</span><span class="token punctuation">}</span>
                        <span class="token punctuation">)</span><span class="token punctuation">,</span>
                        WorkflowEdge<span class="token punctuation">(</span>
                            source_node<span class="token operator">=</span>node<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
                            source_output<span class="token operator">=</span><span class="token string">"false_output"</span><span class="token punctuation">,</span>
                            target_node<span class="token operator">=</span>false_branch<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
                            target_input<span class="token operator">=</span><span class="token string">"input"</span><span class="token punctuation">,</span>
                            condition<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"failure"</span><span class="token punctuation">}</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> conditional_edges
    
    <span class="token keyword">def</span> <span class="token function">optimize_node_layout</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> nodes<span class="token punctuation">:</span> List<span class="token punctuation">[</span>WorkflowNode<span class="token punctuation">]</span><span class="token punctuation">,</span> 
                           edges<span class="token punctuation">:</span> List<span class="token punctuation">[</span>WorkflowEdge<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>WorkflowNode<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""优化节点布局"""</span>
        
        <span class="token comment"># 创建图用于布局计算</span>
        G <span class="token operator">=</span> nx<span class="token punctuation">.</span>DiGraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 添加节点</span>
        <span class="token keyword">for</span> node <span class="token keyword">in</span> nodes<span class="token punctuation">:</span>
            G<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>node<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>position<span class="token punctuation">[</span><span class="token string">"x"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> node<span class="token punctuation">.</span>position<span class="token punctuation">[</span><span class="token string">"y"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 添加边</span>
        <span class="token keyword">for</span> edge <span class="token keyword">in</span> edges<span class="token punctuation">:</span>
            G<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>edge<span class="token punctuation">.</span>source_node<span class="token punctuation">,</span> edge<span class="token punctuation">.</span>target_node<span class="token punctuation">)</span>
        
        <span class="token comment"># 使用networkx的布局算法</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># spring布局</span>
            pos <span class="token operator">=</span> nx<span class="token punctuation">.</span>spring_layout<span class="token punctuation">(</span>G<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> iterations<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 更新节点位置</span>
            <span class="token keyword">for</span> node <span class="token keyword">in</span> nodes<span class="token punctuation">:</span>
                <span class="token keyword">if</span> node<span class="token punctuation">.</span>node_id <span class="token keyword">in</span> pos<span class="token punctuation">:</span>
                    node<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token string">"x"</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>pos<span class="token punctuation">[</span>node<span class="token punctuation">.</span>node_id<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token string">"y"</span><span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>pos<span class="token punctuation">[</span>node<span class="token punctuation">.</span>node_id<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果布局失败，使用简单的网格布局</span>
            <span class="token keyword">for</span> i<span class="token punctuation">,</span> node <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>nodes<span class="token punctuation">)</span><span class="token punctuation">:</span>
                row <span class="token operator">=</span> i <span class="token operator">//</span> <span class="token number">5</span>
                col <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">5</span>
                node<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"x"</span><span class="token punctuation">:</span> col <span class="token operator">*</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">:</span> row <span class="token operator">*</span> <span class="token number">150</span><span class="token punctuation">}</span>
        
        <span class="token keyword">return</span> nodes
    
    <span class="token keyword">def</span> <span class="token function">validate_workflow</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> workflow_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""验证工作流配置"""</span>
        
        <span class="token comment"># 检查节点完整性</span>
        nodes <span class="token operator">=</span> workflow_config<span class="token punctuation">[</span><span class="token string">"workflow"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"nodes"</span><span class="token punctuation">]</span>
        edges <span class="token operator">=</span> workflow_config<span class="token punctuation">[</span><span class="token string">"workflow"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"edges"</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 1. 检查节点ID唯一性</span>
        node_ids <span class="token operator">=</span> <span class="token punctuation">[</span>node<span class="token punctuation">[</span><span class="token string">"node_id"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> node <span class="token keyword">in</span> nodes<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>node_ids<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>node_ids<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Duplicate node IDs found"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 2. 检查边引用有效性</span>
        valid_node_ids <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>node_ids<span class="token punctuation">)</span>
        <span class="token keyword">for</span> edge <span class="token keyword">in</span> edges<span class="token punctuation">:</span>
            <span class="token keyword">if</span> edge<span class="token punctuation">[</span><span class="token string">"source_node"</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> valid_node_ids<span class="token punctuation">:</span>
                <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Invalid source node in edge: </span><span class="token interpolation"><span class="token punctuation">{</span>edge<span class="token punctuation">[</span><span class="token string">'source_node'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> edge<span class="token punctuation">[</span><span class="token string">"target_node"</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> valid_node_ids<span class="token punctuation">:</span>
                <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Invalid target node in edge: </span><span class="token interpolation"><span class="token punctuation">{</span>edge<span class="token punctuation">[</span><span class="token string">'target_node'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 3. 检查循环依赖</span>
        G <span class="token operator">=</span> nx<span class="token punctuation">.</span>DiGraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> edge <span class="token keyword">in</span> edges<span class="token punctuation">:</span>
            G<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>edge<span class="token punctuation">[</span><span class="token string">"source_node"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edge<span class="token punctuation">[</span><span class="token string">"target_node"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> nx<span class="token punctuation">.</span>is_directed_acyclic_graph<span class="token punctuation">(</span>G<span class="token punctuation">)</span><span class="token punctuation">:</span>
            cycles <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>nx<span class="token punctuation">.</span>simple_cycles<span class="token punctuation">(</span>G<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Workflow contains cycles: </span><span class="token interpolation"><span class="token punctuation">{</span>cycles<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 4. 检查输入输出匹配</span>
        <span class="token keyword">for</span> edge <span class="token keyword">in</span> edges<span class="token punctuation">:</span>
            source_node <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>n <span class="token keyword">for</span> n <span class="token keyword">in</span> nodes <span class="token keyword">if</span> n<span class="token punctuation">[</span><span class="token string">"node_id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> edge<span class="token punctuation">[</span><span class="token string">"source_node"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            target_node <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>n <span class="token keyword">for</span> n <span class="token keyword">in</span> nodes <span class="token keyword">if</span> n<span class="token punctuation">[</span><span class="token string">"node_id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> edge<span class="token punctuation">[</span><span class="token string">"target_node"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            source_template <span class="token operator">=</span> self<span class="token punctuation">.</span>node_templates<span class="token punctuation">.</span>get<span class="token punctuation">(</span>source_node<span class="token punctuation">[</span><span class="token string">"template_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            target_template <span class="token operator">=</span> self<span class="token punctuation">.</span>node_templates<span class="token punctuation">.</span>get<span class="token punctuation">(</span>target_node<span class="token punctuation">[</span><span class="token string">"template_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> source_template <span class="token keyword">and</span> target_template<span class="token punctuation">:</span>
                <span class="token keyword">if</span> edge<span class="token punctuation">[</span><span class="token string">"source_output"</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> source_template<span class="token punctuation">.</span>outputs<span class="token punctuation">:</span>
                    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Invalid output port: </span><span class="token interpolation"><span class="token punctuation">{</span>edge<span class="token punctuation">[</span><span class="token string">'source_output'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> edge<span class="token punctuation">[</span><span class="token string">"target_input"</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> target_template<span class="token punctuation">.</span>inputs<span class="token punctuation">:</span>
                    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Invalid input port: </span><span class="token interpolation"><span class="token punctuation">{</span>edge<span class="token punctuation">[</span><span class="token string">'target_input'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    
    <span class="token keyword">def</span> <span class="token function">serialize_node</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node<span class="token punctuation">:</span> WorkflowNode<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""序列化节点"""</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"node_id"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span>node_id<span class="token punctuation">,</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span>
            <span class="token string">"template_id"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span>template_id<span class="token punctuation">,</span>
            <span class="token string">"config"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span>config<span class="token punctuation">,</span>
            <span class="token string">"position"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span>position<span class="token punctuation">,</span>
            <span class="token string">"metadata"</span><span class="token punctuation">:</span> node<span class="token punctuation">.</span>metadata
        <span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">serialize_edge</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> edge<span class="token punctuation">:</span> WorkflowEdge<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""序列化边"""</span>
        serialized <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"source_node"</span><span class="token punctuation">:</span> edge<span class="token punctuation">.</span>source_node<span class="token punctuation">,</span>
            <span class="token string">"source_output"</span><span class="token punctuation">:</span> edge<span class="token punctuation">.</span>source_output<span class="token punctuation">,</span>
            <span class="token string">"target_node"</span><span class="token punctuation">:</span> edge<span class="token punctuation">.</span>target_node<span class="token punctuation">,</span>
            <span class="token string">"target_input"</span><span class="token punctuation">:</span> edge<span class="token punctuation">.</span>target_input
        <span class="token punctuation">}</span>
        
        <span class="token keyword">if</span> edge<span class="token punctuation">.</span>condition<span class="token punctuation">:</span>
            serialized<span class="token punctuation">[</span><span class="token string">"condition"</span><span class="token punctuation">]</span> <span class="token operator">=</span> edge<span class="token punctuation">.</span>condition
        
        <span class="token keyword">return</span> serialized
    
    <span class="token keyword">def</span> <span class="token function">generate_special_nodes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> DataBatch<span class="token punctuation">,</span> 
                              start_counter<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>WorkflowNode<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成特殊节点（监控、日志等）"""</span>
        special_nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 监控节点</span>
        monitor_node <span class="token operator">=</span> WorkflowNode<span class="token punctuation">(</span>
            node_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"node_</span><span class="token interpolation"><span class="token punctuation">{</span>start_counter<span class="token punctuation">:</span><span class="token format-spec">03d</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            template_id<span class="token operator">=</span><span class="token string">"monitor_node"</span><span class="token punctuation">,</span>
            name<span class="token operator">=</span><span class="token string">"workflow_monitor"</span><span class="token punctuation">,</span>
            <span class="token builtin">type</span><span class="token operator">=</span>NodeType<span class="token punctuation">.</span>CUSTOM_FUNCTION<span class="token punctuation">,</span>
            config<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">"monitoring"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"metrics"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"throughput"</span><span class="token punctuation">,</span> <span class="token string">"latency"</span><span class="token punctuation">,</span> <span class="token string">"error_rate"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">"alert_thresholds"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"error_rate"</span><span class="token punctuation">:</span> <span class="token number">0.05</span><span class="token punctuation">,</span>
                        <span class="token string">"latency_p95"</span><span class="token punctuation">:</span> <span class="token number">30</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            metadata<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"purpose"</span><span class="token punctuation">:</span> <span class="token string">"monitoring"</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        special_nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>monitor_node<span class="token punctuation">)</span>
        start_counter <span class="token operator">+=</span> <span class="token number">1</span>
        
        <span class="token comment"># 日志节点</span>
        logger_node <span class="token operator">=</span> WorkflowNode<span class="token punctuation">(</span>
            node_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"node_</span><span class="token interpolation"><span class="token punctuation">{</span>start_counter<span class="token punctuation">:</span><span class="token format-spec">03d</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
            template_id<span class="token operator">=</span><span class="token string">"logger_node"</span><span class="token punctuation">,</span>
            name<span class="token operator">=</span><span class="token string">"workflow_logger"</span><span class="token punctuation">,</span>
            <span class="token builtin">type</span><span class="token operator">=</span>NodeType<span class="token punctuation">.</span>CUSTOM_FUNCTION<span class="token punctuation">,</span>
            config<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">"logging"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token string">"level"</span><span class="token punctuation">:</span> <span class="token string">"INFO"</span><span class="token punctuation">,</span>
                    <span class="token string">"format"</span><span class="token punctuation">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
                    <span class="token string">"outputs"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"console"</span><span class="token punctuation">,</span> <span class="token string">"file"</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            metadata<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"purpose"</span><span class="token punctuation">:</span> <span class="token string">"logging"</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        special_nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>logger_node<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> special_nodes</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>4.2 节点模板示例</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">yaml</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># templates/nodes/data_input.yaml</span>
<span class="token key atrule">templates</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">"structured_input"</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"data_input"</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"Structured Data Input"</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"Input node for structured data from databases"</span>
    <span class="token key atrule">category</span><span class="token punctuation">:</span> <span class="token string">"structured_input"</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"1.0"</span>
    <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
      <span class="token key atrule">connection_type</span><span class="token punctuation">:</span> <span class="token string">"database"</span>
      <span class="token key atrule">query_template</span><span class="token punctuation">:</span> <span class="token string">"SELECT * FROM ${table} WHERE updated_at &gt; :last_checkpoint"</span>
      <span class="token key atrule">batch_size</span><span class="token punctuation">:</span> <span class="token number">1000</span>
      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">30</span>
    <span class="token key atrule">inputs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token key atrule">outputs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"data_output"</span><span class="token punctuation">]</span>
    <span class="token key atrule">config_schema</span><span class="token punctuation">:</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"object"</span>
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"data_source"</span><span class="token punctuation">]</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">data_source</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"object"</span>
          <span class="token key atrule">properties</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span>
              <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
              <span class="token key atrule">enum</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"postgresql"</span><span class="token punctuation">,</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span> <span class="token string">"mongodb"</span><span class="token punctuation">]</span>
            <span class="token key atrule">connection_string</span><span class="token punctuation">:</span>
              <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
            <span class="token key atrule">table</span><span class="token punctuation">:</span>
              <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
      <span class="token key atrule">template</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        {
          "data_source": {
            "type": "{{ data_batch.metadata.get('source_type', 'postgresql') }}",
            "connection_string": "${DB_CONNECTION_STRING}",
            "table": "{{ data_batch.metadata.get('table', 'data_table') }}"
          },
          "query": "SELECT * FROM {{ data_batch.metadata.get('table', 'data_table') }} WHERE id IN ({{ data_batch.data | map(attribute='id') | join(',') }})",
          "batch_size": {{ data_batch.metadata.get('record_count', 1000) }},
          "timeout": 30
        }</span>
    <span class="token key atrule">constraints</span><span class="token punctuation">:</span>
      <span class="token key atrule">max_input_size</span><span class="token punctuation">:</span> <span class="token string">"10MB"</span>
      <span class="token key atrule">supported_formats</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"json"</span><span class="token punctuation">,</span> <span class="token string">"csv"</span><span class="token punctuation">]</span>
    <span class="token key atrule">dependencies</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  
  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">"unstructured_input"</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"data_input"</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"Unstructured Data Input"</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"Input node for unstructured text data"</span>
    <span class="token key atrule">category</span><span class="token punctuation">:</span> <span class="token string">"unstructured_input"</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"1.0"</span>
    <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
      <span class="token key atrule">input_type</span><span class="token punctuation">:</span> <span class="token string">"text"</span>
      <span class="token key atrule">encoding</span><span class="token punctuation">:</span> <span class="token string">"utf-8"</span>
      <span class="token key atrule">chunk_size</span><span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token key atrule">inputs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token key atrule">outputs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"text_output"</span><span class="token punctuation">]</span>
    <span class="token key atrule">config_schema</span><span class="token punctuation">:</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"object"</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">source_path</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
        <span class="token key atrule">preprocessing</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"object"</span>
          <span class="token key atrule">properties</span><span class="token punctuation">:</span>
            <span class="token key atrule">clean_html</span><span class="token punctuation">:</span>
              <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span>
            <span class="token key atrule">remove_special_chars</span><span class="token punctuation">:</span>
              <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span>
            <span class="token key atrule">language</span><span class="token punctuation">:</span>
              <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
      <span class="token key atrule">template</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        {
          "source_path": "{{ data_batch.metadata.get('source_path', '/data/input') }}",
          "preprocessing": {
            "clean_html": true,
            "remove_special_chars": true,
            "language": "{{ data_batch.metadata.get('language', 'en') }}"
          },
          "chunk_strategy": "fixed_size",
          "chunk_size": 500
        }</span>

<span class="token comment"># templates/nodes/ai_processing.yaml</span>
<span class="token key atrule">templates</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">"text_classification"</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"ai_processing"</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"Text Classification"</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">"Classify text using AI models"</span>
    <span class="token key atrule">category</span><span class="token punctuation">:</span> <span class="token string">"text_classification"</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"1.1"</span>
    <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
      <span class="token key atrule">model</span><span class="token punctuation">:</span> <span class="token string">"gpt-3.5-turbo"</span>
      <span class="token key atrule">temperature</span><span class="token punctuation">:</span> <span class="token number">0.7</span>
      <span class="token key atrule">max_tokens</span><span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token key atrule">inputs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"text_input"</span><span class="token punctuation">]</span>
    <span class="token key atrule">outputs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"classification_output"</span><span class="token punctuation">]</span>
    <span class="token key atrule">config_schema</span><span class="token punctuation">:</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"object"</span>
      <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"model"</span><span class="token punctuation">,</span> <span class="token string">"categories"</span><span class="token punctuation">]</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">model</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
          <span class="token key atrule">enum</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"gpt-3.5-turbo"</span><span class="token punctuation">,</span> <span class="token string">"gpt-4"</span><span class="token punctuation">,</span> <span class="token string">"claude-2"</span><span class="token punctuation">,</span> <span class="token string">"llama-2"</span><span class="token punctuation">]</span>
        <span class="token key atrule">categories</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"array"</span>
          <span class="token key atrule">items</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"string"</span>
        <span class="token key atrule">confidence_threshold</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"number"</span>
          <span class="token key atrule">minimum</span><span class="token punctuation">:</span> <span class="token number">0</span>
          <span class="token key atrule">maximum</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token key atrule">template</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        {
          "model": "{{ config.get('model', 'gpt-3.5-turbo') }}",
          "temperature": {{ config.get('temperature', 0.7) }},
          "categories": ["positive", "negative", "neutral"],
          "prompt_template": "Classify the following text into one of the categories: positive, negative, or neutral.\\n\\nText: {{ text }}\\n\\nCategory:",
          "confidence_threshold": 0.8,
          "max_retries": 3
        }</span>
    <span class="token key atrule">constraints</span><span class="token punctuation">:</span>
      <span class="token key atrule">max_text_length</span><span class="token punctuation">:</span> <span class="token number">4000</span>
      <span class="token key atrule">max_batch_size</span><span class="token punctuation">:</span> <span class="token number">100</span>
    <span class="token key atrule">dependencies</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>五、无冲突自动化运行引擎</span></h2><h3><span>5.1 分布式任务调度器</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># scheduler.py</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time
<span class="token keyword">import</span> uuid
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Any<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Set
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token punctuation">,</span> field
<span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum
<span class="token keyword">import</span> heapq
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor<span class="token punctuation">,</span> ProcessPoolExecutor
<span class="token keyword">import</span> threading
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta
<span class="token keyword">import</span> redis
<span class="token keyword">import</span> pickle

<span class="token keyword">class</span> <span class="token class-name">TaskPriority</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    CRITICAL <span class="token operator">=</span> <span class="token number">0</span>
    HIGH <span class="token operator">=</span> <span class="token number">1</span>
    NORMAL <span class="token operator">=</span> <span class="token number">2</span>
    LOW <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">class</span> <span class="token class-name">TaskStatus</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PENDING <span class="token operator">=</span> <span class="token string">"pending"</span>
    RUNNING <span class="token operator">=</span> <span class="token string">"running"</span>
    COMPLETED <span class="token operator">=</span> <span class="token string">"completed"</span>
    FAILED <span class="token operator">=</span> <span class="token string">"failed"</span>
    CANCELLED <span class="token operator">=</span> <span class="token string">"cancelled"</span>
    RETRYING <span class="token operator">=</span> <span class="token string">"retrying"</span>

<span class="token decorator annotation punctuation">@dataclass</span><span class="token punctuation">(</span>order<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">ScheduledTask</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计划任务"""</span>
    priority<span class="token punctuation">:</span> <span class="token builtin">int</span>
    scheduled_time<span class="token punctuation">:</span> datetime
    task_id<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>compare<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>compare<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    batch_id<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>compare<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    data<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>compare<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    metadata<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>compare<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">__post_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduled_time<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>fromisoformat<span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduled_time<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">ExecutionSlot</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""执行槽位"""</span>
    slot_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    node_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    start_time<span class="token punctuation">:</span> datetime
    end_time<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>datetime<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    status<span class="token punctuation">:</span> TaskStatus <span class="token operator">=</span> TaskStatus<span class="token punctuation">.</span>RUNNING
    resources<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">DistributedScheduler</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""分布式调度器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>config <span class="token operator">=</span> config
        self<span class="token punctuation">.</span>task_queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> ExecutionSlot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>completed_tasks<span class="token punctuation">:</span> List<span class="token punctuation">[</span>ExecutionSlot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">:</span> List<span class="token punctuation">[</span>ExecutionSlot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 分布式锁和协调</span>
        self<span class="token punctuation">.</span>redis_client <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">.</span>from_url<span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'redis_url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lock_timeout <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'lock_timeout'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 资源跟踪</span>
        self<span class="token punctuation">.</span>resource_limits <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'cpu'</span><span class="token punctuation">:</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_cpu'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'memory'</span><span class="token punctuation">:</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_memory_gb'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'gpu'</span><span class="token punctuation">:</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_gpu'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'concurrent_workflows'</span><span class="token punctuation">:</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_concurrent_workflows'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        self<span class="token punctuation">.</span>current_resources <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'cpu'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">'memory'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">'gpu'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">'concurrent_workflows'</span><span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment"># 执行器池</span>
        self<span class="token punctuation">.</span>thread_executor <span class="token operator">=</span> ThreadPoolExecutor<span class="token punctuation">(</span>
            max_workers<span class="token operator">=</span>config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_threads'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>process_executor <span class="token operator">=</span> ProcessPoolExecutor<span class="token punctuation">(</span>
            max_workers<span class="token operator">=</span>config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_processes'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 启动调度循环</span>
        self<span class="token punctuation">.</span>scheduler_loop_task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_scheduler_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">schedule_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""调度任务"""</span>
        
        <span class="token comment"># 获取分布式锁</span>
        lock_key <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"scheduler_lock:</span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        lock <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>acquire_distributed_lock<span class="token punctuation">(</span>lock_key<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> lock<span class="token punctuation">:</span>
            <span class="token comment"># 如果获取锁失败，重新调度</span>
            task<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
            heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>self<span class="token punctuation">.</span>task_queue<span class="token punctuation">,</span> task<span class="token punctuation">)</span>
            <span class="token keyword">return</span> task<span class="token punctuation">.</span>task_id
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 检查资源可用性</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>check_resources_available<span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 资源不足，延迟调度</span>
                task<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
                heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>self<span class="token punctuation">.</span>task_queue<span class="token punctuation">,</span> task<span class="token punctuation">)</span>
                <span class="token keyword">return</span> task<span class="token punctuation">.</span>task_id
            
            <span class="token comment"># 分配资源</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>allocate_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
            
            <span class="token comment"># 创建执行槽位</span>
            slot <span class="token operator">=</span> ExecutionSlot<span class="token punctuation">(</span>
                slot_id<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                node_id<span class="token operator">=</span>task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'node_id'</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                workflow_id<span class="token operator">=</span>task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">,</span>
                start_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                resources<span class="token operator">=</span>self<span class="token punctuation">.</span>estimate_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            
            self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">[</span>task<span class="token punctuation">.</span>task_id<span class="token punctuation">]</span> <span class="token operator">=</span> slot
            
            <span class="token comment"># 提交执行</span>
            asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>self<span class="token punctuation">.</span>execute_task<span class="token punctuation">(</span>task<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token keyword">return</span> task<span class="token punctuation">.</span>task_id
            
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>release_distributed_lock<span class="token punctuation">(</span>lock_key<span class="token punctuation">,</span> lock<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">execute_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">,</span> slot<span class="token punctuation">:</span> ExecutionSlot<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""执行任务"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 根据任务类型选择执行器</span>
            executor <span class="token operator">=</span> self<span class="token punctuation">.</span>select_executor<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> executor <span class="token operator">==</span> <span class="token string">'thread'</span><span class="token punctuation">:</span>
                loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
                result <span class="token operator">=</span> <span class="token keyword">await</span> loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span>
                    self<span class="token punctuation">.</span>thread_executor<span class="token punctuation">,</span>
                    self<span class="token punctuation">.</span>_execute_workflow_task<span class="token punctuation">,</span>
                    task
                <span class="token punctuation">)</span>
            <span class="token keyword">elif</span> executor <span class="token operator">==</span> <span class="token string">'process'</span><span class="token punctuation">:</span>
                loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
                result <span class="token operator">=</span> <span class="token keyword">await</span> loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span>
                    self<span class="token punctuation">.</span>process_executor<span class="token punctuation">,</span>
                    self<span class="token punctuation">.</span>_execute_workflow_task<span class="token punctuation">,</span>
                    task
                <span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                result <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>_execute_async_task<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
            
            <span class="token comment"># 标记任务完成</span>
            slot<span class="token punctuation">.</span>end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            slot<span class="token punctuation">.</span>status <span class="token operator">=</span> TaskStatus<span class="token punctuation">.</span>COMPLETED
            
            self<span class="token punctuation">.</span>completed_tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>
            <span class="token keyword">del</span> self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">[</span>task<span class="token punctuation">.</span>task_id<span class="token punctuation">]</span>
            
            <span class="token comment"># 释放资源</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>release_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
            
            <span class="token comment"># 触发后续任务</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>trigger_dependent_tasks<span class="token punctuation">(</span>task<span class="token punctuation">,</span> result<span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token comment"># 处理任务失败</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>handle_task_failure<span class="token punctuation">(</span>task<span class="token punctuation">,</span> slot<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_scheduler_loop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""调度循环"""</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>_process_task_queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>_cleanup_completed_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>_check_timeouts<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>_balance_load<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 每秒检查一次</span>
                
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Scheduler loop error: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_process_task_queue</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""处理任务队列"""</span>
        now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">while</span> self<span class="token punctuation">.</span>task_queue<span class="token punctuation">:</span>
            <span class="token comment"># 查看下一个任务</span>
            task <span class="token operator">=</span> self<span class="token punctuation">.</span>task_queue<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            
            <span class="token keyword">if</span> task<span class="token punctuation">.</span>scheduled_time <span class="token operator">&gt;</span> now<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            
            <span class="token comment"># 弹出任务并调度</span>
            heapq<span class="token punctuation">.</span>heappop<span class="token punctuation">(</span>self<span class="token punctuation">.</span>task_queue<span class="token punctuation">)</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>schedule_task<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">check_resources_available</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查资源是否可用"""</span>
        required <span class="token operator">=</span> self<span class="token punctuation">.</span>estimate_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
        
        <span class="token comment"># 检查CPU</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span><span class="token string">'cpu'</span><span class="token punctuation">]</span> <span class="token operator">+</span> required<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> 
            self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span><span class="token string">'cpu'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        
        <span class="token comment"># 检查内存</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span><span class="token string">'memory'</span><span class="token punctuation">]</span> <span class="token operator">+</span> required<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'memory'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> 
            self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span><span class="token string">'memory'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        
        <span class="token comment"># 检查并发工作流数</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span><span class="token string">'concurrent_workflows'</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> 
            self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span><span class="token string">'concurrent_workflows'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        
        <span class="token comment"># 检查GPU（如果需要）</span>
        <span class="token keyword">if</span> required<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'gpu'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span><span class="token string">'gpu'</span><span class="token punctuation">]</span> <span class="token operator">+</span> required<span class="token punctuation">[</span><span class="token string">'gpu'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> 
                self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span><span class="token string">'gpu'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
        
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    
    <span class="token keyword">def</span> <span class="token function">estimate_resources</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""估计任务资源需求"""</span>
        metadata <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata
        
        <span class="token comment"># 根据工作流类型和数据量估计资源</span>
        data_size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'workflow_type'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'ai_processing'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token string">'cpu'</span><span class="token punctuation">:</span> <span class="token number">2.0</span><span class="token punctuation">,</span>
                <span class="token string">'memory'</span><span class="token punctuation">:</span> data_size <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment"># MB</span>
                <span class="token string">'gpu'</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> data_size <span class="token operator">&lt;</span> <span class="token number">10000</span> <span class="token keyword">else</span> <span class="token number">0.5</span>
            <span class="token punctuation">}</span>
        <span class="token keyword">elif</span> metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'workflow_type'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'data_transform'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token string">'cpu'</span><span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
                <span class="token string">'memory'</span><span class="token punctuation">:</span> data_size <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">,</span>
                <span class="token string">'gpu'</span><span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token string">'cpu'</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
                <span class="token string">'memory'</span><span class="token punctuation">:</span> data_size <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">,</span>
                <span class="token string">'gpu'</span><span class="token punctuation">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">allocate_resources</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""分配资源"""</span>
        required <span class="token operator">=</span> self<span class="token punctuation">.</span>estimate_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> resource<span class="token punctuation">,</span> amount <span class="token keyword">in</span> required<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> resource <span class="token keyword">in</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span>resource<span class="token punctuation">]</span> <span class="token operator">+=</span> amount
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">release_resources</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""释放资源"""</span>
        required <span class="token operator">=</span> self<span class="token punctuation">.</span>estimate_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> resource<span class="token punctuation">,</span> amount <span class="token keyword">in</span> required<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> resource <span class="token keyword">in</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span>resource<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
                    <span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span>resource<span class="token punctuation">]</span> <span class="token operator">-</span> amount
                <span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">select_executor</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""选择执行器"""</span>
        workflow_type <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'workflow_type'</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> workflow_type <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'ai_processing'</span><span class="token punctuation">,</span> <span class="token string">'model_inference'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'process'</span>  <span class="token comment"># CPU密集型</span>
        <span class="token keyword">elif</span> workflow_type <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'data_transform'</span><span class="token punctuation">,</span> <span class="token string">'io_operations'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'thread'</span>   <span class="token comment"># I/O密集型</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'async'</span>    <span class="token comment"># 异步任务</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">acquire_distributed_lock</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lock_key<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> 
                                      timeout<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取分布式锁"""</span>
        timeout <span class="token operator">=</span> timeout <span class="token keyword">or</span> self<span class="token punctuation">.</span>lock_timeout
        lock_value <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 使用Redis SET NX EX命令获取锁</span>
        acquired <span class="token operator">=</span> self<span class="token punctuation">.</span>redis_client<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>
            lock_key<span class="token punctuation">,</span> 
            lock_value<span class="token punctuation">,</span> 
            nx<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> 
            ex<span class="token operator">=</span>timeout
        <span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> acquired<span class="token punctuation">:</span>
            <span class="token keyword">return</span> lock_value
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">release_distributed_lock</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lock_key<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> lock_value<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""释放分布式锁"""</span>
        <span class="token comment"># 使用Lua脚本确保原子性</span>
        lua_script <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
        if redis.call("get", KEYS[1]) == ARGV[1] then
            return redis.call("del", KEYS[1])
        else
            return 0
        end
        """</span>
        
        self<span class="token punctuation">.</span>redis_client<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>lua_script<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lock_key<span class="token punctuation">,</span> lock_value<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">trigger_dependent_tasks</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">,</span> result<span class="token punctuation">:</span> Any<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""触发依赖任务"""</span>
        <span class="token comment"># 查找依赖此任务的任务</span>
        dependent_tasks <span class="token operator">=</span> self<span class="token punctuation">.</span>find_dependent_tasks<span class="token punctuation">(</span>task<span class="token punctuation">.</span>task_id<span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> dep_task <span class="token keyword">in</span> dependent_tasks<span class="token punctuation">:</span>
            <span class="token comment"># 更新任务数据</span>
            dep_task<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'parent_result'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result
            
            <span class="token comment"># 重新调度</span>
            dep_task<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>self<span class="token punctuation">.</span>task_queue<span class="token punctuation">,</span> dep_task<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">find_dependent_tasks</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>ScheduledTask<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""查找依赖任务"""</span>
        dependent <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> task <span class="token keyword">in</span> self<span class="token punctuation">.</span>task_queue<span class="token punctuation">:</span>
            <span class="token keyword">if</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'depends_on'</span><span class="token punctuation">)</span> <span class="token operator">==</span> task_id<span class="token punctuation">:</span>
                dependent<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> dependent
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">handle_task_failure</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">,</span> 
                                 slot<span class="token punctuation">:</span> ExecutionSlot<span class="token punctuation">,</span> 
                                 error<span class="token punctuation">:</span> Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""处理任务失败"""</span>
        slot<span class="token punctuation">.</span>end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        slot<span class="token punctuation">.</span>status <span class="token operator">=</span> TaskStatus<span class="token punctuation">.</span>FAILED
        
        <span class="token comment"># 记录失败</span>
        self<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">[</span>task<span class="token punctuation">.</span>task_id<span class="token punctuation">]</span>
        
        <span class="token comment"># 释放资源</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>release_resources<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
        
        <span class="token comment"># 检查重试策略</span>
        retry_count <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'retry_count'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        max_retries <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_retries'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> retry_count <span class="token operator">&lt;</span> max_retries<span class="token punctuation">:</span>
            <span class="token comment"># 重新调度任务</span>
            retry_task <span class="token operator">=</span> ScheduledTask<span class="token punctuation">(</span>
                priority<span class="token operator">=</span>task<span class="token punctuation">.</span>priority <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 提高优先级</span>
                scheduled_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>
                    seconds<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">**</span> retry_count  <span class="token comment"># 指数退避</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                task_id<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>task_id<span class="token punctuation">}</span></span><span class="token string">_retry_</span><span class="token interpolation"><span class="token punctuation">{</span>retry_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                workflow_id<span class="token operator">=</span>task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">,</span>
                batch_id<span class="token operator">=</span>task<span class="token punctuation">.</span>batch_id<span class="token punctuation">,</span>
                data<span class="token operator">=</span>task<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                metadata<span class="token operator">=</span><span class="token punctuation">{</span>
                    <span class="token operator">**</span>task<span class="token punctuation">.</span>metadata<span class="token punctuation">,</span>
                    <span class="token string">'retry_count'</span><span class="token punctuation">:</span> retry_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token string">'previous_error'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
            
            heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>self<span class="token punctuation">.</span>task_queue<span class="token punctuation">,</span> retry_task<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 达到最大重试次数，放入死信队列</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>send_to_dead_letter_queue<span class="token punctuation">(</span>task<span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_to_dead_letter_queue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">,</span> error<span class="token punctuation">:</span> Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送到死信队列"""</span>
        dlq_message <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'task_id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>task_id<span class="token punctuation">,</span>
            <span class="token string">'workflow_id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">,</span>
            <span class="token string">'batch_id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>batch_id<span class="token punctuation">,</span>
            <span class="token string">'data'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
            <span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'timestamp'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'retry_count'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'retry_count'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment"># 存储到Redis</span>
        self<span class="token punctuation">.</span>redis_client<span class="token punctuation">.</span>lpush<span class="token punctuation">(</span>
            <span class="token string">'dead_letter_queue'</span><span class="token punctuation">,</span>
            pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>dlq_message<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 触发告警</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>trigger_failure_alert<span class="token punctuation">(</span>task<span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">trigger_failure_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">,</span> error<span class="token punctuation">:</span> Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""触发失败告警"""</span>
        alert_message <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'task_failure'</span><span class="token punctuation">,</span>
            <span class="token string">'severity'</span><span class="token punctuation">:</span> <span class="token string">'high'</span><span class="token punctuation">,</span>
            <span class="token string">'task_id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>task_id<span class="token punctuation">,</span>
            <span class="token string">'workflow_id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">,</span>
            <span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'timestamp'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment"># 发送告警（这里可以集成到Slack、Email等）</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ALERT: Task </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>task_id<span class="token punctuation">}</span></span><span class="token string"> failed: </span><span class="token interpolation"><span class="token punctuation">{</span>error<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_balance_load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""负载均衡"""</span>
        <span class="token comment"># 检查是否需要重新分配任务</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">)</span> <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span><span class="token string">'concurrent_workflows'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">:</span>
            <span class="token comment"># 负载过高，可能需要迁移任务</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>migrate_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">migrate_tasks</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""迁移任务到其他节点（分布式环境下）"""</span>
        <span class="token comment"># 这里可以实现任务迁移逻辑</span>
        <span class="token keyword">pass</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_check_timeouts</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查超时任务"""</span>
        now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        timeout_tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> task_id<span class="token punctuation">,</span> slot <span class="token keyword">in</span> self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 计算运行时间</span>
            runtime <span class="token operator">=</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> slot<span class="token punctuation">.</span>start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span>
            timeout <span class="token operator">=</span> slot<span class="token punctuation">.</span>resources<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>  <span class="token comment"># 默认5分钟</span>
            
            <span class="token keyword">if</span> runtime <span class="token operator">&gt;</span> timeout<span class="token punctuation">:</span>
                timeout_tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
        
        <span class="token comment"># 取消超时任务</span>
        <span class="token keyword">for</span> task_id <span class="token keyword">in</span> timeout_tasks<span class="token punctuation">:</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>cancel_task<span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"timeout"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">cancel_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> reason<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"user_cancelled"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""取消任务"""</span>
        <span class="token keyword">if</span> task_id <span class="token keyword">in</span> self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">:</span>
            slot <span class="token operator">=</span> self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">[</span>task_id<span class="token punctuation">]</span>
            slot<span class="token punctuation">.</span>status <span class="token operator">=</span> TaskStatus<span class="token punctuation">.</span>CANCELLED
            slot<span class="token punctuation">.</span>end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token comment"># TODO: 实际取消正在运行的任务</span>
            <span class="token comment"># 这里需要根据执行器类型调用不同的取消方法</span>
            
            <span class="token comment"># 释放资源</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>release_resources_by_slot<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>
            
            <span class="token comment"># 从运行列表中移除</span>
            <span class="token keyword">del</span> self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">[</span>task_id<span class="token punctuation">]</span>
            
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Cancelled task </span><span class="token interpolation"><span class="token punctuation">{</span>task_id<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>reason<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">release_resources_by_slot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> slot<span class="token punctuation">:</span> ExecutionSlot<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""根据槽位释放资源"""</span>
        <span class="token keyword">for</span> resource<span class="token punctuation">,</span> amount <span class="token keyword">in</span> slot<span class="token punctuation">.</span>resources<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> resource <span class="token keyword">in</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span>resource<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
                    <span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span>resource<span class="token punctuation">]</span> <span class="token operator">-</span> amount
                <span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">_execute_workflow_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Any<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""执行工作流任务（同步版本）"""</span>
        <span class="token comment"># 这里调用Coze API执行工作流</span>
        <span class="token keyword">import</span> requests
        
        workflow_id <span class="token operator">=</span> task<span class="token punctuation">.</span>workflow_id
        data <span class="token operator">=</span> task<span class="token punctuation">.</span>data
        
        <span class="token comment"># 调用Coze API</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'coze_api_url'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">/workflows/</span><span class="token interpolation"><span class="token punctuation">{</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">/execute"</span></span><span class="token punctuation">,</span>
            json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"inputs"</span><span class="token punctuation">:</span> data<span class="token punctuation">}</span><span class="token punctuation">,</span>
            headers<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'coze_api_key'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            timeout<span class="token operator">=</span><span class="token number">300</span>
        <span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"API call failed: </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_execute_async_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task<span class="token punctuation">:</span> ScheduledTask<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Any<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""执行异步任务"""</span>
        <span class="token comment"># 异步执行版本</span>
        <span class="token keyword">import</span> aiohttp
        
        workflow_id <span class="token operator">=</span> task<span class="token punctuation">.</span>workflow_id
        data <span class="token operator">=</span> task<span class="token punctuation">.</span>data
        
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
            <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
                <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'coze_api_url'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">/workflows/</span><span class="token interpolation"><span class="token punctuation">{</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">/execute"</span></span><span class="token punctuation">,</span>
                json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"inputs"</span><span class="token punctuation">:</span> data<span class="token punctuation">}</span><span class="token punctuation">,</span>
                headers<span class="token operator">=</span><span class="token punctuation">{</span>
                    <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'coze_api_key'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                timeout<span class="token operator">=</span>aiohttp<span class="token punctuation">.</span>ClientTimeout<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                
                <span class="token keyword">if</span> response<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    text <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"API call failed: </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">get_system_status</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取系统状态"""</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">'task_queue_size'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>task_queue<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'running_tasks'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>running_tasks<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'completed_tasks'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>completed_tasks<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'failed_tasks'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'resource_usage'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">'current'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">,</span>
                <span class="token string">'limits'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">,</span>
                <span class="token string">'utilization'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    k<span class="token punctuation">:</span> self<span class="token punctuation">.</span>current_resources<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span>k<span class="token punctuation">]</span> 
                    <span class="token keyword">for</span> k <span class="token keyword">in</span> self<span class="token punctuation">.</span>resource_limits 
                    <span class="token keyword">if</span> self<span class="token punctuation">.</span>resource_limits<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'timestamp'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>5.2 冲突检测与解决系统</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># conflict_resolver.py</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Any<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Set<span class="token punctuation">,</span> Tuple
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token punctuation">,</span> field
<span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum
<span class="token keyword">import</span> networkx <span class="token keyword">as</span> nx
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> hashlib

<span class="token keyword">class</span> <span class="token class-name">ConflictType</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    RESOURCE <span class="token operator">=</span> <span class="token string">"resource"</span>
    DATA_DEPENDENCY <span class="token operator">=</span> <span class="token string">"data_dependency"</span>
    TIMING <span class="token operator">=</span> <span class="token string">"timing"</span>
    LOGIC <span class="token operator">=</span> <span class="token string">"logic"</span>
    EXTERNAL <span class="token operator">=</span> <span class="token string">"external"</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Conflict</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""冲突定义"""</span>
    conflict_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    <span class="token builtin">type</span><span class="token punctuation">:</span> ConflictType
    severity<span class="token punctuation">:</span> <span class="token builtin">str</span>  <span class="token comment"># low, medium, high, critical</span>
    description<span class="token punctuation">:</span> <span class="token builtin">str</span>
    involved_tasks<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span>
    detected_at<span class="token punctuation">:</span> datetime
    resolution_strategy<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    resolved_at<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>datetime<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    resolution_details<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ConflictDetector</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""冲突检测器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scheduler<span class="token punctuation">:</span> DistributedScheduler<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>scheduler <span class="token operator">=</span> scheduler
        self<span class="token punctuation">.</span>detected_conflicts<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Conflict<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>resolution_history<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Conflict<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 冲突规则</span>
        self<span class="token punctuation">.</span>conflict_rules <span class="token operator">=</span> self<span class="token punctuation">.</span>load_conflict_rules<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">load_conflict_rules</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""加载冲突规则"""</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"resource_overload"</span><span class="token punctuation">,</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> ConflictType<span class="token punctuation">.</span>RESOURCE<span class="token punctuation">,</span>
                <span class="token string">"condition"</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> status<span class="token punctuation">:</span> <span class="token punctuation">(</span>
                    status<span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.9</span> <span class="token keyword">or</span>
                    status<span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'memory'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.9</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"severity"</span><span class="token punctuation">:</span> <span class="token string">"high"</span><span class="token punctuation">,</span>
                <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Resource utilization exceeds 90%"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"task_timeout"</span><span class="token punctuation">,</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> ConflictType<span class="token punctuation">.</span>TIMING<span class="token punctuation">,</span>
                <span class="token string">"condition"</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> tasks<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">.</span>start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">300</span>
                    <span class="token keyword">for</span> t <span class="token keyword">in</span> tasks<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"severity"</span><span class="token punctuation">:</span> <span class="token string">"medium"</span><span class="token punctuation">,</span>
                <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Tasks running longer than 5 minutes"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"circular_dependency"</span><span class="token punctuation">,</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> ConflictType<span class="token punctuation">.</span>LOGIC<span class="token punctuation">,</span>
                <span class="token string">"condition"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>_check_circular_dependencies<span class="token punctuation">,</span>
                <span class="token string">"severity"</span><span class="token punctuation">:</span> <span class="token string">"critical"</span><span class="token punctuation">,</span>
                <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Circular dependencies detected in workflow"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"data_contention"</span><span class="token punctuation">,</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> ConflictType<span class="token punctuation">.</span>DATA_DEPENDENCY<span class="token punctuation">,</span>
                <span class="token string">"condition"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>_check_data_contention<span class="token punctuation">,</span>
                <span class="token string">"severity"</span><span class="token punctuation">:</span> <span class="token string">"high"</span><span class="token punctuation">,</span>
                <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Multiple tasks accessing same data source"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_conflicts</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Conflict<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检测冲突"""</span>
        detected <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 获取当前系统状态</span>
        system_status <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>get_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
        running_tasks <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks
        
        <span class="token comment"># 应用冲突规则</span>
        <span class="token keyword">for</span> rule <span class="token keyword">in</span> self<span class="token punctuation">.</span>conflict_rules<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> rule<span class="token punctuation">[</span><span class="token string">"condition"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>system_status <span class="token keyword">if</span> rule<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> ConflictType<span class="token punctuation">.</span>RESOURCE <span class="token keyword">else</span> running_tasks<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    conflict_id <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>
                        <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>rule<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    
                    conflict <span class="token operator">=</span> Conflict<span class="token punctuation">(</span>
                        conflict_id<span class="token operator">=</span>conflict_id<span class="token punctuation">,</span>
                        <span class="token builtin">type</span><span class="token operator">=</span>rule<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        severity<span class="token operator">=</span>rule<span class="token punctuation">[</span><span class="token string">"severity"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        description<span class="token operator">=</span>rule<span class="token punctuation">[</span><span class="token string">"description"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        involved_tasks<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>running_tasks<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        detected_at<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
                    
                    self<span class="token punctuation">.</span>detected_conflicts<span class="token punctuation">[</span>conflict_id<span class="token punctuation">]</span> <span class="token operator">=</span> conflict
                    detected<span class="token punctuation">.</span>append<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
                    
                    <span class="token comment"># 触发冲突处理</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>handle_conflict<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
                    
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error applying conflict rule </span><span class="token interpolation"><span class="token punctuation">{</span>rule<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> detected
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">handle_conflict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> conflict<span class="token punctuation">:</span> Conflict<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""处理冲突"""</span>
        resolver <span class="token operator">=</span> ConflictResolver<span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">)</span>
        
        <span class="token comment"># 根据冲突类型选择解决策略</span>
        <span class="token keyword">if</span> conflict<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> ConflictType<span class="token punctuation">.</span>RESOURCE<span class="token punctuation">:</span>
            resolution <span class="token operator">=</span> <span class="token keyword">await</span> resolver<span class="token punctuation">.</span>resolve_resource_conflict<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> conflict<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> ConflictType<span class="token punctuation">.</span>DATA_DEPENDENCY<span class="token punctuation">:</span>
            resolution <span class="token operator">=</span> <span class="token keyword">await</span> resolver<span class="token punctuation">.</span>resolve_data_conflict<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> conflict<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> ConflictType<span class="token punctuation">.</span>TIMING<span class="token punctuation">:</span>
            resolution <span class="token operator">=</span> <span class="token keyword">await</span> resolver<span class="token punctuation">.</span>resolve_timing_conflict<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> conflict<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> ConflictType<span class="token punctuation">.</span>LOGIC<span class="token punctuation">:</span>
            resolution <span class="token operator">=</span> <span class="token keyword">await</span> resolver<span class="token punctuation">.</span>resolve_logic_conflict<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            resolution <span class="token operator">=</span> <span class="token keyword">await</span> resolver<span class="token punctuation">.</span>resolve_generic_conflict<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
        
        <span class="token comment"># 更新冲突状态</span>
        conflict<span class="token punctuation">.</span>resolution_strategy <span class="token operator">=</span> resolution<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"strategy"</span><span class="token punctuation">)</span>
        conflict<span class="token punctuation">.</span>resolved_at <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        conflict<span class="token punctuation">.</span>resolution_details <span class="token operator">=</span> resolution
        
        <span class="token comment"># 记录解决历史</span>
        self<span class="token punctuation">.</span>resolution_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>conflict<span class="token punctuation">)</span>
        
        <span class="token comment"># 从当前冲突列表中移除</span>
        <span class="token keyword">if</span> conflict<span class="token punctuation">.</span>conflict_id <span class="token keyword">in</span> self<span class="token punctuation">.</span>detected_conflicts<span class="token punctuation">:</span>
            <span class="token keyword">del</span> self<span class="token punctuation">.</span>detected_conflicts<span class="token punctuation">[</span>conflict<span class="token punctuation">.</span>conflict_id<span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">_check_circular_dependencies</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tasks<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查循环依赖"""</span>
        <span class="token comment"># 构建依赖图</span>
        G <span class="token operator">=</span> nx<span class="token punctuation">.</span>DiGraph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> task_id<span class="token punctuation">,</span> task <span class="token keyword">in</span> tasks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            G<span class="token punctuation">.</span>add_node<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
            
            <span class="token comment"># 添加依赖边</span>
            depends_on <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'depends_on'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>depends_on<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                depends_on <span class="token operator">=</span> <span class="token punctuation">[</span>depends_on<span class="token punctuation">]</span>
            
            <span class="token keyword">for</span> dep <span class="token keyword">in</span> depends_on<span class="token punctuation">:</span>
                <span class="token keyword">if</span> dep <span class="token keyword">in</span> tasks<span class="token punctuation">:</span>
                    G<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>dep<span class="token punctuation">,</span> task_id<span class="token punctuation">)</span>
        
        <span class="token comment"># 检查循环</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            cycles <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>nx<span class="token punctuation">.</span>simple_cycles<span class="token punctuation">(</span>G<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cycles<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
    
    <span class="token keyword">def</span> <span class="token function">_check_data_contention</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tasks<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查数据争用"""</span>
        <span class="token comment"># 跟踪数据源访问</span>
        data_source_access <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        
        <span class="token keyword">for</span> task_id<span class="token punctuation">,</span> slot <span class="token keyword">in</span> tasks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            data_sources <span class="token operator">=</span> slot<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'data_sources'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token keyword">for</span> source <span class="token keyword">in</span> data_sources<span class="token punctuation">:</span>
                <span class="token keyword">if</span> source <span class="token keyword">not</span> <span class="token keyword">in</span> data_source_access<span class="token punctuation">:</span>
                    data_source_access<span class="token punctuation">[</span>source<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                data_source_access<span class="token punctuation">[</span>source<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
        
        <span class="token comment"># 检查是否存在多个任务访问同一数据源</span>
        <span class="token keyword">for</span> source<span class="token punctuation">,</span> accessing_tasks <span class="token keyword">in</span> data_source_access<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>accessing_tasks<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
                <span class="token comment"># 检查访问模式</span>
                access_modes <span class="token operator">=</span> <span class="token punctuation">[</span>
                    t<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'access_mode'</span><span class="token punctuation">,</span> <span class="token string">'read'</span><span class="token punctuation">)</span> 
                    <span class="token keyword">for</span> t <span class="token keyword">in</span> accessing_tasks
                <span class="token punctuation">]</span>
                
                <span class="token comment"># 如果存在写操作，则可能产生冲突</span>
                <span class="token keyword">if</span> <span class="token string">'write'</span> <span class="token keyword">in</span> access_modes<span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token boolean">True</span>
        
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">class</span> <span class="token class-name">ConflictResolver</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""冲突解决器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scheduler<span class="token punctuation">:</span> DistributedScheduler<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>scheduler <span class="token operator">=</span> scheduler
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">resolve_resource_conflict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> conflict<span class="token punctuation">:</span> Conflict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解决资源冲突"""</span>
        resolution_strategy <span class="token operator">=</span> <span class="token boolean">None</span>
        actions_taken <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 检查当前资源使用情况</span>
        status <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>get_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
        utilization <span class="token operator">=</span> status<span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 根据资源类型采取不同策略</span>
        <span class="token keyword">if</span> utilization<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.9</span><span class="token punctuation">:</span>
            resolution_strategy <span class="token operator">=</span> <span class="token string">"throttle_cpu_intensive_tasks"</span>
            actions_taken <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>throttle_cpu_intensive_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
        <span class="token keyword">elif</span> utilization<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'memory'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.9</span><span class="token punctuation">:</span>
            resolution_strategy <span class="token operator">=</span> <span class="token string">"limit_batch_sizes"</span>
            actions_taken <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>limit_batch_sizes<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
        <span class="token keyword">elif</span> utilization<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'concurrent_workflows'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.9</span><span class="token punctuation">:</span>
            resolution_strategy <span class="token operator">=</span> <span class="token string">"delay_low_priority_tasks"</span>
            actions_taken <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>delay_low_priority_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"strategy"</span><span class="token punctuation">:</span> resolution_strategy<span class="token punctuation">,</span>
            <span class="token string">"actions_taken"</span><span class="token punctuation">:</span> actions_taken<span class="token punctuation">,</span>
            <span class="token string">"conflict_id"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>conflict_id<span class="token punctuation">,</span>
            <span class="token string">"resolved_at"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">throttle_cpu_intensive_tasks</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""限制CPU密集型任务"""</span>
        actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 识别CPU密集型任务</span>
        cpu_intensive_tasks <span class="token operator">=</span> <span class="token punctuation">[</span>
            task_id <span class="token keyword">for</span> task_id<span class="token punctuation">,</span> slot <span class="token keyword">in</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> slot<span class="token punctuation">.</span>resources<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2.0</span>
        <span class="token punctuation">]</span>
        
        <span class="token comment"># 对任务进行节流</span>
        <span class="token keyword">for</span> task_id <span class="token keyword">in</span> cpu_intensive_tasks<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># 限制前两个最耗CPU的任务</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>cancel_task<span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"resource_throttling"</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 重新调度，但降低优先级</span>
            task <span class="token operator">=</span> self<span class="token punctuation">.</span>find_original_task<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
            <span class="token keyword">if</span> task<span class="token punctuation">:</span>
                task<span class="token punctuation">.</span>priority <span class="token operator">=</span> TaskPriority<span class="token punctuation">.</span>LOW<span class="token punctuation">.</span>value
                task<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
                heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">,</span> task<span class="token punctuation">)</span>
                
                actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"throttled_task"</span><span class="token punctuation">,</span>
                    <span class="token string">"task_id"</span><span class="token punctuation">:</span> task_id<span class="token punctuation">,</span>
                    <span class="token string">"new_priority"</span><span class="token punctuation">:</span> <span class="token string">"LOW"</span><span class="token punctuation">,</span>
                    <span class="token string">"delayed_until"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>scheduled_time<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> actions
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">limit_batch_sizes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""限制批处理大小"""</span>
        actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 调整待处理任务的批处理大小</span>
        <span class="token keyword">for</span> task <span class="token keyword">in</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">:</span>
            <span class="token keyword">if</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'batch_size'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">:</span>
                <span class="token comment"># 减少批处理大小</span>
                original_size <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'batch_size'</span><span class="token punctuation">]</span>
                task<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'batch_size'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> original_size <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span>
                
                actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"reduced_batch_size"</span><span class="token punctuation">,</span>
                    <span class="token string">"task_id"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>task_id<span class="token punctuation">,</span>
                    <span class="token string">"original_size"</span><span class="token punctuation">:</span> original_size<span class="token punctuation">,</span>
                    <span class="token string">"new_size"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'batch_size'</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> actions
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">delay_low_priority_tasks</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""延迟低优先级任务"""</span>
        actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 找到低优先级任务并延迟</span>
        <span class="token keyword">for</span> task <span class="token keyword">in</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">:</span>
            <span class="token keyword">if</span> task<span class="token punctuation">.</span>priority <span class="token operator">&gt;=</span> TaskPriority<span class="token punctuation">.</span>LOW<span class="token punctuation">.</span>value<span class="token punctuation">:</span>
                original_time <span class="token operator">=</span> task<span class="token punctuation">.</span>scheduled_time
                task<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
                
                actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"delayed_task"</span><span class="token punctuation">,</span>
                    <span class="token string">"task_id"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>task_id<span class="token punctuation">,</span>
                    <span class="token string">"original_schedule"</span><span class="token punctuation">:</span> original_time<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">"new_schedule"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>scheduled_time<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">"delay_reason"</span><span class="token punctuation">:</span> <span class="token string">"high_system_load"</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 重新排序队列</span>
        heapq<span class="token punctuation">.</span>heapify<span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> actions
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">resolve_data_conflict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> conflict<span class="token punctuation">:</span> Conflict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解决数据冲突"""</span>
        <span class="token comment"># 识别冲突的数据源</span>
        conflicting_tasks <span class="token operator">=</span> conflict<span class="token punctuation">.</span>involved_tasks
        
        <span class="token comment"># 实施锁机制</span>
        locked_resources <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> task_id <span class="token keyword">in</span> conflicting_tasks<span class="token punctuation">:</span>
            slot <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">.</span>get<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
            <span class="token keyword">if</span> slot<span class="token punctuation">:</span>
                data_sources <span class="token operator">=</span> slot<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'data_sources'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                
                <span class="token keyword">for</span> source <span class="token keyword">in</span> data_sources<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> source <span class="token keyword">not</span> <span class="token keyword">in</span> locked_resources<span class="token punctuation">:</span>
                        <span class="token comment"># 获取锁</span>
                        lock_acquired <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>acquire_data_lock<span class="token punctuation">(</span>source<span class="token punctuation">,</span> task_id<span class="token punctuation">)</span>
                        
                        <span class="token keyword">if</span> lock_acquired<span class="token punctuation">:</span>
                            locked_resources<span class="token punctuation">.</span>add<span class="token punctuation">(</span>source<span class="token punctuation">)</span>
                            actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"acquired_lock"</span><span class="token punctuation">,</span>
                                <span class="token string">"resource"</span><span class="token punctuation">:</span> source<span class="token punctuation">,</span>
                                <span class="token string">"task_id"</span><span class="token punctuation">:</span> task_id
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            <span class="token comment"># 等待锁释放</span>
                            <span class="token keyword">await</span> self<span class="token punctuation">.</span>wait_for_resource<span class="token punctuation">(</span>source<span class="token punctuation">,</span> task_id<span class="token punctuation">)</span>
                            actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"waiting_for_lock"</span><span class="token punctuation">,</span>
                                <span class="token string">"resource"</span><span class="token punctuation">:</span> source<span class="token punctuation">,</span>
                                <span class="token string">"task_id"</span><span class="token punctuation">:</span> task_id
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"strategy"</span><span class="token punctuation">:</span> <span class="token string">"distributed_locking"</span><span class="token punctuation">,</span>
            <span class="token string">"actions_taken"</span><span class="token punctuation">:</span> actions<span class="token punctuation">,</span>
            <span class="token string">"conflict_id"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>conflict_id
        <span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">acquire_data_lock</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> resource<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> task_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取数据锁"""</span>
        lock_key <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data_lock:</span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        <span class="token comment"># 使用Redis实现分布式锁</span>
        lock_value <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        acquired <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>redis_client<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>
            lock_key<span class="token punctuation">,</span>
            lock_value<span class="token punctuation">,</span>
            nx<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            ex<span class="token operator">=</span><span class="token number">300</span>  <span class="token comment"># 5分钟超时</span>
        <span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> acquired<span class="token punctuation">:</span>
            <span class="token comment"># 记录锁的所有者</span>
            self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>redis_client<span class="token punctuation">.</span>hset<span class="token punctuation">(</span>
                <span class="token string-interpolation"><span class="token string">f"lock_owners:</span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                task_id<span class="token punctuation">,</span>
                lock_value
            <span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">wait_for_resource</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> resource<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> task_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""等待资源"""</span>
        <span class="token comment"># 将任务标记为等待状态</span>
        <span class="token keyword">if</span> task_id <span class="token keyword">in</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">:</span>
            slot <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">[</span>task_id<span class="token punctuation">]</span>
            slot<span class="token punctuation">.</span>status <span class="token operator">=</span> TaskStatus<span class="token punctuation">.</span>PENDING  <span class="token comment"># 临时状态</span>
        
        <span class="token comment"># 调度重试</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># 等待5秒后重试</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">resolve_timing_conflict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> conflict<span class="token punctuation">:</span> Conflict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解决时间冲突"""</span>
        actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 检查超时任务</span>
        <span class="token keyword">for</span> task_id <span class="token keyword">in</span> conflict<span class="token punctuation">.</span>involved_tasks<span class="token punctuation">:</span>
            slot <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">.</span>get<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
            <span class="token keyword">if</span> slot<span class="token punctuation">:</span>
                runtime <span class="token operator">=</span> <span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> slot<span class="token punctuation">.</span>start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> runtime <span class="token operator">&gt;</span> <span class="token number">300</span><span class="token punctuation">:</span>  <span class="token comment"># 5分钟</span>
                    <span class="token comment"># 取消并重新调度</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>cancel_task<span class="token punctuation">(</span>task_id<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"timeout"</span><span class="token punctuation">)</span>
                    
                    <span class="token comment"># 使用指数退避重新调度</span>
                    task <span class="token operator">=</span> self<span class="token punctuation">.</span>find_original_task<span class="token punctuation">(</span>task_id<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> task<span class="token punctuation">:</span>
                        retry_count <span class="token operator">=</span> task<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'retry_count'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        delay <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> retry_count <span class="token operator">*</span> <span class="token number">60</span>  <span class="token comment"># 指数退避，单位秒</span>
                        
                        task<span class="token punctuation">.</span>scheduled_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span>delay<span class="token punctuation">)</span>
                        task<span class="token punctuation">.</span>metadata<span class="token punctuation">[</span><span class="token string">'retry_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> retry_count <span class="token operator">+</span> <span class="token number">1</span>
                        
                        heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">,</span> task<span class="token punctuation">)</span>
                        
                        actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"rescheduled_timeout_task"</span><span class="token punctuation">,</span>
                            <span class="token string">"task_id"</span><span class="token punctuation">:</span> task_id<span class="token punctuation">,</span>
                            <span class="token string">"retry_count"</span><span class="token punctuation">:</span> retry_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
                            <span class="token string">"next_attempt"</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>scheduled_time<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"strategy"</span><span class="token punctuation">:</span> <span class="token string">"timeout_rescheduling"</span><span class="token punctuation">,</span>
            <span class="token string">"actions_taken"</span><span class="token punctuation">:</span> actions<span class="token punctuation">,</span>
            <span class="token string">"conflict_id"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>conflict_id
        <span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">resolve_logic_conflict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> conflict<span class="token punctuation">:</span> Conflict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解决逻辑冲突"""</span>
        actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 对于循环依赖，需要打破循环</span>
        <span class="token keyword">if</span> <span class="token string">"circular_dependency"</span> <span class="token keyword">in</span> conflict<span class="token punctuation">.</span>description<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 识别循环中的任务</span>
            cycle_tasks <span class="token operator">=</span> conflict<span class="token punctuation">.</span>involved_tasks
            
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cycle_tasks<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token comment"># 取消循环中的一个任务以打破循环</span>
                task_to_cancel <span class="token operator">=</span> cycle_tasks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>cancel_task<span class="token punctuation">(</span>task_to_cancel<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"break_cycle"</span><span class="token punctuation">)</span>
                
                actions<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"broke_circular_dependency"</span><span class="token punctuation">,</span>
                    <span class="token string">"cancelled_task"</span><span class="token punctuation">:</span> task_to_cancel<span class="token punctuation">,</span>
                    <span class="token string">"remaining_tasks"</span><span class="token punctuation">:</span> cycle_tasks<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"strategy"</span><span class="token punctuation">:</span> <span class="token string">"cycle_breaking"</span><span class="token punctuation">,</span>
            <span class="token string">"actions_taken"</span><span class="token punctuation">:</span> actions<span class="token punctuation">,</span>
            <span class="token string">"conflict_id"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>conflict_id
        <span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">resolve_generic_conflict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> conflict<span class="token punctuation">:</span> Conflict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解决通用冲突"""</span>
        <span class="token comment"># 默认策略：记录并告警</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Unresolved conflict: </span><span class="token interpolation"><span class="token punctuation">{</span>conflict<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"strategy"</span><span class="token punctuation">:</span> <span class="token string">"alert_only"</span><span class="token punctuation">,</span>
            <span class="token string">"actions_taken"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"logged_conflict"</span><span class="token punctuation">,</span>
                    <span class="token string">"conflict_id"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>conflict_id<span class="token punctuation">,</span>
                    <span class="token string">"severity"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>severity
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"conflict_id"</span><span class="token punctuation">:</span> conflict<span class="token punctuation">.</span>conflict_id
        <span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">find_original_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> task_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Optional<span class="token punctuation">[</span>Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""查找原始任务"""</span>
        <span class="token comment"># 在实际系统中，这里需要从持久化存储中查找任务</span>
        <span class="token comment"># 这里简化处理</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>六、完整的主控系统</span></h2><h3><span>6.1 主控制器</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># main_controller.py</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> signal
<span class="token keyword">import</span> sys
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Any
<span class="token keyword">import</span> yaml
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> logging<span class="token punctuation">.</span>handlers <span class="token keyword">import</span> RotatingFileHandler
<span class="token keyword">import</span> json

<span class="token keyword">from</span> incremental_detector <span class="token keyword">import</span> HybridIncrementalDetector
<span class="token keyword">from</span> workflow_generator <span class="token keyword">import</span> WorkflowGenerator
<span class="token keyword">from</span> scheduler <span class="token keyword">import</span> DistributedScheduler
<span class="token keyword">from</span> conflict_resolver <span class="token keyword">import</span> ConflictDetector
<span class="token keyword">from</span> incremental_manager <span class="token keyword">import</span> IncrementalStateManager

<span class="token keyword">class</span> <span class="token class-name">CozeAutomationController</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Coze自动化主控制器"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config_path<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"config/master.yaml"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 加载配置</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>config_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>config <span class="token operator">=</span> yaml<span class="token punctuation">.</span>safe_load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        
        <span class="token comment"># 设置日志</span>
        self<span class="token punctuation">.</span>setup_logging<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 初始化组件</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Initializing Coze Automation Controller..."</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 增量检测器</span>
        self<span class="token punctuation">.</span>incremental_detector <span class="token operator">=</span> HybridIncrementalDetector<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'incremental_processing'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 工作流生成器</span>
        self<span class="token punctuation">.</span>workflow_generator <span class="token operator">=</span> WorkflowGenerator<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'workflow_generation'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'template_repository'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'path'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 调度器</span>
        self<span class="token punctuation">.</span>scheduler <span class="token operator">=</span> DistributedScheduler<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'batch_processing'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        
        <span class="token comment"># 冲突检测器</span>
        self<span class="token punctuation">.</span>conflict_detector <span class="token operator">=</span> ConflictDetector<span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">)</span>
        
        <span class="token comment"># 状态管理器</span>
        self<span class="token punctuation">.</span>state_manager <span class="token operator">=</span> IncrementalStateManager<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 监控任务</span>
        self<span class="token punctuation">.</span>monitoring_tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 运行标志</span>
        self<span class="token punctuation">.</span>running <span class="token operator">=</span> <span class="token boolean">False</span>
        
        <span class="token comment"># 注册信号处理</span>
        self<span class="token punctuation">.</span>setup_signal_handlers<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">setup_logging</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""设置日志"""</span>
        log_config <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logging'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 创建logger</span>
        self<span class="token punctuation">.</span>logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">'CozeAutomation'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>logging<span class="token punctuation">,</span> log_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'level'</span><span class="token punctuation">,</span> <span class="token string">'INFO'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 文件处理器</span>
        file_handler <span class="token operator">=</span> RotatingFileHandler<span class="token punctuation">(</span>
            log_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">'coze_automation.log'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            maxBytes<span class="token operator">=</span>log_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_size_mb'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
            backupCount<span class="token operator">=</span>log_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'backup_count'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        file_handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">(</span>
            <span class="token string">'%(asctime)s - %(name)s - %(levelname)s - %(module)s - %(message)s'</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 控制台处理器</span>
        console_handler <span class="token operator">=</span> logging<span class="token punctuation">.</span>StreamHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>
        console_handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">(</span>
            <span class="token string">'%(asctime)s - %(levelname)s - %(message)s'</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>file_handler<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>console_handler<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">setup_signal_handlers</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""设置信号处理器"""</span>
        signal<span class="token punctuation">.</span>signal<span class="token punctuation">(</span>signal<span class="token punctuation">.</span>SIGINT<span class="token punctuation">,</span> self<span class="token punctuation">.</span>handle_shutdown<span class="token punctuation">)</span>
        signal<span class="token punctuation">.</span>signal<span class="token punctuation">(</span>signal<span class="token punctuation">.</span>SIGTERM<span class="token punctuation">,</span> self<span class="token punctuation">.</span>handle_shutdown<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">handle_shutdown</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> signum<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""处理关闭信号"""</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Received signal </span><span class="token interpolation"><span class="token punctuation">{</span>signum<span class="token punctuation">}</span></span><span class="token string">, shutting down..."</span></span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>running <span class="token operator">=</span> <span class="token boolean">False</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""运行主循环"""</span>
        self<span class="token punctuation">.</span>running <span class="token operator">=</span> <span class="token boolean">True</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Starting Coze Automation Controller"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 启动监控任务</span>
        self<span class="token punctuation">.</span>start_monitoring_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 主处理循环</span>
        <span class="token keyword">while</span> self<span class="token punctuation">.</span>running<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>process_cycle<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cycle_interval'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error in main loop: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>  <span class="token comment"># 错误后等待30秒</span>
        
        <span class="token comment"># 清理</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">process_cycle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""处理周期"""</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Starting processing cycle"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 1. 检测增量数据</span>
        data_batches <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>detect_incremental_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> data_batches<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"No incremental data detected"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Detected </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_batches<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> data batches"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 2. 为每个批次生成工作流</span>
        workflows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> batch <span class="token keyword">in</span> data_batches<span class="token punctuation">:</span>
            workflow <span class="token operator">=</span> self<span class="token punctuation">.</span>generate_workflow_for_batch<span class="token punctuation">(</span>batch<span class="token punctuation">)</span>
            <span class="token keyword">if</span> workflow<span class="token punctuation">:</span>
                workflows<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>batch<span class="token punctuation">,</span> workflow<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 3. 调度工作流执行</span>
        <span class="token keyword">for</span> batch<span class="token punctuation">,</span> workflow <span class="token keyword">in</span> workflows<span class="token punctuation">:</span>
            <span class="token keyword">await</span> self<span class="token punctuation">.</span>schedule_workflow_execution<span class="token punctuation">(</span>batch<span class="token punctuation">,</span> workflow<span class="token punctuation">)</span>
        
        <span class="token comment"># 4. 检测和解决冲突</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>detect_and_resolve_conflicts<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 5. 更新状态</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>update_processing_state<span class="token punctuation">(</span>data_batches<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_incremental_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检测增量数据"""</span>
        data_sources <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'data_sources'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'configurations'</span><span class="token punctuation">]</span>
        all_batches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> source_config <span class="token keyword">in</span> data_sources<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                source_name <span class="token operator">=</span> source_config<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Checking incremental data for </span><span class="token interpolation"><span class="token punctuation">{</span>source_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                batches <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>incremental_detector<span class="token punctuation">.</span>detect_incremental_data<span class="token punctuation">(</span>source_config<span class="token punctuation">)</span>
                all_batches<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>batches<span class="token punctuation">)</span>
                
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>batches<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> batches from </span><span class="token interpolation"><span class="token punctuation">{</span>source_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error detecting data from </span><span class="token interpolation"><span class="token punctuation">{</span>source_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
        
        <span class="token keyword">return</span> all_batches
    
    <span class="token keyword">def</span> <span class="token function">generate_workflow_for_batch</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Optional<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""为数据批次生成工作流"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 确定工作流类型</span>
            workflow_type <span class="token operator">=</span> self<span class="token punctuation">.</span>determine_workflow_type<span class="token punctuation">(</span>data_batch<span class="token punctuation">)</span>
            
            <span class="token comment"># 生成工作流</span>
            workflow_config <span class="token operator">=</span> self<span class="token punctuation">.</span>workflow_generator<span class="token punctuation">.</span>generate_workflow_from_batch<span class="token punctuation">(</span>
                data_batch<span class="token punctuation">,</span> workflow_type
            <span class="token punctuation">)</span>
            
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Generated workflow for batch </span><span class="token interpolation"><span class="token punctuation">{</span>data_batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> workflow_config
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error generating workflow: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">determine_workflow_type</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""确定工作流类型"""</span>
        data_type <span class="token operator">=</span> data_batch<span class="token punctuation">.</span>source_type<span class="token punctuation">.</span>value
        
        type_mapping <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'structured'</span><span class="token punctuation">:</span> <span class="token string">'structured_data_processing'</span><span class="token punctuation">,</span>
            <span class="token string">'unstructured'</span><span class="token punctuation">:</span> <span class="token string">'unstructured_text_processing'</span><span class="token punctuation">,</span>
            <span class="token string">'streaming'</span><span class="token punctuation">:</span> <span class="token string">'streaming_processing'</span><span class="token punctuation">,</span>
            <span class="token string">'batch'</span><span class="token punctuation">:</span> <span class="token string">'batch_etl'</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">return</span> type_mapping<span class="token punctuation">.</span>get<span class="token punctuation">(</span>data_type<span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">schedule_workflow_execution</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> Any<span class="token punctuation">,</span> workflow_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""调度工作流执行"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 1. 在Coze平台创建工作流</span>
            workflow_id <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>create_workflow_on_coze<span class="token punctuation">(</span>workflow_config<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> <span class="token keyword">not</span> workflow_id<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to create workflow for batch </span><span class="token interpolation"><span class="token punctuation">{</span>data_batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            
            <span class="token comment"># 2. 创建调度任务</span>
            task <span class="token operator">=</span> self<span class="token punctuation">.</span>create_schedule_task<span class="token punctuation">(</span>data_batch<span class="token punctuation">,</span> workflow_id<span class="token punctuation">,</span> workflow_config<span class="token punctuation">)</span>
            
            <span class="token comment"># 3. 调度任务</span>
            task_id <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>schedule_task<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
            
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Scheduled task </span><span class="token interpolation"><span class="token punctuation">{</span>task_id<span class="token punctuation">}</span></span><span class="token string"> for workflow </span><span class="token interpolation"><span class="token punctuation">{</span>workflow_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error scheduling workflow: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">create_workflow_on_coze</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> workflow_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""在Coze平台创建工作流"""</span>
        <span class="token keyword">import</span> aiohttp
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
                <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
                    <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'coze_platform'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'base_url'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">/v1/workflows"</span></span><span class="token punctuation">,</span>
                    json<span class="token operator">=</span>workflow_config<span class="token punctuation">,</span>
                    headers<span class="token operator">=</span><span class="token punctuation">{</span>
                        <span class="token string">"Authorization"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Bearer </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'coze_platform'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'authentication'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api_key'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>
                        <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                    
                    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">201</span><span class="token punctuation">:</span>
                        result <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> result<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'workflow_id'</span><span class="token punctuation">)</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        error_text <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to create workflow: </span><span class="token interpolation"><span class="token punctuation">{</span>error_text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> <span class="token boolean">None</span>
                        
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error creating workflow on Coze: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">create_schedule_task</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> Any<span class="token punctuation">,</span> workflow_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> 
                            workflow_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Any<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""创建调度任务"""</span>
        <span class="token keyword">from</span> scheduler <span class="token keyword">import</span> ScheduledTask<span class="token punctuation">,</span> TaskPriority
        
        task_id <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"task_</span><span class="token interpolation"><span class="token punctuation">{</span>data_batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d%H%M%S'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        <span class="token comment"># 确定优先级</span>
        priority <span class="token operator">=</span> self<span class="token punctuation">.</span>calculate_task_priority<span class="token punctuation">(</span>data_batch<span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> ScheduledTask<span class="token punctuation">(</span>
            priority<span class="token operator">=</span>priority<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
            scheduled_time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            task_id<span class="token operator">=</span>task_id<span class="token punctuation">,</span>
            workflow_id<span class="token operator">=</span>workflow_id<span class="token punctuation">,</span>
            batch_id<span class="token operator">=</span>data_batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">,</span>
            data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"batch"</span><span class="token punctuation">:</span> data_batch<span class="token punctuation">.</span>data<span class="token punctuation">}</span><span class="token punctuation">,</span>
            metadata<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">"batch_metadata"</span><span class="token punctuation">:</span> data_batch<span class="token punctuation">.</span>metadata<span class="token punctuation">,</span>
                <span class="token string">"workflow_type"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>determine_workflow_type<span class="token punctuation">(</span>data_batch<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"data_size"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data_batch<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"priority"</span><span class="token punctuation">:</span> priority<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                <span class="token string">"created_at"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">calculate_task_priority</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Any<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算任务优先级"""</span>
        <span class="token keyword">from</span> scheduler <span class="token keyword">import</span> TaskPriority
        
        <span class="token comment"># 基于数据批次属性确定优先级</span>
        priority_rules <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'priority_rules'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> rule <span class="token keyword">in</span> priority_rules<span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>evaluate_priority_rule<span class="token punctuation">(</span>rule<span class="token punctuation">,</span> data_batch<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>TaskPriority<span class="token punctuation">,</span> rule<span class="token punctuation">[</span><span class="token string">'priority'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 默认优先级</span>
        <span class="token keyword">return</span> TaskPriority<span class="token punctuation">.</span>NORMAL
    
    <span class="token keyword">def</span> <span class="token function">evaluate_priority_rule</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> rule<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span> data_batch<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""评估优先级规则"""</span>
        <span class="token comment"># 这里可以实现规则评估逻辑</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">detect_and_resolve_conflicts</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检测和解决冲突"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            conflicts <span class="token operator">=</span> <span class="token keyword">await</span> self<span class="token punctuation">.</span>conflict_detector<span class="token punctuation">.</span>detect_conflicts<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> conflicts<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Detected </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>conflicts<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> conflicts"</span></span><span class="token punctuation">)</span>
                
                <span class="token comment"># 记录冲突</span>
                <span class="token keyword">for</span> conflict <span class="token keyword">in</span> conflicts<span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>
                        <span class="token string-interpolation"><span class="token string">f"Conflict </span><span class="token interpolation"><span class="token punctuation">{</span>conflict<span class="token punctuation">.</span>conflict_id<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>conflict<span class="token punctuation">.</span>description<span class="token punctuation">}</span></span><span class="token string"> "</span></span>
                        <span class="token string-interpolation"><span class="token string">f"(Severity: </span><span class="token interpolation"><span class="token punctuation">{</span>conflict<span class="token punctuation">.</span>severity<span class="token punctuation">}</span></span><span class="token string">)"</span></span>
                    <span class="token punctuation">)</span>
        
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error in conflict detection: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_processing_state</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_batches<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""更新处理状态"""</span>
        <span class="token keyword">for</span> batch <span class="token keyword">in</span> data_batches<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">await</span> self<span class="token punctuation">.</span>state_manager<span class="token punctuation">.</span>update_state<span class="token punctuation">(</span>batch<span class="token punctuation">.</span>incremental_state<span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error updating state for batch </span><span class="token interpolation"><span class="token punctuation">{</span>batch<span class="token punctuation">.</span>batch_id<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">start_monitoring_tasks</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""启动监控任务"""</span>
        <span class="token comment"># 系统状态监控</span>
        status_task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>self<span class="token punctuation">.</span>monitor_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>monitoring_tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>status_task<span class="token punctuation">)</span>
        
        <span class="token comment"># 性能监控</span>
        perf_task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>self<span class="token punctuation">.</span>monitor_performance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>monitoring_tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>perf_task<span class="token punctuation">)</span>
        
        <span class="token comment"># 告警监控</span>
        alert_task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>self<span class="token punctuation">.</span>monitor_alerts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>monitoring_tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>alert_task<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">monitor_system_status</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""监控系统状态"""</span>
        <span class="token keyword">while</span> self<span class="token punctuation">.</span>running<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                status <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>get_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token comment"># 记录状态</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"System status: </span><span class="token interpolation"><span class="token punctuation">{</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>status<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                <span class="token comment"># 检查关键指标</span>
                self<span class="token punctuation">.</span>check_critical_metrics<span class="token punctuation">(</span>status<span class="token punctuation">)</span>
                
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>  <span class="token comment"># 每30秒检查一次</span>
                
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error monitoring system status: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">check_critical_metrics</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> status<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查关键指标"""</span>
        <span class="token comment"># 检查资源使用率</span>
        utilization <span class="token operator">=</span> status<span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> resource<span class="token punctuation">,</span> usage <span class="token keyword">in</span> utilization<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> usage <span class="token operator">&gt;</span> <span class="token number">0.9</span><span class="token punctuation">:</span>  <span class="token comment"># 超过90%</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"High </span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string"> usage: </span><span class="token interpolation"><span class="token punctuation">{</span>usage<span class="token punctuation">:</span><span class="token format-spec">.1%</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> usage <span class="token operator">&gt;</span> <span class="token number">0.95</span><span class="token punctuation">:</span>  <span class="token comment"># 超过95%</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Critical </span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string"> usage: </span><span class="token interpolation"><span class="token punctuation">{</span>usage<span class="token punctuation">:</span><span class="token format-spec">.1%</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token comment"># 触发告警</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">monitor_performance</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""监控性能"""</span>
        <span class="token keyword">while</span> self<span class="token punctuation">.</span>running<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token comment"># 计算性能指标</span>
                metrics <span class="token operator">=</span> self<span class="token punctuation">.</span>calculate_performance_metrics<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token comment"># 记录性能数据</span>
                self<span class="token punctuation">.</span>log_performance_metrics<span class="token punctuation">(</span>metrics<span class="token punctuation">)</span>
                
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>  <span class="token comment"># 每分钟检查一次</span>
                
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error monitoring performance: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">calculate_performance_metrics</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算性能指标"""</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"throughput"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>completed_tasks<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3600</span><span class="token punctuation">,</span>  <span class="token comment"># 任务/小时</span>
            <span class="token string">"success_rate"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>calculate_success_rate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"average_latency"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>calculate_average_latency<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"queue_length"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"active_tasks"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"timestamp"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">calculate_success_rate</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算成功率"""</span>
        total <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>completed_tasks<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> total <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">1.0</span>
        
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>completed_tasks<span class="token punctuation">)</span> <span class="token operator">/</span> total
    
    <span class="token keyword">def</span> <span class="token function">calculate_average_latency</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算平均延迟"""</span>
        completed <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>completed_tasks
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> completed<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">0.0</span>
        
        total_latency <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span>slot<span class="token punctuation">.</span>end_time <span class="token operator">-</span> slot<span class="token punctuation">.</span>start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> slot <span class="token keyword">in</span> completed
        <span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> total_latency <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>completed<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">log_performance_metrics</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> metrics<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""记录性能指标"""</span>
        <span class="token comment"># 这里可以将指标发送到监控系统</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Performance metrics: </span><span class="token interpolation"><span class="token punctuation">{</span>metrics<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">monitor_alerts</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""监控告警"""</span>
        <span class="token keyword">while</span> self<span class="token punctuation">.</span>running<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token comment"># 检查是否有需要发送的告警</span>
                alerts <span class="token operator">=</span> self<span class="token punctuation">.</span>check_for_alerts<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token keyword">for</span> alert <span class="token keyword">in</span> alerts<span class="token punctuation">:</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>send_alert<span class="token punctuation">(</span>alert<span class="token punctuation">)</span>
                
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 每10秒检查一次</span>
                
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error monitoring alerts: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">check_for_alerts</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""检查告警"""</span>
        alerts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># 检查系统状态</span>
        status <span class="token operator">=</span> self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>get_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 资源告警</span>
        utilization <span class="token operator">=</span> status<span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> resource<span class="token punctuation">,</span> usage <span class="token keyword">in</span> utilization<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> usage <span class="token operator">&gt;</span> <span class="token number">0.95</span><span class="token punctuation">:</span>
                alerts<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"resource_critical"</span><span class="token punctuation">,</span>
                    <span class="token string">"severity"</span><span class="token punctuation">:</span> <span class="token string">"critical"</span><span class="token punctuation">,</span>
                    <span class="token string">"resource"</span><span class="token punctuation">:</span> resource<span class="token punctuation">,</span>
                    <span class="token string">"usage"</span><span class="token punctuation">:</span> usage<span class="token punctuation">,</span>
                    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Critical </span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string"> usage: </span><span class="token interpolation"><span class="token punctuation">{</span>usage<span class="token punctuation">:</span><span class="token format-spec">.1%</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 任务失败告警</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">:</span>
            alerts<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"high_failure_rate"</span><span class="token punctuation">,</span>
                <span class="token string">"severity"</span><span class="token punctuation">:</span> <span class="token string">"high"</span><span class="token punctuation">,</span>
                <span class="token string">"failed_count"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"timestamp"</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"High task failure rate: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>failed_tasks<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> failed tasks"</span></span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> alerts
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> alert<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送告警"""</span>
        alert_channels <span class="token operator">=</span> self<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'monitoring_and_alerting'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'alerting'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'channels'</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> channel <span class="token keyword">in</span> alert_channels<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> channel<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'slack'</span><span class="token punctuation">:</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>send_slack_alert<span class="token punctuation">(</span>alert<span class="token punctuation">,</span> channel<span class="token punctuation">)</span>
                <span class="token keyword">elif</span> channel<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'email'</span><span class="token punctuation">:</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>send_email_alert<span class="token punctuation">(</span>alert<span class="token punctuation">,</span> channel<span class="token punctuation">)</span>
                <span class="token keyword">elif</span> channel<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'webhook'</span><span class="token punctuation">:</span>
                    <span class="token keyword">await</span> self<span class="token punctuation">.</span>send_webhook_alert<span class="token punctuation">(</span>alert<span class="token punctuation">,</span> channel<span class="token punctuation">)</span>
                    
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error sending alert via </span><span class="token interpolation"><span class="token punctuation">{</span>channel<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_slack_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> alert<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span> channel_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送Slack告警"""</span>
        <span class="token keyword">import</span> aiohttp
        
        webhook_url <span class="token operator">=</span> channel_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'webhook_url'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> webhook_url<span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        
        message <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"🚨 *Coze Automation Alert* 🚨"</span></span><span class="token punctuation">,</span>
            <span class="token string">"blocks"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"section"</span><span class="token punctuation">,</span>
                    <span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"mrkdwn"</span><span class="token punctuation">,</span>
                        <span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"*Alert Type:* </span><span class="token interpolation"><span class="token punctuation">{</span>alert<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\n*Severity:* </span><span class="token interpolation"><span class="token punctuation">{</span>alert<span class="token punctuation">[</span><span class="token string">'severity'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\n*Message:* </span><span class="token interpolation"><span class="token punctuation">{</span>alert<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"context"</span><span class="token punctuation">,</span>
                    <span class="token string">"elements"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                        <span class="token punctuation">{</span>
                            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"mrkdwn"</span><span class="token punctuation">,</span>
                            <span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Timestamp: </span><span class="token interpolation"><span class="token punctuation">{</span>alert<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
            <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>webhook_url<span class="token punctuation">,</span> json<span class="token operator">=</span>message<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                <span class="token keyword">if</span> response<span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to send Slack alert: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_email_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> alert<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span> channel_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送邮件告警"""</span>
        <span class="token comment"># 实现邮件发送逻辑</span>
        <span class="token keyword">pass</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_webhook_alert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> alert<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">,</span> channel_config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""发送Webhook告警"""</span>
        <span class="token keyword">import</span> aiohttp
        
        endpoints <span class="token operator">=</span> channel_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'endpoints'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> endpoint <span class="token keyword">in</span> endpoints<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
                    <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> json<span class="token operator">=</span>alert<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
                            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to send webhook alert to </span><span class="token interpolation"><span class="token punctuation">{</span>endpoint<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error sending webhook to </span><span class="token interpolation"><span class="token punctuation">{</span>endpoint<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">shutdown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""关闭系统"""</span>
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Shutting down Coze Automation Controller..."</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 取消所有监控任务</span>
        <span class="token keyword">for</span> task <span class="token keyword">in</span> self<span class="token punctuation">.</span>monitoring_tasks<span class="token punctuation">:</span>
            task<span class="token punctuation">.</span>cancel<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 等待任务完成</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>monitoring_tasks<span class="token punctuation">,</span> return_exceptions<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 关闭调度器</span>
        self<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>scheduler_loop_task<span class="token punctuation">.</span>cancel<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 保存状态</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>save_system_state<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"Coze Automation Controller shutdown complete"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">save_system_state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""保存系统状态"""</span>
        <span class="token comment"># 保存增量状态</span>
        <span class="token comment"># 保存调度器状态</span>
        <span class="token comment"># 保存其他组件状态</span>
        <span class="token keyword">pass</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""主函数"""</span>
    <span class="token comment"># 解析命令行参数</span>
    <span class="token keyword">import</span> argparse
    
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'Coze Workflow Automation System'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--config'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'config/master.yaml'</span><span class="token punctuation">,</span>
                       <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Path to configuration file'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--mode'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'run'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token string">'monitor'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       default<span class="token operator">=</span><span class="token string">'run'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Operation mode'</span><span class="token punctuation">)</span>
    
    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 创建控制器</span>
    controller <span class="token operator">=</span> CozeAutomationController<span class="token punctuation">(</span>args<span class="token punctuation">.</span>config<span class="token punctuation">)</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'run'</span><span class="token punctuation">:</span>
            <span class="token keyword">await</span> controller<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'test'</span><span class="token punctuation">:</span>
            <span class="token keyword">await</span> controller<span class="token punctuation">.</span>test_mode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'monitor'</span><span class="token punctuation">:</span>
            <span class="token keyword">await</span> controller<span class="token punctuation">.</span>monitor_mode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nShutting down..."</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Fatal error: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>6.2 部署脚本</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">bash</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># deploy.sh - 部署脚本</span>

<span class="token builtin class-name">set</span> <span class="token parameter variable">-e</span>

<span class="token builtin class-name">echo</span> <span class="token string">"🚀 Deploying Coze Automation System..."</span>

<span class="token comment"># 1. 检查依赖</span>
<span class="token builtin class-name">echo</span> <span class="token string">"📋 Checking dependencies..."</span>
python <span class="token parameter variable">-c</span> <span class="token string">"import yaml, jinja2, aiohttp, redis"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Installing dependencies..."</span>
    pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt
<span class="token punctuation">}</span>

<span class="token comment"># requirements.txt内容：</span>
<span class="token comment"># pyyaml&gt;=6.0</span>
<span class="token comment"># jinja2&gt;=3.1.0</span>
<span class="token comment"># aiohttp&gt;=3.8.0</span>
<span class="token comment"># redis&gt;=4.5.0</span>
<span class="token comment"># networkx&gt;=3.0</span>
<span class="token comment"># sqlalchemy&gt;=2.0.0</span>
<span class="token comment"># psycopg2-binary&gt;=2.9.0</span>
<span class="token comment"># pandas&gt;=2.0.0</span>

<span class="token comment"># 2. 创建目录结构</span>
<span class="token builtin class-name">echo</span> <span class="token string">"📁 Creating directory structure..."</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token punctuation">{</span>logs,templates/nodes,data,output,config,schemas<span class="token punctuation">}</span>

<span class="token comment"># 3. 复制配置文件</span>
<span class="token builtin class-name">echo</span> <span class="token string">"⚙️ Copying configuration files..."</span>
<span class="token function">cp</span> <span class="token parameter variable">-r</span> config_examples/* config/ <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">"No example configs found"</span>

<span class="token comment"># 4. 设置环境变量</span>
<span class="token builtin class-name">echo</span> <span class="token string">"🔧 Setting environment variables..."</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> .env <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">cat</span> <span class="token operator">&gt;</span> .env <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
# Coze API Configuration
COZE_API_KEY=your_api_key_here
COZE_WORKSPACE_ID=your_workspace_id

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=coze_automation
DB_USER=coze_user
DB_PASSWORD=your_password

# Redis Configuration
REDIS_URL=redis://localhost:6379/0

# Monitoring
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...

# Logging
LOG_LEVEL=INFO
EOF</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"⚠️ Please update .env file with your configuration"</span>
<span class="token keyword">fi</span>

<span class="token comment"># 5. 初始化数据库</span>
<span class="token builtin class-name">echo</span> <span class="token string">"🗄️ Initializing database..."</span>
python scripts/init_database.py

<span class="token comment"># 6. 测试连接</span>
<span class="token builtin class-name">echo</span> <span class="token string">"🔗 Testing connections..."</span>
python scripts/test_connections.py

<span class="token comment"># 7. 启动服务</span>
<span class="token builtin class-name">echo</span> <span class="token string">"🚀 Starting services..."</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">==</span> <span class="token string">"production"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token comment"># 生产环境使用systemd或supervisor</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Starting in production mode..."</span>
    <span class="token function">sudo</span> <span class="token function">cp</span> systemd/coze-automation.service /etc/systemd/system/
    <span class="token function">sudo</span> systemctl daemon-reload
    <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> coze-automation
    <span class="token function">sudo</span> systemctl start coze-automation
    <span class="token builtin class-name">echo</span> <span class="token string">"Service started. Check status with: sudo systemctl status coze-automation"</span>
<span class="token keyword">else</span>
    <span class="token comment"># 开发环境直接运行</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Starting in development mode..."</span>
    python main_controller.py <span class="token parameter variable">--config</span> config/master.yaml
<span class="token keyword">fi</span>

<span class="token builtin class-name">echo</span> <span class="token string">"✅ Deployment complete!"</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>6.3 监控仪表板</span></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon" style="margin-right: 4px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">复制</span></span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-text-button ds-text-button--with-icon"><div class="ds-icon ds-atom-button__icon" style="font-size: 16px; width: 16px; height: 16px; margin-right: 3px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.3695 11.411L15.1234 12.8866C14.8869 14.3042 13.6603 15.3436 12.223 15.3436H3.7767C2.33954 15.3434 1.11276 14.3042 0.876312 12.8866L0.630219 11.411L2.05405 11.1747L2.29916 12.6493C2.41969 13.3713 3.04472 13.9001 3.7767 13.9003H12.223C12.9551 13.9002 13.58 13.3713 13.7005 12.6493L13.9456 11.1747L15.3695 11.411ZM8.72202 8.994C8.77714 8.93934 8.83789 8.88106 8.90268 8.81627L12.4828 5.23424L13.5042 6.25572L9.92221 9.8358C9.63947 10.1185 9.3876 10.3732 9.15854 10.5575C8.91889 10.7503 8.6395 10.9224 8.28647 10.9784C8.09708 11.0083 7.9036 11.0083 7.7142 10.9784C7.36103 10.9224 7.08087 10.7503 6.84116 10.5575C6.61212 10.3732 6.36019 10.1185 6.07748 9.8358L2.49643 6.25572L3.51694 5.23424L7.09702 8.81627C7.16216 8.88142 7.22327 8.94006 7.27866 8.99498V1.3065H8.72202V8.994Z" fill="currentColor"></path></svg></div><span><span class="code-info-button-text">下载</span></span><div class="ds-focus-ring"></div></button></div></div></div></div></div><pre><span class="token comment"># dashboard.py</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> jsonify<span class="token punctuation">,</span> Response
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> json
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> plotly<span class="token punctuation">.</span>graph_objects <span class="token keyword">as</span> go
<span class="token keyword">from</span> plotly<span class="token punctuation">.</span>subplots <span class="token keyword">import</span> make_subplots
<span class="token keyword">import</span> threading

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">MonitoringDashboard</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""监控仪表板"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> controller<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>controller <span class="token operator">=</span> controller
        self<span class="token punctuation">.</span>metrics_history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>max_history <span class="token operator">=</span> <span class="token number">1000</span>
        
    <span class="token keyword">def</span> <span class="token function">collect_metrics</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""收集指标"""</span>
        metrics <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'timestamp'</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'system_status'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>get_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'performance'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>calculate_performance_metrics<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'conflicts'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>conflict_detector<span class="token punctuation">.</span>detected_conflicts<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'queue_length'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        self<span class="token punctuation">.</span>metrics_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>metrics<span class="token punctuation">)</span>
        
        <span class="token comment"># 保持历史记录大小</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>metrics_history<span class="token punctuation">)</span> <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>max_history<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>metrics_history <span class="token operator">=</span> self<span class="token punctuation">.</span>metrics_history<span class="token punctuation">[</span><span class="token operator">-</span>self<span class="token punctuation">.</span>max_history<span class="token punctuation">:</span><span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">get_dashboard_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取仪表板数据"""</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>metrics_history<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        
        <span class="token comment"># 转换为DataFrame</span>
        df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>self<span class="token punctuation">.</span>metrics_history<span class="token punctuation">)</span>
        
        <span class="token comment"># 提取关键指标</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'current_status'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>metrics_history<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">'trends'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">'throughput'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>calculate_trend<span class="token punctuation">(</span>df<span class="token punctuation">,</span> <span class="token string">'performance.throughput'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'success_rate'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>calculate_trend<span class="token punctuation">(</span>df<span class="token punctuation">,</span> <span class="token string">'performance.success_rate'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'latency'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>calculate_trend<span class="token punctuation">(</span>df<span class="token punctuation">,</span> <span class="token string">'performance.average_latency'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'alerts'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>get_active_alerts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'resource_usage'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>get_resource_usage<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'task_distribution'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>get_task_distribution<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">return</span> data
    
    <span class="token keyword">def</span> <span class="token function">calculate_trend</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> df<span class="token punctuation">,</span> metric_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算趋势"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 提取指标</span>
            values <span class="token operator">=</span> df<span class="token punctuation">[</span>metric_path<span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token string">'stable'</span>
            
            <span class="token comment"># 简单趋势分析</span>
            recent <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span> <span class="token keyword">else</span> values
            avg <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>recent<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>recent<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> avg <span class="token operator">&gt;</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">1.1</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token string">'increasing'</span>
            <span class="token keyword">elif</span> avg <span class="token operator">&lt;</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token string">'decreasing'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token string">'stable'</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'unknown'</span>
    
    <span class="token keyword">def</span> <span class="token function">get_active_alerts</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取活动告警"""</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>check_for_alerts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">get_resource_usage</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> df<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取资源使用情况"""</span>
        <span class="token keyword">if</span> df<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        
        latest <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">'cpu'</span><span class="token punctuation">:</span> latest<span class="token punctuation">[</span><span class="token string">'system_status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'cpu'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'memory'</span><span class="token punctuation">:</span> latest<span class="token punctuation">[</span><span class="token string">'system_status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'memory'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'concurrent_workflows'</span><span class="token punctuation">:</span> latest<span class="token punctuation">[</span><span class="token string">'system_status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'resource_usage'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'utilization'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'concurrent_workflows'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">get_task_distribution</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""获取任务分布"""</span>
        status <span class="token operator">=</span> self<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>get_system_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">'pending'</span><span class="token punctuation">:</span> status<span class="token punctuation">[</span><span class="token string">'task_queue_size'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">'running'</span><span class="token punctuation">:</span> status<span class="token punctuation">[</span><span class="token string">'running_tasks'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">'completed'</span><span class="token punctuation">:</span> status<span class="token punctuation">[</span><span class="token string">'completed_tasks'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">'failed'</span><span class="token punctuation">:</span> status<span class="token punctuation">[</span><span class="token string">'failed_tasks'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

<span class="token comment"># Flask路由</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""仪表板首页"""</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'dashboard.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/status'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""获取系统状态"""</span>
    data <span class="token operator">=</span> dashboard<span class="token punctuation">.</span>get_dashboard_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/metrics/history'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_metrics_history</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""获取指标历史"""</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dashboard<span class="token punctuation">.</span>metrics_history<span class="token punctuation">)</span>
    
    <span class="token comment"># 转换为JSON格式</span>
    result <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'timestamps'</span><span class="token punctuation">:</span> df<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'throughput'</span><span class="token punctuation">:</span> df<span class="token punctuation">[</span><span class="token string">'performance.throughput'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'success_rate'</span><span class="token punctuation">:</span> df<span class="token punctuation">[</span><span class="token string">'performance.success_rate'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'latency'</span><span class="token punctuation">:</span> df<span class="token punctuation">[</span><span class="token string">'performance.average_latency'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/tasks'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_tasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""获取任务列表"""</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 运行中的任务</span>
    <span class="token keyword">for</span> task_id<span class="token punctuation">,</span> slot <span class="token keyword">in</span> dashboard<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>running_tasks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'id'</span><span class="token punctuation">:</span> task_id<span class="token punctuation">,</span>
            <span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'running'</span><span class="token punctuation">,</span>
            <span class="token string">'workflow_id'</span><span class="token punctuation">:</span> slot<span class="token punctuation">.</span>workflow_id<span class="token punctuation">,</span>
            <span class="token string">'start_time'</span><span class="token punctuation">:</span> slot<span class="token punctuation">.</span>start_time<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'duration'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> slot<span class="token punctuation">.</span>start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'resources'</span><span class="token punctuation">:</span> slot<span class="token punctuation">.</span>resources
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 队列中的任务</span>
    <span class="token keyword">for</span> task <span class="token keyword">in</span> dashboard<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>task_queue<span class="token punctuation">:</span>
        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>task_id<span class="token punctuation">,</span>
            <span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'pending'</span><span class="token punctuation">,</span>
            <span class="token string">'workflow_id'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>workflow_id<span class="token punctuation">,</span>
            <span class="token string">'scheduled_time'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>scheduled_time<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'priority'</span><span class="token punctuation">:</span> task<span class="token punctuation">.</span>priority
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'tasks'</span><span class="token punctuation">:</span> tasks<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/conflicts'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_conflicts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""获取冲突信息"""</span>
    conflicts <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dashboard<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>conflict_detector<span class="token punctuation">.</span>detected_conflicts<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'active_conflicts'</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>conflicts<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'conflicts'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token string">'id'</span><span class="token punctuation">:</span> c<span class="token punctuation">.</span>conflict_id<span class="token punctuation">,</span>
            <span class="token string">'type'</span><span class="token punctuation">:</span> c<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span>
            <span class="token string">'severity'</span><span class="token punctuation">:</span> c<span class="token punctuation">.</span>severity<span class="token punctuation">,</span>
            <span class="token string">'description'</span><span class="token punctuation">:</span> c<span class="token punctuation">.</span>description<span class="token punctuation">,</span>
            <span class="token string">'detected_at'</span><span class="token punctuation">:</span> c<span class="token punctuation">.</span>detected_at<span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> conflicts<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/plots/resource_usage'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">plot_resource_usage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""绘制资源使用图"""</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dashboard<span class="token punctuation">.</span>metrics_history<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> df<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"No data available"</span>
    
    fig <span class="token operator">=</span> make_subplots<span class="token punctuation">(</span>
        rows<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> cols<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
        subplot_titles<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'CPU Usage'</span><span class="token punctuation">,</span> <span class="token string">'Memory Usage'</span><span class="token punctuation">,</span> <span class="token string">'Task Queue'</span><span class="token punctuation">,</span> <span class="token string">'Success Rate'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># CPU使用率</span>
    fig<span class="token punctuation">.</span>add_trace<span class="token punctuation">(</span>
        go<span class="token punctuation">.</span>Scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'system_status.resource_usage.utilization.cpu'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                  mode<span class="token operator">=</span><span class="token string">'lines'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'CPU'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># 内存使用率</span>
    fig<span class="token punctuation">.</span>add_trace<span class="token punctuation">(</span>
        go<span class="token punctuation">.</span>Scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'system_status.resource_usage.utilization.memory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                  mode<span class="token operator">=</span><span class="token string">'lines'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Memory'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">2</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># 任务队列</span>
    fig<span class="token punctuation">.</span>add_trace<span class="token punctuation">(</span>
        go<span class="token punctuation">.</span>Scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'queue_length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                  mode<span class="token operator">=</span><span class="token string">'lines'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Queue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">1</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># 成功率</span>
    fig<span class="token punctuation">.</span>add_trace<span class="token punctuation">(</span>
        go<span class="token punctuation">.</span>Scatter<span class="token punctuation">(</span>x<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'performance.success_rate'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                  mode<span class="token operator">=</span><span class="token string">'lines'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Success Rate'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token number">2</span>
    <span class="token punctuation">)</span>
    
    fig<span class="token punctuation">.</span>update_layout<span class="token punctuation">(</span>height<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> showlegend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> fig<span class="token punctuation">.</span>to_html<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">start_dashboard</span><span class="token punctuation">(</span>controller<span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""启动仪表板"""</span>
    <span class="token keyword">global</span> dashboard
    dashboard <span class="token operator">=</span> MonitoringDashboard<span class="token punctuation">(</span>controller<span class="token punctuation">)</span>
    
    <span class="token comment"># 启动指标收集线程</span>
    <span class="token keyword">def</span> <span class="token function">collect_metrics_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            dashboard<span class="token punctuation">.</span>collect_metrics<span class="token punctuation">(</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 每10秒收集一次</span>
    
    thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>collect_metrics_thread<span class="token punctuation">,</span> daemon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 启动Flask应用</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span>host<span class="token punctuation">,</span> port<span class="token operator">=</span>port<span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建控制器并启动仪表板</span>
    controller <span class="token operator">=</span> CozeAutomationController<span class="token punctuation">(</span><span class="token punctuation">)</span>
    start_dashboard<span class="token punctuation">(</span>controller<span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>七、总结</span></h2><p class="ds-markdown-paragraph"><span>这个完整的Coze工作流增量批量自动化处理系统提供了：</span></p><h3><span>核心特性：</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>智能增量检测</span></strong><span>：支持多种增量检测策略</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>自动工作流生成</span></strong><span>：基于数据特性自动生成优化的工作流</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>无冲突执行</span></strong><span>：分布式调度和冲突解决机制</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>全面监控</span></strong><span>：实时监控和告警系统</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>弹性扩展</span></strong><span>：支持水平扩展和高可用部署</span></p></li></ol><h3><span>部署步骤：</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><span>安装依赖：</span><code>pip install -r requirements.txt</code></p></li><li><p class="ds-markdown-paragraph"><span>配置环境：编辑</span><code>.env</code><span>文件</span></p></li><li><p class="ds-markdown-paragraph"><span>初始化数据库：</span><code>python scripts/init_database.py</code></p></li><li><p class="ds-markdown-paragraph"><span>启动服务：</span><code>python main_controller.py</code></p></li><li><p class="ds-markdown-paragraph"><span>访问仪表板：</span><code>http://localhost:5000</code></p></li></ol><h3><span>生产部署建议：</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><span>使用Docker容器化部署</span></p></li><li><p class="ds-markdown-paragraph"><span>配置负载均衡和高可用</span></p></li><li><p class="ds-markdown-paragraph"><span>设置自动备份和恢复</span></p></li><li><p class="ds-markdown-paragraph"><span>集成企业级监控系统（如Prometheus+Grafana）</span></p></li><li><p class="ds-markdown-paragraph"><span>实现蓝绿部署或金丝雀发布</span></p></li></ol><p class="ds-markdown-paragraph"><span>这个系统可以处理从简单的ETL任务到复杂的AI处理流水线，满足企业级自动化处理需求。</span></p></div></div><div class="ds-theme" style="--ds-rgb-hover:245 245 245; --ds-rgb-primary:77 107 254; --ds-bordered-secondary-button-color:var(--dsr-text-1); --ds-input-prefix-color:var(--dsr-text-1);"></div><div class="ds-flex _0a3d93b fa1bcf13" style="align-items: center; gap: 10px;"><div class="ds-flex _965abe9 _54866f7" style="align-items: center; gap: 10px;"><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.14923 4.02032C7.11191 4.02032 7.87977 4.02017 8.49591 4.07599C9.12122 4.1327 9.65786 4.25188 10.1414 4.53107C10.7201 4.8653 11.2008 5.34591 11.535 5.92462C11.8142 6.40818 11.9333 6.94482 11.9901 7.57013C12.0459 8.18625 12.0457 8.9542 12.0457 9.91681C12.0457 10.8795 12.0459 11.6474 11.9901 12.2635C11.9333 12.8888 11.8142 13.4254 11.535 13.909C11.2008 14.4877 10.7201 14.9683 10.1414 15.3026C9.65786 15.5817 9.12122 15.7009 8.49591 15.7576C7.87977 15.8134 7.1119 15.8133 6.14923 15.8133C5.18661 15.8133 4.41868 15.8134 3.80255 15.7576C3.17724 15.7009 2.6406 15.5817 2.15704 15.3026C1.57834 14.9684 1.09772 14.4877 0.763489 13.909C0.484305 13.4254 0.365123 12.8888 0.308411 12.2635C0.252587 11.6474 0.252747 10.8795 0.252747 9.91681C0.252747 8.95419 0.252603 8.18625 0.308411 7.57013C0.365123 6.94482 0.484305 6.40818 0.763489 5.92462C1.09771 5.3459 1.57833 4.86529 2.15704 4.53107C2.6406 4.25188 3.17724 4.1327 3.80255 4.07599C4.41868 4.02018 5.1866 4.02032 6.14923 4.02032ZM6.14923 5.37775C5.16175 5.37775 4.46628 5.37761 3.9256 5.42657C3.39428 5.47473 3.07853 5.56574 2.83575 5.70587C2.46313 5.92106 2.15348 6.23071 1.93829 6.60333C1.79817 6.84611 1.70715 7.16185 1.659 7.69318C1.61004 8.23385 1.61017 8.92934 1.61017 9.91681C1.61017 10.9043 1.61002 11.5998 1.659 12.1404C1.70715 12.6717 1.79817 12.9875 1.93829 13.2303C2.15349 13.6029 2.46315 13.9126 2.83575 14.1277C3.07853 14.2679 3.39428 14.3589 3.9256 14.407C4.46628 14.456 5.16176 14.4559 6.14923 14.4559C7.13675 14.4559 7.83218 14.456 8.37286 14.407C8.90419 14.3589 9.21993 14.2679 9.46271 14.1277C9.83529 13.9126 10.145 13.6029 10.3602 13.2303C10.5003 12.9875 10.5913 12.6718 10.6395 12.1404C10.6884 11.5998 10.6883 10.9043 10.6883 9.91681C10.6883 8.92935 10.6884 8.23385 10.6395 7.69318C10.5913 7.16185 10.5003 6.84611 10.3602 6.60333C10.145 6.23072 9.8353 5.92107 9.46271 5.70587C9.21993 5.56574 8.90418 5.47473 8.37286 5.42657C7.83218 5.3776 7.13676 5.37775 6.14923 5.37775ZM9.80157 0.367981C10.7637 0.367981 11.5313 0.367886 12.1473 0.423645C12.7725 0.480313 13.3093 0.598765 13.7928 0.877747C14.3716 1.21192 14.852 1.69355 15.1863 2.27228C15.4655 2.75575 15.5857 3.29165 15.6424 3.91681C15.6982 4.53301 15.6971 5.30161 15.6971 6.26447V7.8299C15.6971 8.29265 15.6989 8.58994 15.6649 8.84845C15.4667 10.3525 14.4009 11.5738 12.9832 11.9988V10.5467C13.6973 10.1903 14.2104 9.49662 14.3192 8.67169C14.3387 8.52348 14.3406 8.3358 14.3406 7.8299V6.26447C14.3406 5.27707 14.3398 4.58149 14.2908 4.04083C14.2427 3.50969 14.1526 3.19373 14.0125 2.95099C13.7974 2.5785 13.4875 2.2687 13.1151 2.05353C12.8723 1.91347 12.5563 1.82237 12.0252 1.77423C11.4846 1.72528 10.7888 1.7254 9.80157 1.7254H7.71466C6.75614 1.72559 5.92659 2.27697 5.52325 3.07892H4.07013C4.54215 1.51132 5.99314 0.368192 7.71466 0.367981H9.80157Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.92139 0.349152C10.3744 0.349234 12.5564 1.5052 13.9558 3.29894L15.1281 2.12759C15.3304 1.92546 15.6767 2.06943 15.6767 2.35538V5.53923C15.6766 5.71626 15.5329 5.85976 15.3559 5.86002H12.171C11.8855 5.8597 11.7426 5.51465 11.9443 5.31249L12.9641 4.29056C11.8237 2.74305 9.98911 1.74106 7.92139 1.74097C4.46439 1.74097 1.66236 4.543 1.66236 8C1.66236 11.457 4.46439 14.259 7.92139 14.259C11.3783 14.2589 14.1804 11.4569 14.1804 8H15.5722C15.5722 12.2251 12.1465 15.6507 7.92139 15.6508C3.69617 15.6508 0.270538 12.2252 0.270538 8C0.270538 3.77478 3.69617 0.349152 7.92139 0.349152Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.27861 0.811572C8.81985 0.142194 9.79016 0.0421835 10.4537 0.557601L10.5823 0.669306L10.6065 0.693544L10.6097 0.695652L10.6392 0.725159C11.3549 1.44679 11.6336 2.49468 11.3716 3.47669L11.3705 3.48091L11.361 3.51674L11.36 3.51885L10.8889 5.22604C10.8796 5.25997 10.8706 5.29157 10.8626 5.32088C10.8934 5.32095 10.927 5.32194 10.9627 5.32194H11.9006C12.4263 5.32194 12.783 5.319 13.0651 5.36725C14.8182 5.66719 15.9851 7.34568 15.6564 9.09357C15.6035 9.37487 15.4769 9.7092 15.2939 10.2022L14.337 12.7798C14.1401 13.3104 13.9773 13.7518 13.8101 14.1024C13.6375 14.4645 13.4385 14.7793 13.1441 15.0424C12.9712 15.197 12.7801 15.3303 12.5751 15.4386C12.2259 15.6231 11.8608 15.7 11.4612 15.7358C11.0742 15.7705 10.6034 15.7695 10.0374 15.7695H4.87371C4.08047 15.7695 3.42922 15.7702 2.90728 15.7137C2.37206 15.6557 1.88985 15.5311 1.4667 15.2237C1.22409 15.0474 1.01072 14.8339 0.834405 14.5914C0.52696 14.1682 0.401312 13.686 0.343323 13.1508C0.286761 12.6287 0.28747 11.9769 0.28747 11.1833V9.51405C0.28747 8.84778 0.281286 8.36714 0.399176 7.9565C0.671091 7.00935 1.41109 6.26832 2.35823 5.99638C2.76888 5.87849 3.24952 5.88573 3.91579 5.88573C4.11977 5.88573 4.14542 5.88319 4.16238 5.88046C4.23526 5.86863 4.30403 5.83663 4.35839 5.78667C4.37104 5.77504 4.38755 5.75604 4.51436 5.59488L8.25648 0.838972L8.25754 0.837918L8.27861 0.811572ZM1.69116 11.1833C1.69116 12.0082 1.69211 12.5711 1.73859 13.0001C1.78365 13.4157 1.86467 13.6221 1.96937 13.7662C2.05914 13.8898 2.16727 13.9989 2.29079 14.0887C2.43495 14.1934 2.6421 14.2744 3.05797 14.3195C3.45891 14.3629 3.97631 14.3656 4.71564 14.3659C4.30795 13.8053 4.06447 13.1171 4.06437 12.371V8.59406H5.46807V12.371C5.46832 13.4733 6.3616 14.3669 7.46401 14.3669H10.0374C10.6286 14.3669 11.0269 14.3663 11.3368 14.3385C11.6339 14.3118 11.7956 14.2638 11.9196 14.1983C12.024 14.1431 12.1213 14.0747 12.2094 13.996C12.3139 13.9025 12.4151 13.7678 12.5434 13.4986C12.6774 13.2176 12.8162 12.845 13.0219 12.2909L13.9787 9.71322C14.1848 9.15816 14.253 8.96731 14.278 8.83433C14.4617 7.85692 13.8092 6.91895 12.829 6.75092C12.6956 6.7281 12.4928 6.72458 11.9006 6.72458H10.9627C10.7737 6.72458 10.5693 6.72657 10.4 6.70666C10.2211 6.68562 9.96696 6.63024 9.74764 6.43161C9.64448 6.33811 9.5595 6.2261 9.49683 6.10177C9.36384 5.83784 9.37793 5.57899 9.40515 5.40097C9.43094 5.23261 9.48666 5.03616 9.53688 4.85404L10.0079 3.14579L10.0174 3.11102C10.1488 2.61338 10.0077 2.08338 9.64648 1.71681L9.60854 1.67887L9.55058 1.64304C9.48789 1.62043 9.41419 1.63814 9.36932 1.69362L9.35773 1.70627L9.35878 1.70732L5.61666 6.46217C5.51816 6.58735 5.42231 6.7133 5.30683 6.81942C5.05069 7.05471 4.73119 7.20939 4.3879 7.26519C4.23309 7.29032 4.07507 7.28837 3.91579 7.28837C3.1535 7.28837 2.9191 7.2957 2.74604 7.34528C2.26358 7.48379 1.88558 7.86081 1.74702 8.34325C1.69732 8.51636 1.69116 8.7511 1.69116 9.51405V11.1833Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.72451 15.1086C7.18929 15.7705 6.22975 15.8694 5.57357 15.3597L5.44643 15.2492L5.42247 15.2253L5.41934 15.2232L5.39016 15.194C4.68239 14.4804 4.40679 13.4442 4.66589 12.473L4.66693 12.4689L4.67631 12.4334L4.67735 12.4314L5.14318 10.7431C5.15243 10.7096 5.1613 10.6783 5.16923 10.6493C5.13878 10.6493 5.10558 10.6483 5.07023 10.6483H4.14274C3.62288 10.6483 3.27015 10.6512 2.9912 10.6035C1.25757 10.3069 0.103662 8.64703 0.42863 6.91855C0.480965 6.64038 0.606164 6.30975 0.787119 5.82224L1.73336 3.27321C1.92812 2.74853 2.08912 2.31209 2.25442 1.96535C2.42515 1.60725 2.62191 1.29594 2.91304 1.03578C3.08408 0.882955 3.273 0.751124 3.47579 0.643948C3.82102 0.461508 4.18214 0.385514 4.57731 0.35007C4.95993 0.315788 5.42553 0.316722 5.98521 0.316722H11.0916C11.876 0.316722 12.52 0.316073 13.0362 0.371954C13.5655 0.429296 14.0423 0.552538 14.4608 0.85654C14.7007 1.03085 14.9117 1.24193 15.086 1.48181C15.3901 1.90027 15.5143 2.3771 15.5717 2.90639C15.6276 3.42269 15.6269 4.06721 15.6269 4.85203V6.50274C15.6269 7.1616 15.633 7.63691 15.5164 8.04299C15.2475 8.97962 14.5158 9.71242 13.5791 9.98134C13.173 10.0979 12.6977 10.0908 12.0389 10.0908C11.8372 10.0908 11.8118 10.0933 11.795 10.096C11.723 10.1077 11.6549 10.1393 11.6012 10.1887C11.5887 10.2002 11.5724 10.219 11.447 10.3784L7.74639 15.0815L7.74535 15.0825L7.72451 15.1086ZM14.2388 4.85203C14.2388 4.03628 14.2379 3.47965 14.1919 3.05541C14.1473 2.64443 14.0672 2.4403 13.9637 2.29779C13.8749 2.17563 13.768 2.06769 13.6458 1.9789C13.5033 1.87533 13.2984 1.79523 12.8872 1.75068C12.4907 1.70773 11.979 1.70512 11.2479 1.70482C11.6511 2.25918 11.8918 2.93968 11.8919 3.67756V7.41251H10.5038V3.67756C10.5036 2.58745 9.62023 1.70378 8.53007 1.70378H5.98521C5.40065 1.70378 5.00679 1.70443 4.70028 1.73192C4.40651 1.7583 4.24662 1.80571 4.12399 1.87052C4.02069 1.92512 3.92452 1.99277 3.8374 2.07061C3.73401 2.16306 3.634 2.29621 3.50705 2.56249C3.37462 2.84028 3.23734 3.20874 3.03393 3.75676L2.08768 6.30578C1.88395 6.85468 1.81646 7.04341 1.79172 7.17491C1.61005 8.14146 2.25533 9.06902 3.22464 9.23518C3.35654 9.25775 3.55717 9.26123 4.14274 9.26123H5.07023C5.25717 9.26123 5.4593 9.25926 5.62672 9.27895C5.80364 9.29976 6.05492 9.35452 6.27179 9.55094C6.37381 9.6434 6.45784 9.75417 6.51982 9.87712C6.65133 10.1381 6.6374 10.3941 6.61048 10.5701C6.58498 10.7366 6.52988 10.9309 6.48022 11.111L6.01439 12.8003L6.00501 12.8347C5.87513 13.3268 6.01464 13.8509 6.37184 14.2134L6.40935 14.2509L6.46667 14.2863C6.52866 14.3087 6.60155 14.2912 6.64591 14.2363L6.65738 14.2238L6.65633 14.2228L10.3569 9.52072C10.4543 9.39693 10.5491 9.27239 10.6633 9.16744C10.9166 8.93477 11.2325 8.7818 11.572 8.72662C11.7251 8.70177 11.8814 8.7037 12.0389 8.7037C12.7927 8.7037 13.0245 8.69645 13.1956 8.64742C13.6727 8.51045 14.0465 8.13762 14.1836 7.66054C14.2327 7.48935 14.2388 7.25721 14.2388 6.50274V4.85203Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><div class="db183363 ds-icon-button ds-icon-button--m ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.7483 11.1003C15.6274 11.8866 15.5288 12.5364 15.3881 13.0496C15.243 13.5789 15.0339 14.0407 14.6455 14.4162C14.5638 14.4951 14.4775 14.5699 14.387 14.6386C13.9568 14.9655 13.4683 15.1011 12.9229 15.1641C12.3944 15.2251 11.7374 15.2245 10.9419 15.2245H5.05805C4.26257 15.2245 3.60557 15.2251 3.077 15.1641C2.53167 15.1011 2.04314 14.9655 1.61293 14.6386C1.52245 14.5699 1.43615 14.4951 1.35444 14.4162C0.96605 14.0407 0.756931 13.5789 0.611809 13.0496C0.471132 12.5364 0.372585 11.8866 0.251617 11.1003L1.64577 10.8863C1.77178 11.7054 1.85788 12.2601 1.97206 12.6767C2.08171 13.0766 2.19757 13.27 2.33437 13.4023C2.376 13.4426 2.4207 13.4807 2.46679 13.5157C2.61837 13.6308 2.82717 13.716 3.23909 13.7636C3.66809 13.8131 4.22946 13.8144 5.05805 13.8144H10.9419C11.7705 13.8144 12.3319 13.8131 12.7609 13.7636C13.1728 13.716 13.3816 13.6308 13.5331 13.5157C13.5792 13.4807 13.6239 13.4426 13.6656 13.4023C13.8024 13.27 13.9182 13.0766 14.0279 12.6767C14.1421 12.2601 14.2282 11.7054 14.3542 10.8863L15.7483 11.1003ZM7.715 0.558333C7.90368 0.527919 8.09626 0.527919 8.28495 0.558333C8.63703 0.61512 8.9129 0.790062 9.14941 0.985266C9.37576 1.1721 9.62515 1.42888 9.90475 1.71624L13.387 5.29485L12.8816 5.78747L12.3763 6.27902L8.89409 2.70041C8.82605 2.63048 8.76283 2.5671 8.70552 2.50866V10.5335H7.29442V2.50866C7.23711 2.5671 7.17389 2.63048 7.10585 2.70041L3.62365 6.27902L3.11832 5.78747L2.61299 5.29485L6.09519 1.71624C6.37479 1.42888 6.62419 1.1721 6.85054 0.985266C7.08704 0.790062 7.36291 0.61512 7.715 0.558333Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div></div><div style="flex: 1 1 0%;"></div></div></div></div><div class="_189b4a0" style="--scroll-nav-page-padding:20px 0px 20px 24px;"><div class="_6ffc3c9" style="--bg-height:90px;"></div><div class="_4ce999d _42b9b3d"><div class="ds-scroll-area _8dbd25b"><div class="ds-scroll-area__gutters" style="--ds-scroll-area-gutters-disappear-delay:0; --container-height:90px; position: sticky; top: 0px; left: 0px; right: 0px; height: 0px;"><div class="ds-scroll-area__horizontal-gutter" style="left: 8px; right: 8px; display: block; top: calc(var(--container-height) - 10px); height: 10px;"><div class="ds-scroll-area__horizontal-bar" style="display: none;"></div></div><div class="ds-scroll-area__vertical-gutter" style="right: 0px; top: 4px; bottom: calc(0px - var(--container-height) + 44px); width: 6px;"><div class="ds-scroll-area__vertical-bar" style="display: none;"></div></div></div><div class="_81e7b5e _966e035"><div class="_72b6158">增量批量自动化生成制作完整的coze工作流和完整coze工作流参数和增量批量自动化处理操作自动化运行</div><div class="ef46fbc6"><div class="fae5876e"></div></div></div><div class="_81e7b5e _19d617c"><div class="_72b6158">增量批量自动化生成制作完整的coze工作流和完整coze工作流参数和增量批量自动化处理操作自动化运行和多种增量批量类数据自动化处理自动化操作和自动化生成完整工作流节点需求配置和完整无冲突自动化运行</div><div class="ef46fbc6"><div class="fae5876e"></div></div></div></div></div></div><div class="_871cbca fa1bcf13"><div class="d72636e2"></div><div class="aaff8b8f"><div class="_77cefa5 _3d616d3"><div class="_020ab5b"><div class="_24fad49"><div class="ds-scroll-area__gutters" style="position: absolute; inset: 0px; --container-height:62px;"><div class="ds-scroll-area__horizontal-gutter" style="left: 8px; right: 8px; display: block; bottom: 0px; height: 10px;"><div class="ds-scroll-area__horizontal-bar" style="display: none;"></div></div><div class="ds-scroll-area__vertical-gutter" style="right: 0px; top: 20px; bottom: 0px; width: 8px;"><div class="ds-scroll-area__vertical-bar" style="display: none;"></div></div></div><textarea class="_27c9245 ds-scroll-area d96f2d2a" placeholder="给 DeepSeek 发送消息 " rows="2"></textarea><div class="b13855df">
</div></div><div class="ec4f5d61"><div role="button" aria-disabled="false" class="ds-atom-button f79352dc ds-toggle-button ds-toggle-button--selected ds-toggle-button--md" tabindex="0" style="transform: translateZ(0px);"><div class="ds-icon ds-atom-button__icon" style="font-size: 14px; width: 14px; height: 14px; color: var(--dsw-alias-brand-text); margin-right: 0px;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.06428 5.93342C7.6876 5.93342 8.19304 6.43904 8.19319 7.06233C8.19319 7.68573 7.68769 8.19123 7.06428 8.19123C6.44096 8.19113 5.93537 7.68567 5.93537 7.06233C5.93552 6.43911 6.44105 5.93353 7.06428 5.93342Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8.68147 0.963693C10.1168 0.447019 11.6266 0.374829 12.5633 1.31135C13.5 2.24805 13.4276 3.75776 12.911 5.19319C12.7126 5.74431 12.4385 6.31796 12.0965 6.89729C12.4969 7.54638 12.8141 8.19018 13.036 8.80647C13.5527 10.2419 13.625 11.7516 12.6883 12.6883C11.7516 13.625 10.2419 13.5527 8.80647 13.036C8.19019 12.8141 7.54638 12.4969 6.89729 12.0965C6.31794 12.4386 5.74432 12.7125 5.19319 12.911C3.75774 13.4276 2.24807 13.5 1.31135 12.5633C0.374829 11.6266 0.447019 10.1168 0.963693 8.68147C1.17182 8.10338 1.46318 7.50063 1.82893 6.8924C1.52179 6.35711 1.27232 5.82825 1.08869 5.31819C0.572038 3.88278 0.499683 2.37306 1.43635 1.43635C2.37304 0.499655 3.88277 0.572044 5.31819 1.08869C5.82825 1.27232 6.35712 1.5218 6.8924 1.82893C7.50063 1.46318 8.10338 1.17181 8.68147 0.963693ZM11.3572 8.01154C10.9083 8.62253 10.3901 9.22873 9.8094 9.8094C9.22874 10.3901 8.62252 10.9083 8.01154 11.3572C8.42567 11.5841 8.82867 11.7688 9.21272 11.9071C10.5455 12.3868 11.4246 12.2547 11.8397 11.8397C12.2547 11.4246 12.3869 10.5456 11.9071 9.21272C11.7688 8.82866 11.5841 8.42568 11.3572 8.01154ZM2.56526 8.02912C2.3734 8.39322 2.21492 8.74796 2.0926 9.08772C1.61288 10.4204 1.74509 11.2995 2.15998 11.7147C2.57502 12.1297 3.45412 12.2618 4.78694 11.7821C5.11053 11.6656 5.44783 11.5164 5.79377 11.3367C5.24897 10.9223 4.70919 10.4533 4.19026 9.9344C3.57575 9.31987 3.03166 8.67633 2.56526 8.02912ZM6.90705 3.2469C6.24062 3.70479 5.56457 4.26321 4.91389 4.91389C4.26322 5.56456 3.70479 6.24063 3.2469 6.90705C3.72671 7.63325 4.32774 8.37459 5.03889 9.08576C5.6494 9.69627 6.2818 10.2265 6.90803 10.6678C7.59365 10.2025 8.29077 9.63076 8.96076 8.96076C9.63077 8.29075 10.2025 7.59366 10.6678 6.90803C10.2265 6.2818 9.69628 5.6494 9.08576 5.03889C8.37459 4.32773 7.63325 3.72672 6.90705 3.2469ZM11.7147 2.15998C11.2995 1.74509 10.4204 1.61288 9.08772 2.0926C8.74832 2.21479 8.39379 2.37271 8.0301 2.56428C8.67725 3.03065 9.31992 3.5758 9.9344 4.19026C10.4533 4.7092 10.9223 5.24896 11.3367 5.79377C11.5164 5.44785 11.6656 5.11052 11.7821 4.78694C12.2618 3.45416 12.1297 2.57502 11.7147 2.15998ZM4.91194 2.2176C3.57918 1.73788 2.70001 1.86995 2.28498 2.28498C1.86998 2.70003 1.73788 3.5792 2.2176 4.91194C2.31706 5.18822 2.44109 5.47427 2.58674 5.7674C3.01928 5.1887 3.51471 4.6158 4.06526 4.06526C4.61581 3.5147 5.18869 3.01928 5.7674 2.58674C5.47428 2.4411 5.18821 2.31706 4.91194 2.2176Z" fill="currentColor"></path></svg></div><span><span class="_6dbc175">深度思考</span></span><div class="ds-focus-ring"></div></div><div role="button" aria-disabled="false" class="ds-atom-button f79352dc ds-toggle-button ds-toggle-button--md" tabindex="0" style="transform: translateZ(0px);"><div class="ds-icon ds-atom-button__icon" style="font-size: 14px; width: 14px; height: 14px; color: var(--dsw-alias-label-primary); margin-right: 0px;"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 0.150391C10.7832 0.150391 13.8496 3.21685 13.8496 7C13.8496 10.7832 10.7832 13.8496 7 13.8496C3.21685 13.8496 0.150391 10.7832 0.150391 7C0.150391 3.21685 3.21685 0.150391 7 0.150391ZM5.37793 7.59961C5.42667 9.03204 5.64751 10.2965 5.97363 11.2197C6.15993 11.7471 6.36943 12.1301 6.57324 12.3701C6.77748 12.6105 6.9234 12.6504 7 12.6504C7.0766 12.6504 7.22252 12.6105 7.42676 12.3701C7.63057 12.1301 7.84007 11.7471 8.02637 11.2197C8.35249 10.2965 8.57333 9.03204 8.62207 7.59961H5.37793ZM1.38184 7.59961C1.61453 9.80492 3.1159 11.6304 5.14258 12.3359C5.03265 12.1128 4.93224 11.8724 4.84277 11.6191C4.46339 10.5451 4.22772 9.13988 4.17871 7.59961H1.38184ZM9.82129 7.59961C9.77228 9.13988 9.53661 10.5451 9.15723 11.6191C9.06771 11.8726 8.96645 12.1127 8.85645 12.3359C10.8836 11.6307 12.3854 9.80524 12.6182 7.59961H9.82129ZM7 1.34961C6.9234 1.34961 6.77748 1.38949 6.57324 1.62988C6.36943 1.86988 6.15993 2.25291 5.97363 2.78027C5.64751 3.70351 5.42667 4.96796 5.37793 6.40039H8.62207C8.57333 4.96796 8.35249 3.70351 8.02637 2.78027C7.84007 2.25291 7.63057 1.86988 7.42676 1.62988C7.22252 1.38949 7.0766 1.34961 7 1.34961ZM8.85645 1.66309C8.9666 1.88656 9.0676 2.12715 9.15723 2.38086C9.53661 3.45487 9.77228 4.86012 9.82129 6.40039H12.6182C12.3854 4.19465 10.8837 2.36828 8.85645 1.66309ZM5.14258 1.66309C3.11575 2.3685 1.61454 4.19497 1.38184 6.40039H4.17871C4.22772 4.86012 4.46339 3.45487 4.84277 2.38086C4.93234 2.1273 5.03249 1.88645 5.14258 1.66309Z" fill="currentColor"></path></svg></div><span><span class="_6dbc175">联网搜索</span></span><div class="ds-focus-ring"></div></div><div class="bf38813a"><div class="f02f0e25 ds-icon-button ds-icon-button--l ds-icon-button--sizing-container" tabindex="0" role="button" aria-disabled="false"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.5498 9.75V5H6.9502V9.75C6.9502 10.3299 7.4201 10.7998 8 10.7998C8.5799 10.7998 9.0498 10.3299 9.0498 9.75V4.5C9.0498 2.9536 7.7964 1.7002 6.25 1.7002C4.7036 1.7002 3.4502 2.9536 3.4502 4.5V9.75C3.4502 12.2629 5.4871 14.2998 8 14.2998C10.5129 14.2998 12.5498 12.2629 12.5498 9.75V4H13.9502V9.75C13.9502 13.0361 11.2861 15.7002 8 15.7002C4.71391 15.7002 2.0498 13.0361 2.0498 9.75V4.5C2.04981 2.1804 3.9304 0.299806 6.25 0.299805C8.5696 0.299805 10.4502 2.1804 10.4502 4.5V9.75C10.4502 11.1031 9.3531 12.2002 8 12.2002C6.6469 12.2002 5.5498 11.1031 5.5498 9.75Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring"></div></div><input type="file" multiple="" accept=".epub,.mobi,.azw3,.pdf,.png,.jpg,.jpeg,.svg,.svgz,.bmp,.gif,.webp,.ico,.xbm,.dib,.pjp,.tif,.pjpeg,.avif,.apng,.tiff,.jfif,.txt,.md,.csv,.tsv,.html,.json,.log,.dot,.go,.h,.c,.cpp,.cxx,.cc,.cs,.java,.js,.css,.jsp,.php,.py,.py3,.asp,.yaml,.yml,.ini,.conf,.ts,.tsx,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.abap,.asc,.ash,.ampl,.mod,.g4,.apib,.apl,.dyalog,.asax,.ascx,.ashx,.asmx,.aspx,.axd,.dats,.hats,.sats,.as,.adb,.ada,.ads,.agda,.als,.apacheconf,.vhost,.cls,.applescript,.scpt,.arc,.ino,.asciidoc,.adoc,.aj,.asm,.a51,.inc,.nasm,.aug,.ahk,.ahkl,.au3,.awk,.auk,.gawk,.mawk,.nawk,.bat,.cmd,.befunge,.bison,.bb,.decls,.bmx,.bsv,.boo,.b,.bf,.brs,.bro,.cats,.idc,.w,.cake,.cshtml,.csx,.c++,.cp,.h++,.hh,.hpp,.hxx,.inl,.ipp,.tcc,.tpp,.c-objdump,.chs,.clp,.cmake,.in,.cob,.cbl,.ccp,.cobol,.cpy,.capnp,.mss,.ceylon,.chpl,.ch,.ck,.cirru,.clw,.icl,.dcl,.click,.clj,.boot,.cl2,.cljc,.cljs,.hl,.cljscm,.cljx,.hic,.coffee,._coffee,.cjsx,.cson,.iced,.cfm,.cfml,.cfc,.lisp,.asd,.cl,.l,.lsp,.ny,.podsl,.sexp,.cps,.coq,.v,.cppobjdump,.c++-objdump,.c++objdump,.cpp-objdump,.cxx-objdump,.creole,.cr,.feature,.cu,.cuh,.cy,.pyx,.pxd,.pxi,.d,.di,.d-objdump,.com,.dm,.zone,.arpa,.darcspatch,.dpatch,.dart,.diff,.patch,.dockerfile,.djs,.dylan,.dyl,.intr,.lid,.E,.ecl,.eclxml,.sch,.brd,.epj,.e,.ex,.exs,.elm,.el,.emacs,.desktop,.em,.emberscript,.erl,.es,.escript,.hrl,.xrl,.yrl,.fs,.fsi,.fsx,.fx,.flux,.f90,.f,.f03,.f08,.f77,.f95,.for,.fpp,.factor,.fy,.fancypack,.fan,.fth,.4th,.forth,.fr,.frt,.ftl,.g,.gco,.gcode,.gms,.gap,.gd,.gi,.tst,.s,.ms,.glsl,.fp,.frag,.frg,.fsh,.fshader,.geo,.geom,.glslv,.gshader,.shader,.vert,.vrx,.vsh,.vshader,.gml,.kid,.ebuild,.eclass,.po,.pot,.glf,.gp,.gnu,.gnuplot,.plot,.plt,.golo,.gs,.gst,.gsx,.vark,.grace,.gradle,.gf,.graphql,.gv,.man,.1in,.1m,.1x,.3in,.3m,.3qt,.3x,.me,.n,.rno,.roff,.groovy,.grt,.gtpl,.gvy,.gsp,.hcl,.tf,.hlsl,.fxh,.hlsli,.htm,.st,.xht,.xhtml,.mustache,.jinja,.eex,.erb,.deface,.phtml,.http,.haml,.handlebars,.hbs,.hb,.hs,.hsc,.hx,.hxsl,.hy,.pro,.dlm,.ipf,.cfg,.prefs,.properties,.irclog,.weechatlog,.idr,.lidr,.ni,.i7x,.iss,.io,.ik,.thy,.ijs,.flex,.jflex,.geojson,.lock,.topojson,.json5,.jsonld,.jq,.jsx,.jade,.j,._js,.bones,.es6,.jake,.jsb,.jscad,.jsfl,.jsm,.jss,.njs,.pac,.sjs,.ssjs,.sublime-build,.sublime-commands,.sublime-completions,.sublime-keymap,.sublime-macro,.sublime-menu,.sublime-mousemap,.sublime-project,.sublime-settings,.sublime-theme,.sublime-workspace,.sublime_metrics,.sublime_session,.xsjs,.xsjslib,.jl,.ipynb,.krl,.kicad_pcb,.kit,.kt,.ktm,.kts,.lfe,.ll,.lol,.lsl,.lslp,.lvproj,.lasso,.las,.lasso8,.lasso9,.ldml,.latte,.lean,.hlean,.less,.lex,.ly,.ily,.m,.ld,.lds,.liquid,.lagda,.litcoffee,.lhs,.ls,._ls,.xm,.x,.xi,.lgt,.logtalk,.lookml,.lua,.fcgi,.nse,.pd_lua,.rbxs,.wlua,.mumps,.m4,.mcr,.mtml,.muf,.mak,.mk,.mkfile,.mako,.mao,.markdown,.mkd,.mkdn,.mkdown,.ron,.mask,.mathematica,.cdf,.ma,.map,.mt,.nb,.nbp,.wl,.wlt,.matlab,.maxpat,.maxhelp,.maxproj,.mxt,.pat,.mediawiki,.wiki,.moo,.metal,.minid,.druby,.duby,.mir,.mirah,.mo,.mms,.mmk,.monkey,.moon,.myt,.ncl,.nl,.nsi,.nsh,.axs,.axi,.nlogo,.nginxconf,.nim,.nimrod,.ninja,.nit,.nix,.nu,.numpy,.numpyw,.numsc,.ml,.eliom,.eliomi,.ml4,.mli,.mll,.mly,.objdump,.mm,.sj,.omgrofl,.opa,.opal,.opencl,.p,.scad,.org,.ox,.oxh,.oxo,.oxygene,.oz,.pwn,.aw,.ctp,.php3,.php4,.php5,.php6,.php7,.php8,.phps,.phpt,.pls,.pck,.pkb,.pks,.plb,.plsql,.sql,.pov,.pan,.psc,.parrot,.pasm,.pir,.pas,.dfm,.dpr,.lpr,.pp,.pl,.al,.cgi,.perl,.ph,.plx,.pm,.pod,.psgi,.t,.6pl,.6pm,.nqp,.p6,.p6l,.p6m,.pl6,.pm6,.pkl,.pig,.pike,.pmod,.pogo,.pony,.ps,.eps,.ps1,.psd1,.psm1,.pde,.prolog,.yap,.spin,.proto,.pub,.pd,.pb,.pbi,.purs,.bzl,.gyp,.lmi,.pyde,.pyi,.pyp,.pyt,.pyw,.rpy,.tac,.wsgi,.xpy,.pytb,.qml,.qbs,.pri,.r,.rd,.rsx,.raml,.rdoc,.rbbas,.rbfrm,.rbmnu,.rbres,.rbtbar,.rbuistate,.rhtml,.rmd,.rkt,.rktd,.rktl,.scrbl,.rl,.raw,.reb,.r2,.r3,.rebol,.red,.reds,.cw,.rs,.rsh,.robot,.rg,.rb,.builder,.gemspec,.god,.irbrc,.jbuilder,.mspec,.pluginspec,.podspec,.rabl,.rake,.rbuild,.rbw,.rbx,.ru,.ruby,.thor,.watchr,.sas,.scss,.smt2,.smt,.sparql,.rq,.sqf,.hqf,.cql,.ddl,.prc,.tab,.udf,.viw,.db2,.ston,.sage,.sagews,.sls,.sass,.scala,.sbt,.sc,.scaml,.scm,.sld,.sps,.ss,.sci,.sce,.self,.sh,.bash,.bats,.command,.ksh,.tmux,.tool,.zsh,.sh-session,.shen,.sl,.slim,.smali,.tpl,.sp,.sma,.nut,.stan,.ML,.fun,.sig,.sml,.do,.ado,.doh,.ihlp,.mata,.matah,.sthlp,.styl,.scd,.swift,.sv,.svh,.vh,.toml,.txl,.tcl,.adp,.tm,.tcsh,.csh,.tex,.aux,.bbx,.bib,.cbx,.dtx,.ins,.lbx,.ltx,.mkii,.mkiv,.mkvi,.sty,.toc,.tea,.no,.textile,.thrift,.tu,.ttl,.twig,.upc,.anim,.asset,.mat,.meta,.prefab,.unity,.uno,.uc,.ur,.urs,.vcl,.vhdl,.vhd,.vhf,.vhi,.vho,.vhs,.vht,.vhw,.vala,.vapi,.veo,.vim,.vb,.bas,.frm,.frx,.vba,.vbhtml,.vbs,.volt,.vue,.owl,.webidl,.x10,.xc,.xml,.ant,.axml,.ccxml,.clixml,.cproject,.csl,.csproj,.ct,.dita,.ditamap,.ditaval,.config,.dotsettings,.filters,.fsproj,.fxml,.glade,.grxml,.iml,.ivy,.jelly,.jsproj,.kml,.launch,.mdpolicy,.mxml,.nproj,.nuspec,.odd,.osm,.plist,.props,.ps1xml,.psc1,.pt,.rdf,.rss,.scxml,.srdf,.storyboard,.stTheme,.sublime-snippet,.targets,.tmCommand,.tml,.tmLanguage,.tmPreferences,.tmSnippet,.tmTheme,.ui,.urdf,.ux,.vbproj,.vcxproj,.vssettings,.vxml,.wsdl,.wsf,.wxi,.wxl,.wxs,.x3d,.xacro,.xaml,.xib,.xlf,.xliff,.xmi,.dist,.xproj,.xsd,.xul,.zcml,.xsp-config,.metadata,.xpl,.xproc,.xquery,.xq,.xql,.xqm,.xqy,.xs,.xslt,.xsl,.xojo_code,.xojo_menu,.xojo_report,.xojo_script,.xojo_toolbar,.xojo_window,.xtend,.reek,.rviz,.sublime-syntax,.syntax,.yaml-tmlanguage,.yang,.y,.yacc,.yy,.zep,.zimpl,.zmpl,.zpl,.ec,.eh,.edn,.fish,.mu,.nc,.ooc,.rst,.rest,.wisp,.prg,.prw,.gitignore,.gitkeep,.gitmodules,.example,.avifs,.blp,.bufr,.bw,.cur,.dcx,.dds,.emf,.fit,.fits,.flc,.fli,.ftc,.ftu,.gbr,.grib,.h5,.hdf,.icb,.icns,.iim,.im,.j2c,.j2k,.jp2,.jpc,.jpe,.jpf,.jpx,.mpeg,.mpg,.msp,.pbm,.pcd,.pcx,.pfm,.pgm,.pnm,.ppm,.psd,.pxr,.qoi,.ras,.rgb,.rgba,.sgi,.tga,.vda,.vst,.wmf,.xpm" style="display: none;"><div style="width: fit-content;"><div class="_7436101 bcc55ca1 ds-icon-button ds-icon-button--l ds-icon-button--sizing-container ds-icon-button--disabled" role="button" aria-disabled="true"><div class="ds-icon-button__hover-bg"></div><div class="ds-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.3125 0.981587C8.66767 1.0545 8.97902 1.20558 9.2627 1.43374C9.48724 1.61438 9.73029 1.85933 9.97949 2.10854L14.707 6.83608L13.293 8.25014L9 3.95717V15.0431H7V3.95717L2.70703 8.25014L1.29297 6.83608L6.02051 2.10854C6.26971 1.85933 6.51277 1.61438 6.7373 1.43374C6.97662 1.24126 7.28445 1.04542 7.6875 0.981587C7.8973 0.94841 8.1031 0.956564 8.3125 0.981587Z" fill="currentColor"></path></svg></div><div class="ds-focus-ring" style="--ds-focus-ring-offset:-2px;"></div></div></div></div></div></div></div></div><div class="_0fcaa63">内容由 AI 生成，请仔细甄别</div></div></div></div></div><div class="_43d222b"><div class="_9f86274"><div class="ds-checkbox-wrapper ds-checkbox-wrapper--l _692accd" style="color: inherit; --font-size: inherit; --gap:12px;"><div class="ds-checkbox-align-wrapper"><div class="ds-checkbox ds-checkbox--l ds-checkbox--active ds-checkbox--none" tabindex="0"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5625 4.49518L7.61331 8.98248C7.35059 9.28094 7.11252 9.55346 6.89359 9.75201C6.66498 9.95932 6.38424 10.1559 6.0137 10.2217C5.81985 10.2561 5.62112 10.2582 5.42679 10.2266C5.05515 10.1662 4.77171 9.97269 4.54007 9.76862C4.31832 9.57324 4.07657 9.30444 3.8096 9.00983L2.44437 7.50397L3.55569 6.49615L4.92093 8.00299C5.21161 8.32377 5.38783 8.51724 5.53128 8.64362C5.60927 8.71232 5.65159 8.73725 5.668 8.74518C5.69553 8.74962 5.72354 8.75 5.75101 8.74518C5.72562 8.74984 5.75469 8.75955 5.88577 8.64069C6.02738 8.51225 6.20131 8.31621 6.48734 7.99127L10.4375 3.50494L11.5625 4.49518Z" fill="currentColor"></path></svg></div></div><div class="ds-checkbox-label">全选</div></div><svg xmlns="http://www.w3.org/2000/svg" width="2" height="15" viewBox="0 0 2 15" fill="none" style="color: var(--dsw-alias-border-l3);"><path d="M1 0.5V14.5" stroke="currentColor"></path></svg><span class="dcaa34cd">已选择 2 组对话</span><div class="fab07e97"><button role="button" aria-disabled="false" class="ds-atom-button ds-basic-button ds-basic-button--outlined _43443f1" style="padding: 6px 14px; font-size: 14px; line-height: 22px; min-width: 72px;"><span>取消</span><div class="ds-focus-ring"></div></button><button role="button" aria-disabled="false" class="ds-atom-button ds-basic-button ds-basic-button--primary" style="padding: 6px 14px; font-size: 14px; line-height: 22px; min-width: 72px;"><div class="ds-icon ds-atom-button__icon" style="font-size: 14px; width: 14px; height: 14px; margin-right: 6px;"><div class="ds-icon" style="font-size: 14px; width: 14px; height: 14px;"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.94133 6.50173C11.3218 7.99603 11.3218 10.3011 9.94128 11.7954C9.88691 11.8542 9.82125 11.9196 9.72099 12.0198L7.75707 13.9838C7.65709 14.0838 7.592 14.1491 7.53334 14.2034C6.03906 15.5843 3.7327 15.5854 2.23827 14.2048C2.17933 14.1503 2.11374 14.0844 2.01315 13.9838C1.91318 13.8839 1.84922 13.8188 1.79495 13.7601C0.413857 12.2657 0.413909 9.95948 1.795 8.46503C1.84923 8.4064 1.91335 8.34115 2.01321 8.24129L3.79275 6.46313C3.71814 7.08101 3.75236 7.71445 3.90115 8.33518L3.00344 9.23151C2.89398 9.34097 2.8535 9.38307 2.82251 9.41658C1.93771 10.3744 1.93704 11.8514 2.82179 12.8092C2.85279 12.8427 2.89383 12.884 3.0034 12.9936C3.11272 13.1029 3.15429 13.1442 3.18777 13.1752C4.14561 14.0603 5.62381 14.0608 6.58178 13.1758C6.61532 13.1448 6.65722 13.1032 6.76685 12.9935L8.73077 11.0296C8.83999 10.9204 8.88142 10.8787 8.91238 10.8452C9.79744 9.88728 9.7969 8.40911 8.91173 7.45124C8.88074 7.41775 8.83944 7.3762 8.73011 7.26687C8.62082 7.15757 8.58061 7.11623 8.54712 7.08526C8.37347 6.92477 8.18243 6.79361 7.98088 6.69165L9.00289 5.66964C9.17506 5.78373 9.34035 5.91265 9.49663 6.05703C9.55538 6.11135 9.62026 6.17652 9.72036 6.27662C9.82094 6.3772 9.88686 6.4428 9.94133 6.50173Z" fill="currentColor"></path><path d="M6.06816 9.49196C4.68626 7.99724 4.68667 5.68942 6.06885 4.19487C6.12268 4.13671 6.18789 4.07306 6.28706 3.9739L8.24541 2.01416C8.34478 1.91479 8.41018 1.85055 8.46845 1.79665C9.96301 0.414902 12.2689 0.414922 13.7635 1.79665C13.8217 1.85051 13.8866 1.91559 13.9858 2.01486C14.0849 2.11394 14.1502 2.17769 14.204 2.23583C15.5861 3.7304 15.5866 6.03823 14.2047 7.53291C14.1508 7.59125 14.0854 7.65638 13.9858 7.75595L12.1994 9.54098C12.2614 8.92982 12.2185 8.30587 12.0634 7.69657L12.9956 6.76573C13.1044 6.65692 13.1458 6.61529 13.1765 6.58205C14.0621 5.62404 14.0621 4.1454 13.1765 3.18738C13.1458 3.15419 13.104 3.1135 12.9956 3.00508C12.8877 2.89716 12.8471 2.85551 12.814 2.82485C11.8559 1.9389 10.376 1.93886 9.41794 2.82485C9.38479 2.85554 9.34381 2.89622 9.23564 3.00439L7.27728 4.96413C7.16875 5.07265 7.12708 5.11322 7.09636 5.14643C6.21074 6.10441 6.21153 7.58236 7.09705 8.5404C7.12775 8.57357 7.16826 8.61575 7.27659 8.72408C7.38456 8.83205 7.42647 8.87227 7.45958 8.90293C7.62849 9.0591 7.81309 9.1881 8.00856 9.28894L6.98795 10.3095C6.82111 10.1978 6.66052 10.0715 6.50872 9.93114C6.45057 9.87733 6.38547 9.81341 6.28637 9.71431C6.1871 9.61504 6.12202 9.55018 6.06816 9.49196Z" fill="currentColor"></path></svg></div></div><span>创建分享链接</span><div class="ds-focus-ring"></div></button></div></div></div></div></div></div></div></div></div><div class="ds-notification-container ds-theme" style="--ds-rgb-hover:0 0 0 / 4%;"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./增量批量自动化Coze工作流设计 - DeepSeek_files/saved_resource.html"></iframe><iframe src="./增量批量自动化Coze工作流设计 - DeepSeek_files/usercontent.html" style="display: none; pointer-events: none;"></iframe><div class="intercom-lightweight-app"><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #0f0f0f;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  /* Extended launcher styles */
  .intercom-lightweight-app-launcher.intercom-launcher-extended {
    width: calc(180px - 30px);
    max-width: calc(180px - 30px);
    height: calc(45px - 26px);
    max-height: calc(45px - 26px);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding: 12px 16px 12px 12px !important;
    gap: 6px;
    /* Use theme background instead of hardcoded gradient */
    background: #0f0f0f;
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0px -2px 50px rgba(0, 0, 0, 0.1);
    
  }

  .intercom-lightweight-app-launcher.intercom-launcher-extended .intercom-lightweight-app-launcher-icon {
    position: relative;
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-text {
    /* Match text color with launcher icon */
    color: rgb(255, 255, 255);
    font-size: 14px;
    font-weight: 600;
    line-height: 1.5;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 140px;
    opacity: 1;
    transition: opacity 80ms linear;
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: #ffffff;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;

    
        width: 400px;
        height: calc(100% - 40px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 20px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 24px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #ffffff;
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #ffffff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div><div class="ds-theme ds-modal-wrapper ds-modal-wrapper--hide" data-transform-origin="center" style="--ds-rgb-hover:245 245 245; --ds-rgb-primary:77 107 254; --ds-bordered-secondary-button-color:var(--dsr-text-1); --ds-input-prefix-color:var(--dsr-text-1); z-index: 0;"></div><div class="ds-theme ds-modal-wrapper ds-modal-wrapper--hide" data-transform-origin="center" style="--ds-rgb-hover:245 245 245; --ds-rgb-primary:77 107 254; --ds-bordered-secondary-button-color:var(--dsr-text-1); --ds-input-prefix-color:var(--dsr-text-1); z-index: 0;"></div><div class="ds-floating-container" style="z-index: 0;"><div class="ds-floating-position-wrapper ds-theme" data-transform-origin="top" style="--ds-rgb-hover:0 0 0 / 4%; z-index: 0; left: 1054.5px; top: 200px;"></div></div><div class="ds-floating-container" style="z-index: 0;"><div class="ds-floating-position-wrapper ds-theme" data-transform-origin="bottom" style="--ds-rgb-hover:0 0 0 / 4%; z-index: 0; left: 1058.83px; top: 470.666px;"></div></div><div class="ds-floating-container" style="z-index: 0;"><div class="ds-floating-position-wrapper ds-theme" data-transform-origin="top" style="--ds-rgb-hover:0 0 0 / 4%; z-index: 0; left: 1054.5px; top: 399px;"></div></div><div class="ds-floating-container" style="z-index: 0;"><div class="ds-floating-position-wrapper ds-theme" data-transform-origin="top" style="--ds-rgb-hover:0 0 0 / 4%; z-index: 0; left: 1092.5px; top: 399px;"></div></div><div class="ds-theme ds-modal-wrapper ds-modal-wrapper--hide" data-transform-origin="center" style="--ds-rgb-hover:0 0 0 / 4%; z-index: 0;"></div><div class="ds-floating-container" style="z-index: 0;"><div class="ds-floating-position-wrapper ds-theme" data-transform-origin="bottom left" style="--ds-rgb-hover:0 0 0 / 4%; z-index: 0; left: 8px; top: 349.333px;"></div></div><div class="ds-toast-container ds-toast-container--top ds-theme" style="--ds-rgb-hover:0 0 0 / 4%;"></div></body><div id="mask-2E010B9A-9E10-498E-8664-8A0DAA22D7CB" class="print-ignore" style="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 2147483647; mix-blend-mode: unset; pointer-events: none; transition: opacity 0.1s ease 0s; opacity: 1; display: none; background: rgba(255, 255, 255, 0);"></div></html>